{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/switch.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SwitchPrimitive from '@radix-ui/react-switch'\n\nimport { cn } from '@/lib/utils'\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        'peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={\n          'bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0'\n        }\n      />\n    </SwitchPrimitive.Root>\n  )\n}\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,6LAAC,6KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,8KAAqB;YACpB,aAAU;YACV,WACE;;;;;;;;;;;AAKV;KArBS"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/badge.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst badgeVariants = cva(\n  'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',\n  {\n    variants: {\n      variant: {\n        default:\n          'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',\n        destructive:\n          'border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'span'> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : 'span'\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/header.tsx"],"sourcesContent":["\"use client\"\nimport { useEffect, useState } from 'react'\nimport { useMarket } from '@/components/market/market-context'\nimport { Switch } from '@/components/ui/switch'\nimport { Badge } from '@/components/ui/badge'\n\ninterface HeaderProps {\n  selectedBroker: string | null\n  onBrokerChange: (broker: string | null) => void\n  tradingMode: 'paper' | 'live'\n  onTradingModeChange: (mode: 'paper' | 'live') => void\n}\n\nexport function Header({ selectedBroker, onBrokerChange, tradingMode, onTradingModeChange }: HeaderProps) {\n  // Render date/time only on the client to avoid server/client mismatch during hydration\n  const [formattedDate, setFormattedDate] = useState<string | null>(null)\n  const [formattedTime, setFormattedTime] = useState<string | null>(null)\n\n  useEffect(() => {\n    const now = new Date()\n    setFormattedDate(\n      now.toLocaleDateString('en-GB', {\n        day: '2-digit',\n        month: '2-digit',\n        year: 'numeric',\n      })\n    )\n    setFormattedTime(\n      now.toLocaleTimeString('en-GB', {\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n      })\n    )\n  }, [])\n\n  const market = useMarket()\n\n  return (\n    <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n      <div className=\"flex items-center gap-3\">\n        <span className=\"text-sm md:text-base text-gray-700 font-medium\">Broker:</span>\n        <div className=\"flex items-center gap-2 bg-red-50 px-3 py-2 rounded border border-red-200\">\n          <svg className=\"w-4 h-4 text-red-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path d=\"M10 1a9 9 0 100 18 9 9 0 000-18zM10 15a1 1 0 110-2 1 1 0 010 2zm0-4a1 1 0 10-2 0v-2a1 1 0 102 0v2z\" />\n          </svg>\n          <span className=\"text-red-600 font-semibold text-sm md:text-base\">\n            Please select broker to trade\n          </span>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <span className=\"text-sm md:text-base text-gray-700 font-medium\">Mode:</span>\n          <div className=\"flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200\">\n            <Badge \n              variant={tradingMode === 'paper' ? 'default' : 'outline'}\n              className={tradingMode === 'paper' ? 'bg-blue-500' : 'bg-gray-200 text-gray-600'}\n            >\n              Paper\n            </Badge>\n            <Switch\n              checked={tradingMode === 'live'}\n              onCheckedChange={(checked) => onTradingModeChange(checked ? 'live' : 'paper')}\n              className=\"data-[state=checked]:bg-red-600 data-[state=unchecked]:bg-blue-500\"\n            />\n            <Badge \n              variant={tradingMode === 'live' ? 'default' : 'outline'}\n              className={tradingMode === 'live' ? 'bg-red-600' : 'bg-gray-200 text-gray-600'}\n            >\n              Live\n            </Badge>\n          </div>\n        </div>\n      </div>\n      <div className=\"text-xs md:text-sm text-gray-600 font-mono flex items-center gap-4\">\n        {formattedDate ?? '—/—'}{\" \"}/ {\" \"}{formattedTime ?? '—:—:—'}\n        <div className=\"flex items-center gap-2\">\n          <div className={`w-2 h-2 rounded-full ${market.connected ? 'bg-green-500' : 'bg-red-500'}`}></div>\n          <span className={`text-xs ${market.connected ? 'text-green-600' : 'text-red-600'}`}>{market.connected ? 'Live' : 'Disconnected'}</span>\n          <span className=\"text-xs text-gray-500\">| Subscribed: <span className=\"text-gray-700 font-semibold\">{Object.keys(market.symbols).length}</span></span>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;AAJA;;;;;AAaO,SAAS,OAAO,EAAE,cAAc,EAAE,cAAc,EAAE,WAAW,EAAE,mBAAmB,EAAe;;IACtG,uFAAuF;IACvF,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAgB;IAClE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAgB;IAElE,IAAA,0KAAS;4BAAC;YACR,MAAM,MAAM,IAAI;YAChB,iBACE,IAAI,kBAAkB,CAAC,SAAS;gBAC9B,KAAK;gBACL,OAAO;gBACP,MAAM;YACR;YAEF,iBACE,IAAI,kBAAkB,CAAC,SAAS;gBAC9B,MAAM;gBACN,QAAQ;gBACR,QAAQ;YACV;QAEJ;2BAAG,EAAE;IAEL,MAAM,SAAS,IAAA,0JAAS;IAExB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAK,WAAU;kCAAiD;;;;;;kCACjE,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;gCAAuB,MAAK;gCAAe,SAAQ;0CAChE,cAAA,6LAAC;oCAAK,GAAE;;;;;;;;;;;0CAEV,6LAAC;gCAAK,WAAU;0CAAkD;;;;;;;;;;;;kCAIpE,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAK,WAAU;0CAAiD;;;;;;0CACjE,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,sIAAK;wCACJ,SAAS,gBAAgB,UAAU,YAAY;wCAC/C,WAAW,gBAAgB,UAAU,gBAAgB;kDACtD;;;;;;kDAGD,6LAAC,wIAAM;wCACL,SAAS,gBAAgB;wCACzB,iBAAiB,CAAC,UAAY,oBAAoB,UAAU,SAAS;wCACrE,WAAU;;;;;;kDAEZ,6LAAC,sIAAK;wCACJ,SAAS,gBAAgB,SAAS,YAAY;wCAC9C,WAAW,gBAAgB,SAAS,eAAe;kDACpD;;;;;;;;;;;;;;;;;;;;;;;;0BAMP,6LAAC;gBAAI,WAAU;;oBACZ,iBAAiB;oBAAO;oBAAI;oBAAG;oBAAK,iBAAiB;kCACtD,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAW,CAAC,qBAAqB,EAAE,OAAO,SAAS,GAAG,iBAAiB,cAAc;;;;;;0CAC1F,6LAAC;gCAAK,WAAW,CAAC,QAAQ,EAAE,OAAO,SAAS,GAAG,mBAAmB,gBAAgB;0CAAG,OAAO,SAAS,GAAG,SAAS;;;;;;0CACjH,6LAAC;gCAAK,WAAU;;oCAAwB;kDAAc,6LAAC;wCAAK,WAAU;kDAA+B,OAAO,IAAI,CAAC,OAAO,OAAO,EAAE,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKjJ;GAtEgB;;QAuBC,0JAAS;;;KAvBV"}},
    {"offset": {"line": 336, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/symbol-select.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React from 'react'\r\n\r\ninterface SymbolSelectProps {\r\n  value: string\r\n  onChange: (s: string) => void\r\n}\r\n\r\n// Popular stocks and indices shown initially\r\nconst POPULAR_SYMBOLS = [\r\n  // Indices\r\n  { symbol: 'Nifty 50', name: 'Nifty 50', group: 'Index' },\r\n  { symbol: 'Nifty Bank', name: 'Nifty Bank', group: 'Index' },\r\n  { symbol: 'FINNIFTY', name: 'Fin Nifty', group: 'Index' },\r\n  { symbol: 'MIDCPNIFTY', name: 'Midcap Nifty', group: 'Index' },\r\n  { symbol: 'SENSEX', name: 'Sensex', group: 'Index' },\r\n  { symbol: 'BANKEX', name: 'Bankex', group: 'Index' },\r\n  // Popular Stocks\r\n  { symbol: 'RELIANCE-EQ', name: 'Reliance Industries', group: 'Stock' },\r\n  { symbol: 'TCS-EQ', name: 'Tata Consultancy', group: 'Stock' },\r\n  { symbol: 'HDFCBANK-EQ', name: 'HDFC Bank', group: 'Stock' },\r\n  { symbol: 'INFY-EQ', name: 'Infosys', group: 'Stock' },\r\n  { symbol: 'ICICIBANK-EQ', name: 'ICICI Bank', group: 'Stock' },\r\n  { symbol: 'SBIN-EQ', name: 'State Bank of India', group: 'Stock' },\r\n  { symbol: 'BHARTIARTL-EQ', name: 'Bharti Airtel', group: 'Stock' },\r\n  { symbol: 'ITC-EQ', name: 'ITC', group: 'Stock' },\r\n  { symbol: 'KOTAKBANK-EQ', name: 'Kotak Bank', group: 'Stock' },\r\n  { symbol: 'LT-EQ', name: 'Larsen & Toubro', group: 'Stock' },\r\n  { symbol: 'HINDUNILVR-EQ', name: 'Hindustan Unilever', group: 'Stock' },\r\n  { symbol: 'BAJFINANCE-EQ', name: 'Bajaj Finance', group: 'Stock' },\r\n  { symbol: 'TATASTEEL-EQ', name: 'Tata Steel', group: 'Stock' },\r\n  { symbol: 'TATAMOTORS-EQ', name: 'Tata Motors', group: 'Stock' },\r\n  { symbol: 'WIPRO-EQ', name: 'Wipro', group: 'Stock' },\r\n  { symbol: 'AXISBANK-EQ', name: 'Axis Bank', group: 'Stock' },\r\n  { symbol: 'MARUTI-EQ', name: 'Maruti Suzuki', group: 'Stock' },\r\n  { symbol: 'ADANIENT-EQ', name: 'Adani Enterprises', group: 'Stock' },\r\n  { symbol: 'SUNPHARMA-EQ', name: 'Sun Pharma', group: 'Stock' },\r\n  { symbol: 'ONGC-EQ', name: 'ONGC', group: 'Stock' },\r\n]\r\n\r\nexport default React.memo(function SymbolSelect({ value, onChange }: SymbolSelectProps) {\r\n  const [open, setOpen] = React.useState(false)\r\n  const [query, setQuery] = React.useState('')\r\n  const [searchResults, setSearchResults] = React.useState<Array<any>>([])\r\n  const [loading, setLoading] = React.useState(false)\r\n  const containerRef = React.useRef<HTMLDivElement | null>(null)\r\n\r\n  const BACKEND_BASE = (process.env.NEXT_PUBLIC_API_BASE_URL as string) || 'http://localhost:5000'\r\n\r\n  // Search from database when user types\r\n  React.useEffect(() => {\r\n    if (!query.trim()) {\r\n      setSearchResults([])\r\n      return\r\n    }\r\n\r\n    const timer = setTimeout(async () => {\r\n      setLoading(true)\r\n      try {\r\n        const url = `${BACKEND_BASE}/api/symbols/search?q=${encodeURIComponent(query)}&limit=50`\r\n        console.log('[SymbolSelect] Searching:', url)\r\n        const resp = await fetch(url)\r\n        const json = await resp.json()\r\n        let list = json?.data || []\r\n        if (!Array.isArray(list)) list = []\r\n        \r\n        // Map results\r\n        const mapped = list.map((it: any) => ({\r\n          symbol: it.symbol || it.tradingsymbol || '',\r\n          name: it.name || it.symbol || '',\r\n          group: (it.segment === 'Index' || it.instrument_type === 'AMXIDX') ? 'Index' : 'Stock'\r\n        }))\r\n        \r\n        console.log('[SymbolSelect] Found', mapped.length, 'results')\r\n        setSearchResults(mapped)\r\n      } catch (err) {\r\n        console.error('Search error:', err)\r\n        setSearchResults([])\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }, 300)\r\n\r\n    return () => clearTimeout(timer)\r\n  }, [query, BACKEND_BASE])\r\n\r\n  // Use search results if searching, otherwise show popular symbols\r\n  const displayList = query.trim() ? searchResults : POPULAR_SYMBOLS\r\n\r\n  // Group by Index/Stock\r\n  const grouped = React.useMemo(() => {\r\n    const byGroup: Record<string, any[]> = { Index: [], Stock: [] }\r\n    displayList.forEach(s => {\r\n      (byGroup[s.group] ||= []).push(s)\r\n    })\r\n    return byGroup\r\n  }, [displayList])\r\n\r\n  // Close dropdown when clicking outside\r\n  React.useEffect(() => {\r\n    function onDocClick(e: MouseEvent) {\r\n      if (!containerRef.current) return\r\n      if (!containerRef.current.contains(e.target as Node)) setOpen(false)\r\n    }\r\n    document.addEventListener('click', onDocClick)\r\n    return () => document.removeEventListener('click', onDocClick)\r\n  }, [])\r\n\r\n  return (\r\n    <div className=\"relative\" ref={containerRef}>\r\n      <div\r\n        role=\"button\"\r\n        tabIndex={0}\r\n        onClick={() => setOpen(v => !v)}\r\n        onKeyDown={(e) => { if (e.key === 'Enter') setOpen(v => !v) }}\r\n        className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded bg-white cursor-pointer flex items-center justify-between\"\r\n      >\r\n        <span className=\"truncate\">{value || 'Select symbol'}</span>\r\n        <svg className=\"w-3 h-3 text-gray-500\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n          <path fillRule=\"evenodd\" d=\"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.06z\" clipRule=\"evenodd\"/>\r\n        </svg>\r\n      </div>\r\n\r\n      {open && (\r\n        <div className=\"absolute z-40 mt-1 w-full bg-white border border-gray-200 rounded shadow-lg\">\r\n          <div className=\"p-2\">\r\n            <input\r\n              value={query}\r\n              onChange={(e) => setQuery(e.target.value)}\r\n              placeholder=\"Search symbol...\"\r\n              className=\"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none\"\r\n              autoFocus\r\n            />\r\n          </div>\r\n\r\n          <div className=\"max-h-64 overflow-auto text-sm\">\r\n            {loading ? (\r\n              <div className=\"px-3 py-4 text-center text-xs text-gray-500\">Searching...</div>\r\n            ) : displayList.length === 0 ? (\r\n              <div className=\"px-3 py-3 text-center text-xs text-gray-500\">\r\n                No results found for \"{query}\"\r\n              </div>\r\n            ) : (\r\n              ['Index', 'Stock'].map(group => (\r\n                grouped[group].length > 0 && (\r\n                  <div key={group} className=\"px-2 py-1\">\r\n                    <div className=\"text-xs text-gray-500 font-semibold px-1 py-1 border-b\">{group}</div>\r\n                    {grouped[group].map((sym: any) => (\r\n                      <div\r\n                        key={sym.symbol}\r\n                        onClick={() => { \r\n                          onChange(sym.symbol)\r\n                          setOpen(false)\r\n                          setQuery('')\r\n                        }}\r\n                        className={`px-2 py-1.5 cursor-pointer rounded hover:bg-gray-100 ${value === sym.symbol ? 'bg-blue-50 font-medium' : ''}`}\r\n                      >\r\n                        <div className=\"font-medium\">{sym.symbol}</div>\r\n                        {sym.name !== sym.symbol && (\r\n                          <div className=\"text-xs text-gray-400\">{sym.name}</div>\r\n                        )}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )\r\n              ))\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n})\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 729, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/trade-form.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { ChevronDown } from 'lucide-react'\nimport React from 'react'\nimport { useMarket } from '@/components/market/market-context'\nimport SymbolSelect from './symbol-select'\n\nexport function TradeForm() {\n  const [formData, setFormData] = useState({\n    exchange: 'NSE',\n    segment: 'Options',\n    symbol: '',\n    expiryDate: '',\n    callStrike: '',\n    putStrike: '',\n    qty: '',\n    productType: 'MARGIN',\n    orderType: 'MARKET',\n    marketProtection: '5',\n    positionType: 'F&O positions only',\n    positionView: 'All positions',\n    predefinedSL: false,\n    targetPrice: '',\n    price: '',\n    triggerPrice: '',\n    oneClickEnabled: true,\n  })\n\n  const [availableExpiries, setAvailableExpiries] = useState<string[]>([])\n  const [availableStrikes, setAvailableStrikes] = useState<number[]>([])\n  const [lotSize, setLotSize] = useState<number>(1)\n  const [loadingExpiries, setLoadingExpiries] = useState(false)\n  const [loadingStrikes, setLoadingStrikes] = useState(false)\n\n  const market = useMarket()\n  const currentTokenRef = React.useRef<string | null>(null)\n  const currentExchangeRef = React.useRef<string>('NSE')\n\n  const handleChange = (field: string, value: string | boolean) => {\n    setFormData(prev => ({ ...prev, [field]: value }))\n  }\n\n  // Fetch lot size and expiries when symbol changes\n  useEffect(() => {\n    if (!formData.symbol) {\n      setAvailableExpiries([])\n      setLotSize(1)\n      setFormData(prev => ({ ...prev, expiryDate: '', callStrike: '', putStrike: '', qty: '' }))\n      return\n    }\n\n    const fetchSymbolData = async () => {\n      setLoadingExpiries(true)\n      const BACKEND_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:5000'\n      try {\n        // Fetch symbol details for lot size\n        const url = `${BACKEND_BASE}/api/symbols/${encodeURIComponent(formData.symbol)}`\n        console.log('[TradeForm] Fetching symbol data from:', url)\n        const symbolResp = await fetch(url)\n        console.log('[TradeForm] Symbol API status:', symbolResp.status, symbolResp.statusText)\n        \n        if (!symbolResp.ok) {\n          console.error('[TradeForm] ❌ Symbol API error:', symbolResp.status, symbolResp.statusText)\n          return\n        }\n        \n        const symbolData = await symbolResp.json()\n        console.log('[TradeForm] Symbol API response:', symbolData)\n        \n        if (symbolData.status && symbolData.data) {\n          setLotSize(symbolData.data.lot_size || 1)\n          setFormData(prev => ({ ...prev, qty: String(symbolData.data.lot_size || 1) }))\n\n          // Subscribe to LTP feed for this symbol\n          if (symbolData.data.token && market.subscribeTokens) {\n            const exchange = symbolData.data.exchange || 'NSE'\n            console.log('[TradeForm] Subscribing to token:', symbolData.data.token, 'for symbol:', formData.symbol, 'exchange:', exchange)\n            market.subscribeTokens([{\n              token: symbolData.data.token,\n              exchange: exchange,\n              symbol: formData.symbol,\n            }])\n            currentTokenRef.current = String(symbolData.data.token)\n            currentExchangeRef.current = exchange\n            console.log('[TradeForm] ✅ Subscribed to token:', currentTokenRef.current, 'exchange:', currentExchangeRef.current)\n          } else {\n            console.warn('[TradeForm] ⚠️ No token found for symbol:', formData.symbol, 'token:', symbolData.data?.token)\n          }\n        } else {\n          console.error('[TradeForm] ❌ Invalid symbol data response:', symbolData)\n        }\n\n        // Fetch available expiries\n        const expiryResp = await fetch(`${BACKEND_BASE}/api/symbols/${formData.symbol}/expiries`)\n        const expiryData = await expiryResp.json()\n        console.log('[TradeForm] Expiry API response:', expiryData)\n        \n        if (expiryData.status && expiryData.data && Array.isArray(expiryData.data)) {\n          console.log('[TradeForm] Raw expiry dates:', expiryData.data)\n          \n          // Format expiry dates from ISO to DD-MMM-YYYY\n          const formattedExpiries = expiryData.data.map((expiry: string) => {\n            const date = new Date(expiry)\n            const day = String(date.getDate()).padStart(2, '0')\n            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n            const month = monthNames[date.getMonth()]\n            const year = date.getFullYear()\n            return `${day}-${month}-${year}`\n          })\n          \n          console.log('[TradeForm] Formatted expiry dates:', formattedExpiries)\n          setAvailableExpiries(formattedExpiries)\n          \n          if (formattedExpiries.length > 0) {\n            setFormData(prev => ({ ...prev, expiryDate: formattedExpiries[0] }))\n          }\n        } else {\n          console.warn('[TradeForm] No expiry data available or invalid format')\n          setAvailableExpiries([])\n        }\n      } catch (error) {\n        console.error('Error fetching symbol data:', error)\n      } finally {\n        setLoadingExpiries(false)\n      }\n    }\n\n    fetchSymbolData()\n  }, [formData.symbol])\n\n  // Fetch strikes when expiry changes\n  useEffect(() => {\n    if (!formData.symbol || !formData.expiryDate) {\n      setAvailableStrikes([])\n      return\n    }\n\n    const fetchStrikes = async () => {\n      setLoadingStrikes(true)\n      const BACKEND_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:5000'\n      try {\n        const resp = await fetch(`${BACKEND_BASE}/api/symbols/${formData.symbol}/expiries/${formData.expiryDate}/strikes`)\n        const data = await resp.json()\n        if (data.status && data.data) {\n          setAvailableStrikes(data.data)\n          if (data.data.length > 0) {\n            const atmStrike = data.data[Math.floor(data.data.length / 2)] // ATM strike\n            setFormData(prev => ({ ...prev, callStrike: String(atmStrike), putStrike: String(atmStrike) }))\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching strikes:', error)\n      } finally {\n        setLoadingStrikes(false)\n      }\n    }\n\n    fetchStrikes()\n  }, [formData.symbol, formData.expiryDate])\n\n  // Dispatch form updates to other components\n  React.useEffect(() => {\n    const eventData = { \n      ...formData, \n      token: currentTokenRef.current,\n      exchange: currentExchangeRef.current \n    }\n    window.dispatchEvent(new CustomEvent('tradeFormUpdated', { detail: eventData }))\n  }, [formData])\n\n  const TradeInputField = ({\n    label,\n    value,\n    onChange,\n    placeholder = '',\n  }: {\n    label: string\n    value: string\n    onChange: (value: string) => void\n    placeholder?: string\n  }) => (\n    <div className=\"flex flex-col gap-1\">\n      <label className=\"text-xs font-medium text-gray-600\">{label}</label>\n      <input\n        type=\"text\"\n        value={value}\n        onChange={(e) => onChange(e.target.value)}\n        placeholder={placeholder}\n        className=\"px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent w-full\"\n      />\n    </div>\n  )\n\n  const SelectField = ({\n    label,\n    value,\n    onChange,\n    options,\n    loading = false,\n  }: {\n    label: string\n    value: string\n    onChange: (value: string) => void\n    options: string[]\n    loading?: boolean\n  }) => (\n    <div className=\"flex flex-col gap-1\">\n      <label className=\"text-xs font-medium text-gray-600\">{label}</label>\n      <div className=\"relative\">\n        <select\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          disabled={loading}\n          className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent disabled:opacity-50\"\n        >\n          {loading && options.length === 0 ? (\n            <option>Loading...</option>\n          ) : (\n            options.map(option => (\n              <option key={option} value={option}>{option}</option>\n            ))\n          )}\n        </select>\n        <ChevronDown className=\"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n      </div>\n    </div>\n  )\n\n  return (\n    <div className=\"space-y-2\">\n      {/* Main Form Row - All fields in one compact row */}\n      <div className=\"flex flex-wrap items-end gap-2\">\n        {/* Exchange */}\n        <div className=\"flex flex-col gap-1 w-24\">\n          <label className=\"text-xs font-medium text-gray-600\">Exchange</label>\n          <div className=\"relative\">\n            <select\n              value={formData.exchange}\n              onChange={(e) => handleChange('exchange', e.target.value)}\n              className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500\"\n            >\n              {['BSE', 'NSE', 'MCX'].map(option => <option key={option} value={option}>{option}</option>)}\n            </select>\n            <ChevronDown className=\"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n          </div>\n        </div>\n\n        {/* Segment */}\n        <div className=\"flex flex-col gap-1 w-24\">\n          <label className=\"text-xs font-medium text-gray-600\">Segment</label>\n          <div className=\"relative\">\n            <select\n              value={formData.segment}\n              onChange={(e) => handleChange('segment', e.target.value)}\n              className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500\"\n            >\n              {['Options', 'Futures', 'Cash'].map(option => <option key={option} value={option}>{option}</option>)}\n            </select>\n            <ChevronDown className=\"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n          </div>\n        </div>\n\n        {/* Symbol */}\n        <div className=\"flex flex-col gap-1 w-36\">\n          <label className=\"text-xs font-medium text-gray-600\">Symbol</label>\n          <SymbolSelect \n            value={formData.symbol} \n            onChange={(s) => handleChange('symbol', s)}\n          />\n        </div>\n\n        {/* Expiry Date */}\n        <div className=\"flex flex-col gap-1 w-32\">\n          <label className=\"text-xs font-medium text-gray-600\">Expiry Date</label>\n          <div className=\"relative\">\n            <select\n              value={formData.expiryDate}\n              onChange={(e) => handleChange('expiryDate', e.target.value)}\n              disabled={loadingExpiries}\n              className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:opacity-50\"\n            >\n              {loadingExpiries && availableExpiries.length === 0 ? (\n                <option>Loading...</option>\n              ) : availableExpiries.length === 0 ? (\n                <option value=\"\">Select expiry</option>\n              ) : (\n                <>\n                  {!formData.expiryDate && <option value=\"\">Select expiry</option>}\n                  {availableExpiries.map(option => <option key={option} value={option}>{option}</option>)}\n                </>\n              )}\n            </select>\n            <ChevronDown className=\"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n          </div>\n        </div>\n\n        {/* Call Strike */}\n        <div className=\"flex flex-col gap-1 w-24\">\n          <label className=\"text-xs font-medium text-gray-600\">Call Strike</label>\n          <div className=\"relative\">\n            <select\n              value={formData.callStrike}\n              onChange={(e) => handleChange('callStrike', e.target.value)}\n              disabled={loadingStrikes}\n              className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:opacity-50\"\n            >\n              {loadingStrikes && availableStrikes.length === 0 ? (\n                <option>Loading...</option>\n              ) : availableStrikes.length === 0 ? (\n                <option value=\"\">Select</option>\n              ) : (\n                <>\n                  {!formData.callStrike && <option value=\"\">Select</option>}\n                  {availableStrikes.map(strike => (\n                    <option key={strike} value={String(strike)}>{strike}</option>\n                  ))}\n                </>\n              )}\n            </select>\n            <ChevronDown className=\"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n          </div>\n        </div>\n\n        {/* Put Strike */}\n        <div className=\"flex flex-col gap-1 w-24\">\n          <label className=\"text-xs font-medium text-gray-600\">Put Strike</label>\n          <div className=\"relative\">\n            <select\n              value={formData.putStrike}\n              onChange={(e) => handleChange('putStrike', e.target.value)}\n              disabled={loadingStrikes}\n              className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:opacity-50\"\n            >\n              {loadingStrikes && availableStrikes.length === 0 ? (\n                <option>Loading...</option>\n              ) : availableStrikes.length === 0 ? (\n                <option value=\"\">Select</option>\n              ) : (\n                <>\n                  {!formData.putStrike && <option value=\"\">Select</option>}\n                  {availableStrikes.map(strike => (\n                    <option key={strike} value={String(strike)}>{strike}</option>\n                  ))}\n                </>\n              )}\n            </select>\n            <ChevronDown className=\"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n          </div>\n        </div>\n\n        {/* Qty */}\n        <div className=\"flex flex-col gap-1 w-28\">\n          <label className=\"text-xs font-medium text-gray-600\">Qty (Lot: {lotSize})</label>\n          <input\n            type=\"text\"\n            value={formData.qty}\n            onChange={(e) => handleChange('qty', e.target.value)}\n            className=\"w-full px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n          />\n        </div>\n\n        {/* Product Type Buttons */}\n        <div className=\"flex flex-col gap-1\">\n          <label className=\"text-xs font-medium text-gray-600\">Product Type</label>\n          <div className=\"flex gap-1.5\">\n            <button\n              type=\"button\"\n              onClick={() => handleChange('productType', 'MARGIN')}\n              className={`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${\n                formData.productType === 'MARGIN'\n                  ? 'bg-green-600 text-white'\n                  : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n              }`}\n            >\n              MARGIN\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => handleChange('productType', 'INTRADAY')}\n              className={`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${\n                formData.productType === 'INTRADAY'\n                  ? 'bg-green-600 text-white'\n                  : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n              }`}\n            >\n              INTRADAY\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Order Type Buttons Row */}\n      <div className=\"flex flex-wrap items-center gap-2\">\n        <label className=\"text-xs font-medium text-gray-600\">Order Type:</label>\n        <button\n          type=\"button\"\n          onClick={() => handleChange('orderType', 'LIMIT')}\n          className={`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${\n            formData.orderType === 'LIMIT'\n              ? 'bg-green-600 text-white'\n              : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n          }`}\n        >\n          LIMIT\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => handleChange('orderType', 'MARKET')}\n          className={`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${\n            formData.orderType === 'MARKET'\n              ? 'bg-green-600 text-white'\n              : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n          }`}\n        >\n          MARKET\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => handleChange('orderType', 'MARKET_PROTECTION')}\n          className={`px-3 py-1.5 text-xs font-semibold rounded transition-colors whitespace-nowrap ${\n            formData.orderType === 'MARKET_PROTECTION'\n              ? 'bg-green-600 text-white'\n              : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n          }`}\n        >\n          MARKET PROTECTION\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => handleChange('orderType', 'SL-L')}\n          className={`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${\n            formData.orderType === 'SL-L'\n              ? 'bg-green-600 text-white'\n              : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n          }`}\n        >\n          SL-L\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => handleChange('orderType', 'SL-M')}\n          className={`px-3 py-1.5 text-xs font-semibold rounded transition-colors ${\n            formData.orderType === 'SL-M'\n              ? 'bg-green-600 text-white'\n              : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n          }`}\n        >\n          SL-M\n        </button>\n\n        {/* Conditional Order Fields - Inline with buttons */}\n        {formData.orderType === 'LIMIT' && (\n          <input\n            type=\"text\"\n            value={formData.price}\n            onChange={(e) => handleChange('price', e.target.value)}\n            placeholder=\"Limit Price\"\n            className=\"w-28 px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n          />\n        )}\n        {formData.orderType === 'SL-M' && (\n          <input\n            type=\"text\"\n            value={formData.triggerPrice}\n            onChange={(e) => handleChange('triggerPrice', e.target.value)}\n            placeholder=\"Trigger Price\"\n            className=\"w-28 px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n          />\n        )}\n        {formData.orderType === 'SL-L' && (\n          <>\n            <input\n              type=\"text\"\n              value={formData.triggerPrice}\n              onChange={(e) => handleChange('triggerPrice', e.target.value)}\n              placeholder=\"Trigger\"\n              className=\"w-24 px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n            />\n            <input\n              type=\"text\"\n              value={formData.price}\n              onChange={(e) => handleChange('price', e.target.value)}\n              placeholder=\"Limit\"\n              className=\"w-24 px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n            />\n          </>\n        )}\n        {formData.orderType === 'MARKET_PROTECTION' && (\n          <input\n            type=\"text\"\n            value={formData.marketProtection}\n            onChange={(e) => handleChange('marketProtection', e.target.value)}\n            placeholder=\"5\"\n            className=\"w-16 px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n          />\n        )}\n\n        {/* Predefined SL inline */}\n        <div className=\"flex items-center gap-1.5 ml-2\">\n          <input\n            type=\"checkbox\"\n            id=\"predefinedSL\"\n            checked={formData.predefinedSL}\n            onChange={(e) => handleChange('predefinedSL', e.target.checked)}\n            className=\"w-4 h-4 border-gray-300 rounded cursor-pointer\"\n          />\n          <label htmlFor=\"predefinedSL\" className=\"text-xs text-gray-600 cursor-pointer\">Predefined SL</label>\n        </div>\n\n        {/* Target Price inline */}\n        <input\n          type=\"text\"\n          value={formData.targetPrice}\n          onChange={(e) => handleChange('targetPrice', e.target.value)}\n          placeholder=\"Target (Pts)\"\n          className=\"w-28 px-2 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n        />\n\n        {/* Position Type */}\n        <div className=\"relative\">\n          <select\n            value={formData.positionType}\n            onChange={(e) => handleChange('positionType', e.target.value)}\n            className=\"px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 pr-6\"\n          >\n            {['F&O positions only', 'All positions'].map(option => <option key={option} value={option}>{option}</option>)}\n          </select>\n          <ChevronDown className=\"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n        </div>\n\n        {/* Position View */}\n        <div className=\"relative\">\n          <select\n            value={formData.positionView}\n            onChange={(e) => handleChange('positionView', e.target.value)}\n            className=\"px-2 py-1.5 text-xs border border-gray-300 rounded appearance-none bg-white cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 pr-6\"\n          >\n            {['All positions', 'Open positions', 'Closed positions'].map(option => <option key={option} value={option}>{option}</option>)}\n          </select>\n          <ChevronDown className=\"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none\" />\n        </div>\n\n        {/* Show Options List */}\n        <button \n          onClick={() => window.dispatchEvent(new CustomEvent('showOptionsChain', { detail: { symbol: formData.symbol, expiryDate: formData.expiryDate } }))} \n          className=\"px-3 py-1.5 text-red-600 border border-red-600 rounded text-xs font-medium hover:bg-red-50 transition-colors\"\n        >\n          Show Options List\n        </button>\n\n        {/* One Click */}\n        <div className=\"flex items-center gap-1.5\">\n          <input \n            type=\"checkbox\" \n            id=\"oneClick\"\n            checked={formData.oneClickEnabled}\n            onChange={(e) => handleChange('oneClickEnabled', e.target.checked)}\n            className=\"w-4 h-4 border-gray-300 rounded cursor-pointer\" \n          />\n          <label htmlFor=\"oneClick\" className=\"text-xs text-gray-600 cursor-pointer whitespace-nowrap\">One click</label>\n        </div>\n      </div>\n\n      <p className=\"text-xs text-gray-500 italic\">\n        Changing type will reset all SL & Target\n      </p>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1802, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/price-charts.tsx"],"sourcesContent":["\"use client\"\nimport React from 'react'\nimport { useMarket } from '@/components/market/market-context'\n\ninterface PriceChartProps {\n  title: string\n  symbol: string\n  strikePrice?: string\n  expiry?: string\n  leftLabel?: string\n  leftValue?: string\n  middleLabel?: string\n  middleValue?: string\n  rightLabel?: string\n  rightValue?: string\n  textColor?: 'text-red-600' | 'text-green-600'\n  positionType?: 'CE' | 'PE'\n  noBorder?: boolean\n  marketKey?: string\n}\n\n// Separate component for just the LTP value to minimize re-renders\nconst LiveLTP = React.memo(function LiveLTP({ value }: { value: number | undefined }) {\n  return <>{value != null ? value.toFixed(2) : '—'}</>\n})\n\n// Separate component for delta display\nconst LiveDelta = React.memo(function LiveDelta({ \n  delta, \n  deltaPct \n}: { \n  delta: number | null\n  deltaPct: number | null \n}) {\n  if (delta == null || deltaPct == null) return <>(—)</>\n  const isNegative = delta < 0\n  const isPositive = delta > 0\n  return (\n    <span className={isNegative ? 'text-red-600' : isPositive ? 'text-green-600' : 'text-gray-600'}>\n      ({isPositive ? '+' : ''}{delta.toFixed(2)} / {isPositive ? '+' : ''}{deltaPct.toFixed(2)}%)\n    </span>\n  )\n})\n\n// Separate component for the position dot on the slider\nconst PositionDot = React.memo(function PositionDot({ percentage }: { percentage: number }) {\n  return (\n    <div \n      className=\"absolute\" \n      style={{ \n        width: 8, \n        height: 8, \n        borderRadius: 9999, \n        backgroundColor: '#222',\n        left: `${percentage}%`, \n        top: '50%', \n        transform: 'translate(-50%, -50%)',\n        transition: 'left 0.15s linear'\n      }} \n    />\n  )\n})\n\n// Separate component for Low/High values\nconst LiveLowHigh = React.memo(function LiveLowHigh({ low, high }: { low: number; high: number }) {\n  return (\n    <div className=\"flex justify-between items-center mb-1\">\n      <span className=\"text-xs text-gray-600\">L: <span className=\"font-medium\">{low > 0 ? low.toFixed(2) : '—'}</span></span>\n      <span className=\"text-xs font-medium\"></span>\n      <span className=\"text-xs text-gray-600\">H: <span className=\"font-medium\">{high > 0 ? high.toFixed(2) : '—'}</span></span>\n    </div>\n  )\n})\n\nconst PriceChart = React.memo(function PriceChart({\n  title,\n  symbol,\n  strikePrice,\n  expiry,\n  positionType,\n  noBorder,\n  marketKey,\n}: PriceChartProps) {\n  const market = useMarket()\n  \n  // Normalize symbol to handle various name formats\n  const normalizedSymbol = React.useMemo(() => {\n    const upper = (symbol || '').toUpperCase().trim()\n    if (upper === 'NIFTY BANK' || upper === 'BANKNIFTY' || upper === 'BANK NIFTY') return 'Nifty Bank'\n    if (upper === 'NIFTY' || upper === 'NIFTY 50' || upper === 'NIFTY50') return 'Nifty 50'\n    return symbol\n  }, [symbol])\n  \n  // Try multiple keys to find the best match\n  const marketData = React.useMemo(() => {\n    if (marketKey && market.symbols[marketKey]) return market.symbols[marketKey]\n    if (market.symbols[normalizedSymbol]) return market.symbols[normalizedSymbol]\n    if (market.symbols[symbol]) return market.symbols[symbol]\n    \n    const keys = Object.keys(market.symbols)\n    const upperSymbol = (symbol || '').toUpperCase()\n    const upperNormalized = (normalizedSymbol || '').toUpperCase()\n    \n    let found = keys.find(k => k.toUpperCase() === upperSymbol || k.toUpperCase() === upperNormalized)\n    if (found) return market.symbols[found]\n    \n    found = keys.find(k => {\n      const upper = k.toUpperCase()\n      return upper.includes(upperSymbol) || upper.includes(upperNormalized) || upperSymbol.includes(upper)\n    })\n    return found ? market.symbols[found] : undefined\n  }, [market.symbols, marketKey, normalizedSymbol, symbol])\n  \n  // Extract values - these update when marketData changes\n  const liveLtp = marketData?.ltp ?? undefined\n  const low = marketData?.low ?? (liveLtp != null ? Number((liveLtp * 0.98).toFixed(2)) : 0)\n  const high = marketData?.high ?? (liveLtp != null ? Number((liveLtp * 1.02).toFixed(2)) : 0)\n  const netChange = marketData?.netChange ?? null\n  const percentChange = marketData?.percentChange ?? null\n  \n  // Calculate position percentage\n  const range = high - low\n  let positionPercentage = 50\n  if (range > 0 && liveLtp != null) {\n    positionPercentage = ((liveLtp - low) / range) * 100\n    positionPercentage = Math.max(0, Math.min(100, positionPercentage))\n  }\n  \n  const markerColor = '#7b3b3b'\n\n  // Compute delta from previous if market data doesn't have it\n  const prevRef = React.useRef<number | undefined>(undefined)\n  const [computedDelta, setComputedDelta] = React.useState<number | null>(null)\n  const [computedDeltaPct, setComputedDeltaPct] = React.useState<number | null>(null)\n\n  React.useEffect(() => {\n    if (liveLtp === undefined) return\n    if (netChange != null && percentChange != null) {\n      setComputedDelta(netChange)\n      setComputedDeltaPct(percentChange)\n      prevRef.current = liveLtp\n      return\n    }\n    const prev = prevRef.current\n    if (prev != null && prev !== 0 && prev !== liveLtp) {\n      const d = liveLtp - prev\n      setComputedDelta(Number(d.toFixed(2)))\n      setComputedDeltaPct(Number(((d / prev) * 100).toFixed(2)))\n    }\n    prevRef.current = liveLtp\n  }, [liveLtp, netChange, percentChange])\n\n  const delta = netChange ?? computedDelta\n  const deltaPct = percentChange ?? computedDeltaPct\n\n  return (\n    <div className={`flex-1 min-w-full md:min-w-0 p-3 bg-white rounded${!noBorder ? ' border border-gray-200' : ''}`}>\n      {/* Header - static, no re-render needed */}\n      <div className=\"flex justify-between items-start mb-2\">\n        <div className=\"flex-1\">\n          <p className=\"text-xs text-gray-700 font-semibold\">{title}</p>\n        </div>\n        <div className=\"text-center flex-1\">\n          <p className=\"text-xs text-gray-500\">{symbol}</p>\n        </div>\n        <div className=\"text-right flex-1\">\n          <p className=\"text-xs text-gray-500\">{positionType || ''}</p>\n        </div>\n      </div>\n\n      {/* Price slider */}\n      <div className=\"mb-3\">\n        <LiveLowHigh low={low} high={high} />\n        <div className=\"h-0.5 rounded-full relative\" style={{ backgroundColor: markerColor }}>\n          <div className=\"absolute\" style={{ left: '0%', top: '-10px', transform: 'translateX(-50%)' }}>\n            <svg width=\"10\" height=\"8\" viewBox=\"0 0 10 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path d=\"M5 8L0 0H10L5 8Z\" fill={markerColor} />\n            </svg>\n          </div>\n          {liveLtp != null && <PositionDot percentage={positionPercentage} />}\n          <div className=\"absolute\" style={{ right: '0%', top: '-10px', transform: 'translateX(50%)' }}>\n            <svg width=\"10\" height=\"8\" viewBox=\"0 0 10 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path d=\"M5 8L0 0H10L5 8Z\" fill={markerColor} />\n            </svg>\n          </div>\n        </div>\n      </div>\n\n      {/* LTP Display */}\n      <div className={`pt-3 ${!noBorder ? 'border-t border-gray-200' : ''}`}>\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <span className=\"text-sm font-medium text-gray-900\">LTP: </span>\n            <span className=\"text-lg font-bold text-gray-900\">\n              <LiveLTP value={liveLtp} />\n            </span>\n          </div>\n          <span className=\"text-sm font-medium\">\n            <LiveDelta delta={delta} deltaPct={deltaPct} />\n          </span>\n        </div>\n      </div>\n    </div>\n  )\n}, (prevProps, nextProps) => {\n  // Custom comparison - only re-render if these props change\n  return prevProps.marketKey === nextProps.marketKey && \n         prevProps.title === nextProps.title &&\n         prevProps.symbol === nextProps.symbol &&\n         prevProps.positionType === nextProps.positionType\n})\n// Format expiry from DDMMYY -> DDMMMYY (e.g., 251125 -> 25NOV25)\nfunction formatExpiry(code?: string) {\n  if (!code) return ''\n  // expecting DDMMYY\n  if (!/^[0-9]{6}$/.test(code)) return code\n  const dd = code.slice(0,2)\n  const mm = code.slice(2,4)\n  const yy = code.slice(4,6)\n  const monthNames = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC']\n  const mIndex = Number(mm) - 1\n  const year = yy\n  const mon = monthNames[mIndex] ?? mm\n  return `${dd}${mon}${year}`\n}\n\n// Format expiry for key lookup: DD-MMM-YY\nfunction formatExpiryForKey(exp: string) {\n  if (exp.length === 6 && /^\\d{6}$/.test(exp)) { // DDMMYY\n    const dd = exp.slice(0,2)\n    const mm = exp.slice(2,4)\n    const yy = exp.slice(4,6)\n    const monthNames = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC']\n    const mIndex = Number(mm) - 1\n    const mon = monthNames[mIndex] ?? mm\n    return `${dd}-${mon}-${yy}`\n  }\n  if (exp.match(/^\\d{2}[A-Z]{3}\\d{2}$/)) { // DDMMMYY\n    const dd = exp.slice(0,2)\n    const mmm = exp.slice(2,5)\n    const yy = exp.slice(5,7)\n    return `${dd}-${mmm}-${yy}`\n  }\n  return exp\n}\n\nexport function PriceCharts() {\n  const market = useMarket()\n  const [selected, setSelected] = React.useState<string[]>([])\n  const [selectedToken, setSelectedToken] = React.useState<string | null>(null)\n\n  // Helper: find market symbol key by numeric token\n  const findKeyByToken = React.useCallback((tok?: string | number) => {\n    if (!tok) return undefined\n    const tnum = Number(tok)\n    const entries = Object.entries(market.symbols || {})\n    for (const [k, v] of entries) {\n      if (v && v.token != null && Number(v.token) === tnum) return k\n      // also match keys like 'Token_26000' or exact numeric string\n      if (k === `Token_${tnum}`) return k\n      if (k === String(tnum)) return k\n    }\n    return undefined\n  }, [market.symbols])\n  // Parse option-like labels into parts\n  const parseOption = (input: string) => {\n    const s = String(input || '').trim()\n    const upper = s.toUpperCase()\n    const typeMatch = upper.match(/\\b(CE|PE)\\b/)\n    const expiryMatch = upper.match(/\\b(\\d{2}[A-Z]{3}\\d{2})\\b/) // DDMMMYY\n    // strike: numeric token after expiry\n    const strikeMatch = upper.match(/\\b(\\d{4,5})\\b(?!\\d)/)\n    // underlying: remove type, expiry, strike tokens\n    let underlying = upper.replace(/\\b(CE|PE)\\b/g, '')\n    underlying = underlying.replace(/\\b\\d{2}[A-Z]{3}\\d{2}\\b/g, '')\n    underlying = underlying.replace(/\\b\\d{4,5}\\b/g, '')\n    underlying = underlying.replace(/[^A-Z0-9 ]/g, ' ').trim()\n    return {\n      raw: s,\n      type: typeMatch ? typeMatch[1] : undefined,\n      expiry: expiryMatch ? expiryMatch[1] : undefined,\n      strike: strikeMatch ? strikeMatch[1] : undefined,\n      underlying: underlying || s\n    }\n  }\n\n  // Resolve a market key best matching the provided token (exact -> includes -> stripped)\n  const resolveMarketKey = (token: string | undefined) => {\n    if (!token) return undefined\n    const keys = Object.keys(market?.symbols || {})\n    if (keys.length === 0) return undefined\n    if (keys.includes(token)) return token\n    const upper = token.toUpperCase()\n    const found = keys.find(k => k.toUpperCase() === upper)\n    if (found) return found\n    const partial = keys.find(k => k.toUpperCase().includes(upper))\n    if (partial) return partial\n    const stripped = upper.replace(/[^A-Z0-9]/g, '')\n    const found2 = keys.find(k => k.toUpperCase().replace(/[^A-Z0-9]/g, '') === stripped)\n    if (found2) return found2\n    return undefined\n  }\n\n  // More advanced resolver which accepts parsed details and prefers exact option contracts\n  const resolveMarketKeyFor = (base: string, opts: { type?: string, strike?: string, expiry?: string } = {}) => {\n    const keys = Object.keys(market?.symbols || {})\n    if (!base || keys.length === 0) return undefined\n    const upperBase = base.toUpperCase()\n\n    // Helper to normalize\n    const norm = (s: string) => s.toUpperCase().replace(/[^A-Z0-9]/g, '')\n\n    // If expiry + strike + type provided, try to find exact token containing all\n    if (opts.expiry || opts.strike || opts.type) {\n      const formattedExpiry = opts.expiry ? formatExpiryForKey(opts.expiry) : undefined\n      const candidates = keys.filter(k => {\n        const u = k.toUpperCase()\n        if (!u.includes(upperBase)) return false\n        if (opts.type && !u.includes(opts.type.toUpperCase())) return false\n        if (opts.strike && !u.match(new RegExp(`\\\\b${opts.strike}\\\\b`))) return false\n        if (formattedExpiry && !u.includes(formattedExpiry)) return false\n        return true\n      })\n      if (candidates.length > 0) return candidates[0]\n    }\n\n    // fallback: find any key that includes base + type\n    if (opts.type) {\n      const found = keys.find(k => k.toUpperCase().includes(upperBase) && k.toUpperCase().includes(opts.type.toUpperCase()))\n      if (found) return found\n    }\n\n    // fallback: broader matches\n    const foundAny = keys.find(k => k.toUpperCase().includes(upperBase))\n    if (foundAny) return foundAny\n\n    // last resort: stripped match\n    const strippedBase = norm(base)\n    const foundStripped = keys.find(k => norm(k).includes(strippedBase))\n    return foundStripped\n  }\n\n  // Update charts when form data changes\n  React.useEffect(() => {\n    const handler = async (e: any) => {\n      const data = e?.detail\n      if (!data?.symbol) return\n      const base = data.symbol\n      const expiry = data.expiryDate || ''\n      const callStrike = data.callStrike || ''\n      const putStrike = data.putStrike || ''\n\n      // Store token for underlying\n      if (data.token) {\n        setSelectedToken(data.token)\n      }\n\n      // If no expiry or strike selected, show underlying in center with placeholders\n      if (!expiry || !callStrike) {\n        // Show 3 charts: placeholder CE, underlying, placeholder PE\n        setSelected(['Call Option', base, 'Put Option'])\n        return\n      }\n\n      // Convert expiry to DDMMYY format for display\n      const parts = expiry.split('-')\n      if (parts.length === 3) {\n        const dd = parts[0]\n        const monthMap: Record<string, string> = {\n          'Jan': '01', 'Feb': '02', 'Mar': '03', 'Apr': '04', 'May': '05', 'Jun': '06',\n          'Jul': '07', 'Aug': '08', 'Sep': '09', 'Oct': '10', 'Nov': '11', 'Dec': '12'\n        }\n        const mm = monthMap[parts[1]] || '11'\n        const yy = parts[2].slice(-2)\n        const expiryCode = `${dd}${mm}${yy}`\n        const formattedExpiry = formatExpiry(expiryCode)\n        \n        // Clean base symbol for option names (remove -EQ suffix)\n        const cleanBase = base.replace(/-EQ$/, '').replace(/ /g, '')\n        \n        const left = `${cleanBase} ${formattedExpiry} ${callStrike} CE`\n        const middle = base\n        const right = `${cleanBase} ${formattedExpiry} ${putStrike} PE`\n        setSelected([left, middle, right])\n        \n        // Fetch option contracts and subscribe to their tokens\n        try {\n          const BACKEND_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:5000'\n          \n          // Clean symbol for API (remove -EQ suffix)\n          const apiSymbol = base.replace(/-EQ$/, '')\n          \n          const response = await fetch(\n            `${BACKEND_URL}/api/symbols/${encodeURIComponent(apiSymbol)}/option-contracts?expiry=${encodeURIComponent(expiry)}&strike=${callStrike}`\n          )\n          const result = await response.json()\n          \n          console.log('[PriceCharts] Option contracts API response:', result)\n          \n          if (result.success && result.data) {\n            const tokensToSubscribe = []\n            \n            // Add CE token - use the formatted display name (left) as the key\n            if (result.data.ce?.token) {\n              tokensToSubscribe.push({\n                token: result.data.ce.token,\n                exchange: result.data.ce.exchange || 'NFO',\n                symbol: left  // Use our display format as the key\n              })\n              console.log('[PriceCharts] CE contract:', result.data.ce)\n            }\n            \n            // Add PE token - use the formatted display name (right) as the key\n            if (result.data.pe?.token) {\n              tokensToSubscribe.push({\n                token: result.data.pe.token,\n                exchange: result.data.pe.exchange || 'NFO',\n                symbol: right  // Use our display format as the key\n              })\n              console.log('[PriceCharts] PE contract:', result.data.pe)\n            }\n            \n            // Add underlying token\n            if (data.token) {\n              tokensToSubscribe.push({\n                token: data.token,\n                exchange: data.exchange || 'NSE',\n                symbol: base\n              })\n            }\n            \n            // Subscribe to all tokens for real-time updates\n            if (tokensToSubscribe.length > 0 && market.subscribeTokens) {\n              console.log('[PriceCharts] Subscribing to option tokens:', tokensToSubscribe)\n              market.subscribeTokens(tokensToSubscribe)\n            }\n          }\n        } catch (error) {\n          console.error('[PriceCharts] Failed to fetch option contracts:', error)\n        }\n      }\n    }\n\n    window.addEventListener('tradeFormUpdated', handler as EventListener)\n    return () => window.removeEventListener('tradeFormUpdated', handler as EventListener)\n  }, [market.subscribeTokens])\n\n  // Helper to build L/H labels from live LTP\n  const buildLabels = React.useMemo(() => (symKey: string, parsed: any) => {\n    const resolvedKey = resolveMarketKeyFor(parsed.underlying, { type: parsed.type, strike: parsed.strike, expiry: parsed.expiry }) || resolveMarketKey(symKey)\n    const md = market.symbols[resolvedKey]\n    const ltp = md?.ltp ?? undefined\n    if (!md && ltp == null) return { leftLabel: 'L: —', rightLabel: 'H: —', middleLabel: '' }\n    const low = md?.low ?? (ltp != null ? Number((ltp * 0.98).toFixed(2)) : '—')\n    const high = md?.high ?? (ltp != null ? Number((ltp * 1.02).toFixed(2)) : '—')\n    return { leftLabel: `L: ${low}`, rightLabel: `H: ${high}`, middleLabel: '' }\n  }, [market.symbols])\n\n  return (\n    <div className=\"flex flex-col lg:flex-row gap-2\">\n      {/* Render charts without useMemo to ensure real-time updates */}\n      {selected.length > 0 && selected.map((sym, idx) => {\n        // attempt to extract strike/expiry for title details\n        const p = parseOption(sym)\n        const labels = buildLabels(sym, p)\n        // decide CE/PE: left = CE, middle = underlying (no option), right = PE\n        const pos = idx === 0 ? 'CE' : idx === 2 ? 'PE' : undefined\n        const color = idx === 2 ? 'text-red-600' : idx === 1 ? 'text-gray-900' : 'text-green-600'\n        // Prefer resolving with parsed details for better match on option contracts\n        const resolvedKey = resolveMarketKeyFor(p.underlying, { type: p.type, strike: p.strike, expiry: p.expiry }) || resolveMarketKey(sym)\n        const resolvedLtp = resolvedKey ? market.symbols[resolvedKey]?.ltp : market.symbols[sym]?.ltp\n        // Prefer token for middle chart if available; resolve to actual market key\n        let finalMarketKey = resolvedKey\n        if (idx === 1 && selectedToken) {\n          const byTok = findKeyByToken(selectedToken)\n          if (byTok) finalMarketKey = byTok\n        }\n        const finalResolvedLtp = finalMarketKey ? market.symbols[finalMarketKey]?.ltp : market.symbols[sym]?.ltp\n        \n        // Try exact match first, then fallback to resolved key\n        let bestMarketKey = market.symbols[sym] ? sym : finalMarketKey\n        \n        // Debug log\n        try { \n          console.debug('[PriceCharts] Resolution for', sym, ':', { \n            idx, \n            exactMatch: !!market.symbols[sym],\n            resolvedKey, \n            finalMarketKey: bestMarketKey, \n            finalResolvedLtp,\n            availableKeys: Object.keys(market.symbols).filter(k => k.includes(p.underlying)).slice(0, 5)\n          }) \n        } catch (e) {}\n        \n        return (\n          <PriceChart\n            key={sym + idx}\n            title={sym}\n            symbol={p.underlying}\n            strikePrice={p.strike}\n            expiry={p.expiry}\n            positionType={pos as any}\n            leftLabel={labels.leftLabel}\n            rightLabel={labels.rightLabel}\n            middleLabel={labels.middleLabel}\n            middleValue={finalResolvedLtp != null ? String(Number(finalResolvedLtp).toFixed(2)) : undefined}\n            marketKey={bestMarketKey}\n            textColor={color as any}\n            noBorder={true}\n          />\n        )\n      })}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2612, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/place-limit-order-dialog.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { X } from 'lucide-react'\nimport { useMarket } from '@/components/market/market-context'\n\ninterface PlaceLimitOrderDialogProps {\n  isOpen: boolean\n  onClose: () => void\n  orderType: 'sell-call' | 'buy-call' | 'buy-put' | 'sell-put'\n  symbol: string\n  expiry?: string\n  strike?: number\n  cepe?: 'CE' | 'PE'\n}\n\nexport function PlaceLimitOrderDialog({\n  isOpen,\n  onClose,\n  orderType,\n  symbol,\n  expiry,\n  strike,\n  cepe,\n}: PlaceLimitOrderDialogProps) {\n  const [orderTypeSelected, setOrderTypeSelected] = useState<'limit' | 'market' | 'sl-l' | 'sl-m' | 'mp'>('limit')\n  const [marginType, setMarginType] = useState<'margin' | 'intraday'>('margin')\n  const [buySellToggle, setBuySellToggle] = useState<'buy' | 'sell'>(orderType.includes('buy') ? 'buy' : 'sell')\n  const isBuy = buySellToggle === 'buy'\n  const [quantity, setQuantity] = useState(35)\n  const [price, setPrice] = useState(452.1)\n  const [isAMO, setIsAMO] = useState(false)\n  const [keepWindowOpen, setKeepWindowOpen] = useState(false)\n  const market = useMarket()\n\n  if (!isOpen) return null\n\n  const getDisplaySymbol = () => {\n    // Use the buySellToggle to reflect the current buy/sell selection in the header\n    const typeLabel = orderType.includes('call') ? 'CE' : 'PE'\n    const action = buySellToggle === 'sell' ? 'SELL' : 'BUY'\n    return `${action}: ${symbol.replace('CE', typeLabel)}`\n  }\n\n  const handlePlaceOrder = async () => {\n    try {\n      const orderData = {\n        symbol: symbol,\n        order_type: orderTypeSelected,\n        transaction_type: buySellToggle.toUpperCase(),\n        quantity: quantity,\n        price: orderTypeSelected === 'limit' ? price : 0,\n        trigger_price: orderTypeSelected.includes('sl') ? price : 0, // For stop loss orders\n        product_type: marginType === 'margin' ? 'MIS' : 'NRML'\n      }\n\n      const response = await fetch('http://localhost:5000/api/orders', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(orderData)\n      })\n\n      const result = await response.json()\n      \n      if (result.status) {\n        console.log('Limit order placed successfully:', result.data)\n        // Reset form or close dialog based on keepWindowOpen\n        if (!keepWindowOpen) {\n          onClose()\n        } else {\n          // Reset form but keep dialog open\n          setQuantity(35)\n          setPrice(452.1)\n        }\n      } else {\n        console.error('Failed to place limit order:', result.error)\n      }\n    } catch (error) {\n      console.error('Error placing limit order:', error)\n    }\n  }\n\n  const handleAddToBasket = () => {\n    try {\n      // Try to infer expiry/strike/cepe if not provided\n      const inferExpiry = expiry || ''\n      const inferStrike = strike || (() => {\n        try {\n          const parts = String(symbol).split('-')\n          // last-but-one part is strike when symbol is in form BASE-EXPIRY-STRIKE-CE/PE\n          if (parts.length >= 3) return Number(parts[parts.length - 2]) || 0\n        } catch (e) {}\n        return 0\n      })()\n      const inferCepe = cepe || (() => {\n        try {\n          const parts = String(symbol).split('-')\n          const last = parts[parts.length - 1]\n          if (last && (last.toUpperCase() === 'CE' || last.toUpperCase() === 'PE')) return last.toUpperCase() as 'CE' | 'PE'\n        } catch (e) {}\n        return 'CE'\n      })()\n\n      const position = {\n        symbol: symbol,\n        expiry: inferExpiry,\n        strike: Number(inferStrike || 0),\n        cepe: inferCepe,\n        qty: buySellToggle === 'sell' ? -Math.abs(quantity) : Math.abs(quantity),\n        type: orderTypeSelected === 'limit' ? 'LIMIT' : 'MKT',\n        price: orderTypeSelected === 'limit' ? Number(price) : 0,\n        ltp: market.symbols[symbol]?.ltp || (orderTypeSelected === 'limit' ? Number(price) : 0)\n      }\n\n      try {\n        window.dispatchEvent(new CustomEvent('addToBasket', { detail: position }))\n      } catch (err) {\n        try { window.postMessage({ type: 'addToBasket', detail: position }, '*') } catch (e) { }\n      }\n      try { localStorage.setItem('lastAddToBasket', JSON.stringify({ data: position })) } catch (e) { }\n\n      // give a small confirmation by closing or keeping open according to keepWindowOpen\n      if (!keepWindowOpen) onClose()\n    } catch (err) {\n      console.error('Failed to add to basket from dialog', err)\n    }\n  }\n\n  return (\n    <div\n      className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/0\"\n      onClick={(e) => { if (e.target === e.currentTarget) onClose() }}\n    >\n      <div className=\"bg-white w-full max-w-md rounded-lg overflow-hidden shadow-xl mx-2\">\n        {/* Header */}\n        <div className={`${isBuy ? 'bg-green-600' : 'bg-red-600'} text-white px-6 py-3 flex items-center justify-between`}> \n          <h2 className=\"text-sm font-bold\">{getDisplaySymbol()}</h2>\n          <button\n            onClick={onClose}\n              className={`${isBuy ? 'hover:bg-green-700' : 'hover:bg-red-700'} p-1 rounded transition-colors`}\n          >\n              <span className={`inline-flex items-center justify-center w-7 h-7 rounded-full bg-white ${isBuy ? 'border-green-600 text-green-600' : 'border-red-600 text-red-600'} border ring-0`}> \n                <X className=\"w-4 h-4\" />\n              </span>\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-3 sm:p-4 space-y-4\">\n          {/* LTP and Toggles */}\n          <div className=\"space-y-4\">\n            <div className=\"text-base font-semibold\">LTP: {market.symbols[symbol]?.ltp ?? price}</div>\n\n            {/* Margin/Intraday Toggle */}\n            <div className=\"flex gap-1\">\n              <button\n                onClick={() => setMarginType('margin')}\n                className={`px-3 py-1.5 rounded text-xs font-semibold transition-colors ${\n                  marginType === 'margin'\n                    ? (isBuy ? 'bg-green-600 text-white' : 'bg-red-600 text-white')\n                    : (isBuy ? 'bg-white text-green-600 border border-green-600' : 'bg-white text-red-600 border border-red-600')\n                }`}\n              >\n                MARGIN\n              </button>\n              <button\n                onClick={() => setMarginType('intraday')}\n                className={`px-3 py-1.5 rounded text-xs font-semibold transition-colors ${\n                  marginType === 'intraday'\n                    ? (isBuy ? 'bg-green-600 text-white' : 'bg-red-600 text-white')\n                    : (isBuy ? 'bg-white text-green-600 border border-green-600' : 'bg-white text-red-600 border border-red-600')\n                }`}\n              >\n                INTRADAY\n              </button>\n            </div>\n\n            {/* Buy/Sell Toggle */}\n            {/* Buy/Sell Toggle */}\n              <div className=\"flex gap-3 items-center justify-between\">\n                <span className=\"text-xs font-medium\">BUY</span>\n                <div\n                  onClick={() => setBuySellToggle(buySellToggle === 'buy' ? 'sell' : 'buy')}\n                  role=\"switch\"\n                  aria-checked={isBuy}\n                  tabIndex={0}\n                  className={`relative w-14 h-7 rounded-full cursor-pointer transition-colors flex items-center ${isBuy ? 'bg-green-600' : 'bg-red-600'}`}\n                  onKeyDown={(e) => { if (e.key === 'Enter' || e.key === ' ') setBuySellToggle(buySellToggle === 'buy' ? 'sell' : 'buy') }}\n                >\n                  <div className={`absolute w-6 h-6 rounded-full bg-white shadow-md transform transition-transform ${isBuy ? 'translate-x-7' : 'translate-x-1'}`} />\n                </div>\n                <span className=\"text-xs font-medium\">SELL</span>\n              </div>\n          </div>\n\n          {/* Order Type Selection */}\n          <div className=\"flex flex-wrap gap-1\">\n            {[\n              { id: 'limit', label: 'LIMIT' },\n              { id: 'market', label: 'MARKET' },\n              { id: 'mp', label: 'MARKET PROTECTION' },\n              { id: 'sl-l', label: 'SL-L' },\n              { id: 'sl-m', label: 'SL-M' },\n            ].map((type) => (\n              <button\n                key={type.id}\n                onClick={() => setOrderTypeSelected(type.id as any)}\n                className={`px-2 py-1 rounded text-xs font-semibold transition-colors ${\n                  orderTypeSelected === type.id\n                    ? (isBuy ? 'bg-green-600 text-white' : 'bg-red-600 text-white')\n                    : (isBuy ? 'bg-white text-green-600 border border-green-600' : 'bg-white text-red-600 border border-red-600')\n                }`}\n              >\n                {type.label}\n              </button>\n            ))}\n          </div>\n\n          {/* Quantity and Price */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n            {/* Quantity */}\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-medium text-gray-600\">Qty (Lot size: 1)</label>\n              <div className=\"flex items-center border border-gray-300 rounded\">\n                <button\n                  onClick={() => setQuantity(Math.max(1, quantity - 1))}\n                  className=\"flex-1 py-1 text-center hover:bg-gray-100 text-base\"\n                >\n                  −\n                </button>\n                <input\n                  type=\"number\"\n                  value={quantity}\n                  onChange={(e) => setQuantity(parseInt(e.target.value) || 1)}\n                  className=\"flex-1 text-center py-1.5 border-0 focus:outline-none text-sm\"\n                />\n                <button\n                  onClick={() => setQuantity(quantity + 1)}\n                  className=\"flex-1 py-1 text-center hover:bg-gray-100 text-base\"\n                >\n                  +\n                </button>\n              </div>\n            </div>\n\n            {/* Price */}\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-medium text-gray-600\">Price(Tick size: 0.05)</label>\n              <div className={`${isBuy ? 'border-green-600' : 'border-red-600'} border rounded`}>\n                <input\n                  type=\"number\"\n                  value={price}\n                  onChange={(e) => setPrice(parseFloat(e.target.value) || 0)}\n                  className=\"w-full py-1.5 px-2 focus:outline-none text-sm\"\n                />\n                <div className={`flex justify-between px-2 py-1 ${isBuy ? 'border-t border-green-600' : 'border-t border-red-600'} text-gray-400 text-xs`}>\n                  <button className=\"hover:text-gray-600\">▲</button>\n                  <button className=\"hover:text-gray-600\">▼</button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Checkboxes */}\n          <div className=\"space-y-3\">\n            <label className=\"flex items-center gap-3 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={isAMO}\n                onChange={(e) => setIsAMO(e.target.checked)}\n                className={`w-4 h-4 border rounded ${isBuy ? 'border-green-600' : 'border-red-600'}`}\n              />\n              <span className=\"text-sm text-gray-700\">Is AMO Order</span>\n            </label>\n            <label className=\"flex items-center gap-3 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={keepWindowOpen}\n                onChange={(e) => setKeepWindowOpen(e.target.checked)}\n                className={`w-4 h-4 border rounded ${isBuy ? 'border-green-600' : 'border-red-600'}`}\n              />\n              <span className=\"text-sm text-gray-700\">Keep this window open after placing the order</span>\n            </label>\n          </div>\n\n          {/* Disclaimer */}\n          <div className=\"bg-gray-50 p-3 rounded text-xs text-gray-600 space-y-1\">\n            <p>• If the user places a limit order and it goes into pending status, the Positions will not be automatically update after the pending limit order is executed, and the user must click the refresh button located near the funds tab.</p>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex flex-col md:flex-row gap-2 items-center md:items-stretch\">\n            <button\n              onClick={onClose}\n              className=\"w-full md:flex-1 px-3 py-2 bg-gray-200 text-gray-700 rounded font-semibold text-sm hover:bg-gray-300 transition-colors shadow-sm\"\n            >\n              CANCEL\n            </button>\n            <button\n              onClick={handleAddToBasket}\n              className=\"w-full md:flex-1 px-3 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded font-semibold text-sm transition-colors shadow-md\"\n            >\n              ADD TO BASKET\n            </button>\n            <button\n              onClick={handlePlaceOrder}\n              className={`w-full md:flex-1 px-3 py-2 ${isBuy ? 'bg-green-600 hover:bg-green-700' : 'bg-red-600 hover:bg-red-700'} text-white rounded font-semibold text-sm transition-colors shadow-md`}\n            >\n              PLACE ORDER\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3183, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/action-buttons.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useMarket } from '@/components/market/market-context'\nimport { ArrowLeft, ArrowRight, RotateCw } from 'lucide-react'\nimport { PlaceLimitOrderDialog } from './place-limit-order-dialog'\n\nexport function ActionButtons({ selectedBroker, tradingMode }: { selectedBroker: string | null; tradingMode: 'paper' | 'live' }) {\n  const [openDropdown, setOpenDropdown] = useState<string | null>(null)\n  const [showLimitDialog, setShowLimitDialog] = useState(false)\n  const [selectedOrder, setSelectedOrder] = useState<{\n    type: 'sell-call' | 'buy-call' | 'buy-put' | 'sell-put'\n    symbol: string\n  } | null>(null)\n  const [message, setMessage] = useState<string>('-')\n  const [formData, setFormData] = useState<any>(null)\n  const market = useMarket()\n\n  useEffect(() => {\n    const handler = (e: any) => setFormData(e.detail)\n    window.addEventListener('tradeFormUpdated', handler)\n    return () => window.removeEventListener('tradeFormUpdated', handler)\n  }, [])\n\n  // handle dropdown actions (small ▼ button) e.g. place-limit-order\n  const handleDropdownAction = (action: string, orderType: string) => {\n    // Close the dropdown\n    setOpenDropdown(null)\n    if (action === 'place-limit-order') {\n      // open the limit dialog and pre-fill selectedOrder\n      setSelectedOrder({ type: orderType as any, symbol: formData?.symbol || '' })\n      setShowLimitDialog(true)\n      return\n    }\n    if (action === 'add-to-bucket') {\n      // Build position data from latest formData and the orderType from the button\n      try {\n        // helper: format expiry like '25-Nov-2025' -> '25-NOV-25'\n        const formatExpiryForSymbol = (expiry: string) => {\n          const parts = String(expiry || '').split('-')\n          if (parts.length !== 3) return expiry\n          const day = parts[0]\n          const month = parts[1].toUpperCase()\n          const year = parts[2].slice(-2)\n          return `${day}-${month}-${year}`\n        }\n\n        const resolveOptionLtp = (underlying: string, expiryRaw: string, strike: string, side: 'CE' | 'PE') => {\n          try {\n            const formattedExpiry = formatExpiryForSymbol(expiryRaw || '')\n            const targetKey = `${underlying}-${formattedExpiry}-${strike}-${side}`\n            const direct = market?.symbols?.[targetKey]?.ltp\n            if (direct !== undefined) return direct\n\n            // fallback: search for best match\n            const entries = Object.entries(market?.symbols || {})\n            for (const [k, v] of entries) {\n              try {\n                const ku = k.toUpperCase()\n                if (!ku.includes(String(underlying).toUpperCase())) continue\n                if (!ku.includes(String(strike))) continue\n                if (!ku.endsWith(side)) continue\n                if (v && typeof v.ltp === 'number') return v.ltp\n              } catch (e) {}\n            }\n          } catch (e) {}\n          // final fallback: use underlying symbol LTP if available\n          try {\n            const base = market?.symbols?.[underlying]\n            if (base && typeof base.ltp === 'number') return base.ltp\n          } catch (e) {}\n          return undefined\n        }\n\n        const qtyRaw = parseInt(formData?.qty || '1') || 1\n        const isSell = orderType.startsWith('sell')\n        const isCall = orderType.includes('call')\n\n        const position = {\n          symbol: formData?.symbol || '',\n          expiry: formData?.expiryDate || formData?.expiry || '',\n          strike: Number(isCall ? formData?.callStrike || 0 : formData?.putStrike || 0) || 0,\n          cepe: isCall ? 'CE' : 'PE',\n          qty: isSell ? -Math.abs(qtyRaw) : Math.abs(qtyRaw),\n          type: formData?.orderType === 'Limit' ? 'LIMIT' : 'MKT',\n          price: formData?.price ? Number(formData.price) : 0,\n          ltp: 0\n        }\n\n        // Try to resolve live LTP from market context for the specific option\n        try {\n          const strikeStr = String(position.strike || '')\n          const side = position.cepe\n          const marketLtp = resolveOptionLtp(position.symbol || 'BANKNIFTY', position.expiry || '', strikeStr, side)\n          if (marketLtp !== undefined) position.ltp = marketLtp\n          else if (position.price) position.ltp = position.price\n        } catch (e) {\n          // ignore\n        }\n\n        // Dispatch CustomEvent that `BasketOrderTab` listens for\n        try {\n          window.dispatchEvent(new CustomEvent('addToBasket', { detail: position }))\n        } catch (err) {\n          console.warn('CustomEvent dispatch failed, falling back to postMessage', err)\n          try { window.postMessage({ type: 'addToBasket', detail: position }, '*') } catch (e) { }\n        }\n\n        // Also write a debug key so BasketOrderTab can recover if mounted later\n        try { localStorage.setItem('lastAddToBasket', JSON.stringify({ data: position })) } catch (e) { }\n\n        setMessage('Added to bucket')\n      } catch (err) {\n        console.error('Error preparing add-to-bucket position', err)\n        setMessage('Failed to add to bucket')\n      }\n\n      return\n    }\n  }\n\n  const placeOrder = async (orderType: string, transactionType: 'BUY' | 'SELL') => {\n    if (!formData) {\n      setMessage('Form data not available')\n      return\n    }\n\n    try {\n      setMessage('Placing order...')\n      \n      // Map order type to backend format\n      let order_type = 'MARKET'\n      let price = null\n      let trigger_price = null\n      let market_protection_percentage = null\n\n      if (formData.orderType === 'LIMIT') {\n        order_type = 'LIMIT'\n        price = formData.price ? parseFloat(formData.price) : null\n      } else if (formData.orderType === 'MARKET') {\n        order_type = 'MARKET'\n        price = null // Will be set to LTP in backend\n      } else if (formData.orderType === 'SL-M') {\n        order_type = 'STOPLOSS_MARKET'\n        trigger_price = formData.triggerPrice ? parseFloat(formData.triggerPrice) : null\n      } else if (formData.orderType === 'SL-L') {\n        order_type = 'STOPLOSS_LIMIT'\n        trigger_price = formData.triggerPrice ? parseFloat(formData.triggerPrice) : null\n        price = formData.price ? parseFloat(formData.price) : null\n      } else if (formData.orderType === 'MARKET_PROTECTION') {\n        order_type = 'MARKET_PROTECTION'\n        price = null\n        market_protection_percentage = formData.marketProtection \n          ? parseFloat(formData.marketProtection.replace('%', '')) \n          : 5 // default 5%\n      }\n\n      // Map product type to backend format\n      let product_type = 'INTRADAY'\n      if (formData.productType === 'MARGIN') {\n        product_type = 'DELIVERY'\n      } else if (formData.productType === 'INTRADAY') {\n        product_type = 'INTRADAY'\n      }\n\n      const orderData = {\n        symbol: formData.symbol,\n        order_type,\n        transaction_type: transactionType,\n        quantity: parseInt(formData.qty) || 1,\n        price,\n        trigger_price,\n        market_protection_percentage,\n        product_type,\n        predefined_sl: formData.predefinedSL || false,\n        target_price: formData.targetPrice ? parseFloat(formData.targetPrice) : null,\n        tradingMode\n      }\n\n      let url = 'http://localhost:5000/api/orders'\n      if (selectedBroker && tradingMode === 'live') {\n        url = `http://localhost:5000/api/brokers/${selectedBroker}/orders`\n      }\n\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(orderData)\n      })\n\n      const result = await response.json()\n      \n      if (result.status) {\n        setMessage(`Order placed successfully: ${result.data?.id || 'Unknown'}`)\n      } else {\n        setMessage(`Order failed: ${result.error || 'Unknown error'}`)\n      }\n    } catch (error) {\n      setMessage(`Error placing order: ${error.message}`)\n    }\n  }\n\n  const closeAllPositions = async () => {\n    try {\n      setMessage('Closing all positions...')\n      // TODO: Implement close all positions functionality\n      setMessage('Close all positions feature not yet implemented')\n    } catch (error) {\n      setMessage(`Error closing positions: ${error.message}`)\n    }\n  }\n\n  const cancelAllOrders = async () => {\n    try {\n      setMessage('Cancelling all orders...')\n      // Get all pending orders and cancel them\n      const response = await fetch('http://localhost:5000/api/orders')\n      const data = await response.json()\n      \n      if (data.status && data.data) {\n        const pendingOrders = data.data.filter((order: any) => order.order_status === 'pending')\n        for (const order of pendingOrders) {\n          await fetch(`http://localhost:5000/api/orders/${order.id}/cancel`, {\n            method: 'PUT'\n          })\n        }\n        setMessage(`Cancelled ${pendingOrders.length} pending orders`)\n      }\n    } catch (error) {\n      setMessage(`Error cancelling orders: ${error.message}`)\n    }\n  }\n\n  const DropdownMenu = ({ orderType }: { orderType: string }) => {\n    const isOpen = openDropdown === orderType\n    return (\n      <div className=\"relative\">\n        <button\n          onClick={() => setOpenDropdown(isOpen ? null : orderType)}\n          className=\"w-9 h-9 flex items-center justify-center bg-white text-gray-600 border border-gray-300 rounded shadow-sm text-xs hover:bg-gray-50 transition-colors\"\n        >\n          ▼\n        </button>\n        {isOpen && (\n          <div className=\"absolute right-0 mt-1 bg-white border border-gray-300 rounded shadow-lg z-10 min-w-max\">\n            <button\n              onClick={() => handleDropdownAction('add-to-bucket', orderType)}\n              className=\"block w-full text-left px-3 py-2 text-xs hover:bg-gray-100 border-b border-gray-200\"\n            >\n              Add to bucket\n            </button>\n            <button\n              onClick={() => handleDropdownAction('place-limit-order', orderType)}\n              className=\"block w-full text-left px-3 py-2 text-xs hover:bg-gray-100\"\n            >\n              Place limit order\n            </button>\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"space-y-2\">\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-2 items-center\">\n          {/* Left column: Call side */}\n          <div className=\"flex items-center gap-2 md:justify-start flex-wrap\">\n            <div className=\"flex items-center gap-2\">\n              <button\n                className=\"flex items-center justify-center gap-1 px-4 py-2 bg-red-600 text-white rounded text-sm font-semibold hover:bg-red-700 transition-colors\"\n                onClick={() => placeOrder('sell-call', 'SELL')}\n              >\n                <ArrowLeft className=\"w-4 h-4\" />\n                Sell Call\n              </button>\n              <DropdownMenu orderType=\"sell-call\" />\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <button\n                className=\"flex items-center justify-center gap-1 px-4 py-2 bg-green-600 text-white rounded text-sm font-semibold hover:bg-green-700 transition-colors\"\n                onClick={() => placeOrder('buy-call', 'BUY')}\n              >\n                <ArrowLeft className=\"w-4 h-4 rotate-180\" />\n                Buy Call\n              </button>\n              <DropdownMenu orderType=\"buy-call\" />\n            </div>\n          </div>\n\n          {/* Middle column: global actions */}\n          <div className=\"flex flex-col items-center gap-2\">\n            <div className=\"flex items-center gap-2\">\n              <button \n                onClick={closeAllPositions}\n                className=\"px-6 py-2 bg-white text-red-600 border border-red-600 rounded-lg text-sm font-semibold hover:bg-red-50 transition-colors\"\n              >\n                Close All Positions / F6\n              </button>\n              <button \n                onClick={cancelAllOrders}\n                className=\"px-6 py-2 bg-white text-red-600 border border-red-600 rounded-lg text-sm font-semibold hover:bg-red-50 transition-colors\"\n              >\n                Cancel All Orders / F7\n              </button>\n              <button className=\"px-3 py-2 bg-white border border-gray-300 rounded hover:bg-gray-50 flex items-center justify-center\">\n                <RotateCw className=\"w-5 h-5 text-gray-600\" />\n              </button>\n            </div>\n          </div>\n\n          {/* Right column: Put side */}\n          <div className=\"flex items-center gap-2 md:justify-end flex-wrap\">\n            <div className=\"flex items-center gap-2\">\n              <button\n                className=\"flex items-center justify-center gap-1 px-4 py-2 bg-green-600 text-white rounded text-sm font-semibold hover:bg-green-700 transition-colors\"\n                onClick={() => placeOrder('buy-put', 'BUY')}\n              >\n                <ArrowLeft className=\"w-4 h-4 rotate-180\" />\n                Buy Put\n              </button>\n              <DropdownMenu orderType=\"buy-put\" />\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <button\n                className=\"flex items-center justify-center gap-1 px-4 py-2 bg-red-600 text-white rounded text-sm font-semibold hover:bg-red-700 transition-colors\"\n                onClick={() => placeOrder('sell-put', 'SELL')}\n              >\n                <ArrowRight className=\"w-4 h-4\" />\n                Sell Put\n              </button>\n              <DropdownMenu orderType=\"sell-put\" />\n            </div>\n          </div>\n        </div>\n\n        <p className=\"text-xs text-gray-600 text-center py-1\">Message: {message}</p>\n      </div>\n\n      {selectedOrder && (\n        <PlaceLimitOrderDialog\n          isOpen={showLimitDialog}\n          onClose={() => {\n            setShowLimitDialog(false)\n            setSelectedOrder(null)\n          }}\n          orderType={selectedOrder.type}\n          symbol={selectedOrder.symbol}\n        />\n      )}\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3732, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/dialog.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as DialogPrimitive from '@radix-ui/react-dialog'\nimport { XIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',\n          className,\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn('flex flex-col gap-2 text-center sm:text-left', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        'flex flex-col-reverse gap-2 sm:flex-row sm:justify-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn('text-lg leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,6KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,6LAAC,gLAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS;AAMT,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,6LAAC,+KAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,6LAAC,gLAAuB;QACtB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,6LAAC;QAAa,aAAU;;0BACtB,6LAAC;;;;;0BACD,6LAAC,gLAAuB;gBACtB,aAAU;gBACV,WAAW,IAAA,qHAAE,EACX,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,6LAAC,8KAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,6LAAC,4MAAK;;;;;0CACN,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;MAhCS;AAkCT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,6LAAC,oLAA2B;QAC1B,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 3938, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/checkbox.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as CheckboxPrimitive from '@radix-ui/react-checkbox'\nimport { CheckIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Checkbox({\n  className,\n  ...props\n}: React.ComponentProps<typeof CheckboxPrimitive.Root>) {\n  return (\n    <CheckboxPrimitive.Root\n      data-slot=\"checkbox\"\n      className={cn(\n        'peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-lg border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    >\n      <CheckboxPrimitive.Indicator\n        data-slot=\"checkbox-indicator\"\n        className=\"flex items-center justify-center text-current transition-none\"\n      >\n        <CheckIcon className=\"size-3.5\" />\n      </CheckboxPrimitive.Indicator>\n    </CheckboxPrimitive.Root>\n  )\n}\n\nexport { Checkbox }\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACiD;IACpD,qBACE,6LAAC,+KAAsB;QACrB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4eACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,aAAU;YACV,WAAU;sBAEV,cAAA,6LAAC,wNAAS;gBAAC,WAAU;;;;;;;;;;;;;;;;AAI7B;KArBS"}},
    {"offset": {"line": 3988, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/column-settings.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React from 'react'\r\nimport { Dialog, DialogContent, DialogFooter, DialogClose } from '@/components/ui/dialog'\r\nimport { Checkbox } from '@/components/ui/checkbox'\r\n\r\ntype ColumnOption = { id: string; label: string }\r\n\r\nexport default function ColumnSettings({ open, onOpenChange, columns, selected, onSave, onReset }: {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  columns: ColumnOption[]\r\n  selected: Record<string, boolean>\r\n  onSave: (selected: Record<string, boolean>) => void\r\n  onReset: () => void\r\n}) {\r\n  const [local, setLocal] = React.useState<Record<string, boolean>>(selected)\r\n\r\n  React.useEffect(() => setLocal(selected), [selected])\r\n\r\n  const toggle = (id: string) => setLocal(prev => ({ ...prev, [id]: !prev[id] }))\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-[380px] p-0 overflow-hidden\">\r\n        <div className=\"bg-red-700 text-white px-4 py-3 flex items-center justify-between\">\r\n          <div className=\"text-lg font-semibold\">Column Setting</div>\r\n          <DialogClose>\r\n            <span className=\"size-5\">✕</span>\r\n          </DialogClose>\r\n        </div>\r\n\r\n        <div className=\"p-4 max-h-[340px] overflow-auto\">\r\n          <div className=\"grid grid-cols-2 gap-x-6 gap-y-3 items-center text-sm\">\r\n            <div className=\"font-semibold text-gray-700\">Column</div>\r\n            <div className=\"font-semibold text-gray-700\">Select Column</div>\r\n            {columns.map(col => (\r\n              <React.Fragment key={col.id}>\r\n                <div className=\"text-gray-700\">{col.label}</div>\r\n                <div className=\"flex justify-end\">\r\n                  <Checkbox className=\"data-[state=checked]:bg-red-600 data-[state=checked]:border-red-600\" checked={!!local[col.id]} onCheckedChange={() => toggle(col.id)} />\r\n                </div>\r\n              </React.Fragment>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter className=\"px-4 py-4\">\r\n          <div className=\"flex items-center justify-between w-full\">\r\n            <button className=\"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded\" onClick={() => onOpenChange(false)}>CANCEL</button>\r\n            <button className=\"px-4 py-2 text-sm bg-red-600 text-white rounded\" onClick={() => { onSave(local); onOpenChange(false) }}>SAVE SETTING</button>\r\n          </div>\r\n          <div className=\"mt-3\">\r\n            <button className=\"w-full px-4 py-3 text-sm border border-red-600 text-red-600 rounded\" onClick={() => { onReset(); onOpenChange(false) }}>RESET COLUMN SETTING AND POSITION</button>\r\n          </div>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAQe,SAAS,eAAe,EAAE,IAAI,EAAE,YAAY,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAO9F;;IACC,MAAM,CAAC,OAAO,SAAS,GAAG,wKAAK,CAAC,QAAQ,CAA0B;IAElE,wKAAK,CAAC,SAAS;oCAAC,IAAM,SAAS;mCAAW;QAAC;KAAS;IAEpD,MAAM,SAAS,CAAC,KAAe,SAAS,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,GAAG;YAAC,CAAC;IAE7E,qBACE,6LAAC,wIAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,6LAAC,+IAAa;YAAC,WAAU;;8BACvB,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;sCAAwB;;;;;;sCACvC,6LAAC,6IAAW;sCACV,cAAA,6LAAC;gCAAK,WAAU;0CAAS;;;;;;;;;;;;;;;;;8BAI7B,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CAA8B;;;;;;0CAC7C,6LAAC;gCAAI,WAAU;0CAA8B;;;;;;4BAC5C,QAAQ,GAAG,CAAC,CAAA,oBACX,6LAAC,wKAAK,CAAC,QAAQ;;sDACb,6LAAC;4CAAI,WAAU;sDAAiB,IAAI,KAAK;;;;;;sDACzC,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,4IAAQ;gDAAC,WAAU;gDAAsE,SAAS,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;gDAAE,iBAAiB,IAAM,OAAO,IAAI,EAAE;;;;;;;;;;;;mCAHvI,IAAI,EAAE;;;;;;;;;;;;;;;;8BAUjC,6LAAC,8IAAY;oBAAC,WAAU;;sCACtB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAO,WAAU;oCAAsD,SAAS,IAAM,aAAa;8CAAQ;;;;;;8CAC5G,6LAAC;oCAAO,WAAU;oCAAkD,SAAS;wCAAQ,OAAO;wCAAQ,aAAa;oCAAO;8CAAG;;;;;;;;;;;;sCAE7H,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAO,WAAU;gCAAsE,SAAS;oCAAQ;oCAAW,aAAa;gCAAO;0CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMvJ;GAnDwB;KAAA"}},
    {"offset": {"line": 4196, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/positions-table.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport ColumnSettings from './column-settings'\nimport { Settings } from 'lucide-react'\n\ninterface Position {\n  symboltoken: string\n  symbolname: string\n  netqty: number\n  avgnetprice: number\n  ltp: number\n  pnl: number\n  unrealised: number\n  realised: number\n  broker_id?: number\n  brokerId?: number\n}\n\ninterface Broker {\n  id: number\n  name: string\n  broker_type: string\n  is_active: boolean\n}\n\ninterface TableColumn {\n  id: string\n  label: string\n  sortable?: boolean\n}\n\nconst allColumns: TableColumn[] = [\n  { id: 'symbol', label: 'Symbol Name', sortable: true },\n  { id: 's', label: 'Side', sortable: true },\n  { id: 'net', label: 'Net Qty', sortable: false },\n  { id: 'avgprice', label: 'Avg Price', sortable: false },\n  { id: 'ltp', label: 'LTP', sortable: false },\n  { id: 'sl', label: 'SL', sortable: false },\n  { id: 'setsl', label: 'Set SL', sortable: false },\n  { id: 'target', label: 'Target', sortable: false },\n  { id: 'settarget', label: 'Set Target', sortable: false },\n  { id: 'rpal', label: 'R. P&L', sortable: false },\n  { id: 'urpal', label: 'UR. P&L', sortable: false },\n  { id: 'pal', label: 'P&L', sortable: false },\n  { id: 'action', label: 'Action', sortable: false },\n  { id: 'buy', label: 'Buy Qty', sortable: false },\n  { id: 'buypri', label: 'Buy Price', sortable: false },\n  { id: 'sellpri', label: 'Sell Price', sortable: false },\n  { id: 'sellqty', label: 'Sell Qty', sortable: false },\n  { id: 'product', label: 'Product', sortable: false },\n]\n\nexport function PositionsTable({ openSettings, onOpenSettings, disableFetch, tradingMode = 'paper' }: { openSettings?: boolean, onOpenSettings?: (open: boolean) => void, disableFetch?: boolean, tradingMode?: 'paper' | 'live' }) {\n  const [positions, setPositions] = useState<Position[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [brokers, setBrokers] = useState<Broker[]>([])\n  const [selectedBrokerId, setSelectedBrokerId] = useState<number | null>(null)\n  const [loadingBrokers, setLoadingBrokers] = useState(false)\n  const [showColumnSettingsState, setShowColumnSettingsState] = useState<boolean>(() => !!openSettings)\n  useEffect(() => {\n    if (typeof openSettings !== 'undefined') setShowColumnSettingsState(openSettings)\n  }, [openSettings])\n\n  const setShowColumnSettings = (open: boolean) => {\n    setShowColumnSettingsState(open)\n    onOpenSettings?.(open)\n  }\n\n  const DEFAULT_COLS = allColumns.reduce((acc, c) => ({ ...acc, [c.id]: true }), {} as Record<string, boolean>)\n  const [visibleCols, setVisibleCols] = useState<Record<string, boolean>>(() => {\n    // First try to load from backend, fallback to localStorage, then defaults\n    try {\n      const backendSettings = localStorage.getItem('backend-column-settings-positions')\n      if (backendSettings) {\n        return JSON.parse(backendSettings)\n      }\n      \n      const raw = localStorage.getItem('positions-columns')\n      if (raw) return JSON.parse(raw)\n    } catch (e) {\n      // ignore\n    }\n    return DEFAULT_COLS\n  })\n\n  // Load column settings from backend on mount\n  useEffect(() => {\n    const loadBackendSettings = async () => {\n      try {\n        const response = await fetch('http://localhost:5000/api/column-settings/positions')\n        const data = await response.json()\n        if (data.status && data.data) {\n          setVisibleCols(data.data)\n          localStorage.setItem('backend-column-settings-positions', JSON.stringify(data.data))\n        }\n      } catch (error) {\n        console.error('Error loading column settings from backend:', error)\n      }\n    }\n    \n    if (!disableFetch) {\n      loadBackendSettings()\n    }\n  }, [disableFetch])\n\n  useEffect(() => {\n    if (disableFetch) {\n      // Use local empty dataset and don't attempt the remote fetch\n      setPositions([])\n      setLoading(false)\n      setError(null)\n      return\n    }\n    fetchPositions()\n    fetchBrokers()\n  }, [disableFetch])\n\n  useEffect(() => {\n    if (!disableFetch) {\n      fetchPositions()\n    }\n  }, [selectedBrokerId, tradingMode])\n\n  const fetchBrokers = async () => {\n    setLoadingBrokers(true)\n    try {\n      const response = await fetch('http://localhost:5000/api/brokers')\n      const data = await response.json()\n      if (data.status && data.data) {\n        setBrokers(data.data.filter((b: Broker) => b.is_active))\n      }\n    } catch (error) {\n      console.error('Error fetching brokers:', error)\n    } finally {\n      setLoadingBrokers(false)\n    }\n  }\n\n  const fetchPositions = async () => {\n    try {\n      setLoading(true)\n      let url = `http://localhost:5000/api/positions?tradingMode=${tradingMode}`\n      if (selectedBrokerId) {\n        url += `&brokerId=${selectedBrokerId}`\n      }\n      console.log('Fetching positions with URL:', url)\n      const response = await fetch(url)\n      const data = await response.json()\n      console.log('Positions API response:', data)\n      \n      if (data.status && data.data) {\n        console.log(`Found ${data.data.length} positions`)\n        const mappedPositions = data.data.map(pos => ({\n          symboltoken: pos.symbol_id?.toString() || '',\n          symbolname: pos.symbol_name || pos.symbol || 'Unknown',\n          netqty: parseFloat(pos.quantity) || 0,\n          avgnetprice: parseFloat(pos.average_price) || 0,\n          ltp: parseFloat(pos.average_price) || 0, // Use avg price as LTP until real market data is available\n          pnl: parseFloat(pos.pnl) || 0,\n          unrealised: parseFloat(pos.unrealised) || 0,\n          realised: parseFloat(pos.realised) || 0,\n          brokerId: pos.broker_id ?? pos.brokerId\n        }))\n        console.log('Mapped positions:', mappedPositions)\n        setPositions(mappedPositions)\n      } else {\n        setPositions([])\n        setError('Error fetching positions')\n      }\n    } catch (err) {\n      // Avoid exposing remote data errors to the table — show a friendly error and clear rows.\n      setPositions([])\n      setError('Error fetching positions')\n      console.error('Error fetching positions:', err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // We want to keep table header & settings available even when we show loading or error state.\n  // Avoid returning early so the settings button can always be shown.\n\n  return (\n    <div className=\"overflow-x-auto h-full bg-white\">\n      {/* Broker Filter */}\n      <div className=\"p-4 bg-gray-50 border-b border-gray-200\">\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-sm font-medium text-gray-700\">Broker:</label>\n            <select\n              value={selectedBrokerId || ''}\n              onChange={(e) => setSelectedBrokerId(e.target.value ? parseInt(e.target.value) : null)}\n              className=\"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n              <option value=\"\">All Brokers</option>\n              {brokers.map(broker => (\n                <option key={broker.id} value={broker.id}>{broker.name}</option>\n              ))}\n            </select>\n          </div>\n          <button\n            onClick={() => fetchPositions()}\n            className=\"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n          >\n            Refresh\n          </button>\n        </div>\n      </div>\n\n      {/* Settings button removed here (use the MTM bar gear instead). */}\n      {/* If loading, show placeholder in the table area */}\n      {loading && (\n        <div className=\"px-3 py-8 text-center text-gray-500\">Loading positions...</div>\n      )}\n      <div className=\"overflow-x-auto\">\n        <table className=\"w-full text-xs min-w-max whitespace-nowrap\">\n        <thead className=\"bg-gray-50 border-b border-gray-200 sticky top-0\">\n          <tr>\n            <th className=\"px-3 py-2 text-left\">\n              <input type=\"checkbox\" className=\"w-3 h-3 rounded border-gray-300 cursor-pointer\" />\n            </th>\n            {allColumns.filter(c => visibleCols[c.id]).map(col => (\n              <th\n                key={col.id}\n                className={`px-4 py-3 text-left font-medium text-gray-700 ${col.sortable ? 'cursor-pointer hover:bg-gray-100' : ''}`}\n              >\n                <div className=\"flex items-center gap-1\">\n                  {col.label}\n                  {col.sortable && <span className=\"text-xs\">↓</span>}\n                </div>\n              </th>\n            ))}\n          </tr>\n        </thead>\n        <tbody>\n          {error ? (\n            <tr>\n              <td colSpan={Object.keys(visibleCols).filter(k => visibleCols[k]).length + 1} className=\"px-3 py-12 text-center text-red-500 text-xs\">\n                {error}\n              </td>\n            </tr>\n          ) : positions.length === 0 ? (\n            <tr>\n              <td colSpan={Object.keys(visibleCols).filter(k => visibleCols[k]).length + 1} className=\"px-3 py-12 text-center text-gray-500 text-xs\">\n                No Positions To Show\n              </td>\n            </tr>\n          ) : (\n            positions.map((position, index) => (\n              <tr key={index} className=\"border-b border-gray-100 hover:bg-gray-50\">\n                <td className=\"px-3 py-2\">\n                  <input type=\"checkbox\" className=\"w-3 h-3 rounded border-gray-300 cursor-pointer\" />\n                </td>\n                {allColumns.filter(c => visibleCols[c.id]).map(col => {\n                  switch (col.id) {\n                    case 'symbol':\n                      return <td key={col.id} className=\"px-4 py-3 font-medium\">{position.symbolname}</td>\n                    case 's':\n                      return <td key={col.id} className=\"px-4 py-3\">{position.netqty > 0 ? 'B' : 'S'}</td>\n                    case 'net':\n                      return <td key={col.id} className=\"px-4 py-3\">{Math.abs(position.netqty)}</td>\n                    case 'avgprice':\n                      return <td key={col.id} className=\"px-4 py-3\">{typeof position.avgnetprice === 'number' ? position.avgnetprice.toFixed(2) : '-'}</td>\n                    case 'ltp':\n                      return <td key={col.id} className=\"px-4 py-3\">{typeof position.ltp === 'number' ? position.ltp.toFixed(2) : '-'}</td>\n                    case 'sl':\n                    case 'setsl':\n                    case 'target':\n                    case 'settarget':\n                      return <td key={col.id} className=\"px-4 py-3\">-</td>\n                    case 'rpal':\n                      return <td key={col.id} className=\"px-3 py-2\">-</td>\n                    case 'urpal':\n                      return <td key={col.id} className=\"px-4 py-3\">{typeof position.unrealised === 'number' ? position.unrealised.toFixed(2) : '-'}</td>\n                    case 'pal':\n                      return <td key={col.id} className={`px-4 py-3 ${position.pnl >= 0 ? 'text-green-600' : 'text-red-600'}`}>{typeof position.pnl === 'number' ? position.pnl.toFixed(2) : '-'}</td>\n                    case 'action':\n                      return <td key={col.id} className=\"px-4 py-3\">-</td>\n                    case 'buy':\n                    case 'buypri':\n                    case 'sellpri':\n                    case 'sellqty':\n                    case 'product':\n                      return <td key={col.id} className=\"px-3 py-2\">-</td>\n                    default:\n                      return <td key={col.id} className=\"px-3 py-2\">-</td>\n                  }\n                })}\n                {/* row cells are produced dynamically from visible columns */}\n              </tr>\n            ))\n          )}\n        </tbody>\n        </table>\n      </div>\n      <ColumnSettings\n        open={showColumnSettingsState}\n        onOpenChange={setShowColumnSettings}\n        columns={allColumns.map(c => ({ id: c.id, label: c.label }))}\n        selected={visibleCols}\n        onSave={(sel) => { \n          setVisibleCols(sel); \n          localStorage.setItem('positions-columns', JSON.stringify(sel));\n          localStorage.setItem('backend-column-settings-positions', JSON.stringify(sel));\n          // Save to backend\n          fetch('http://localhost:5000/api/column-settings/positions', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(sel)\n          }).catch(error => console.error('Error saving column settings to backend:', error));\n        }}\n        onReset={() => { \n          localStorage.removeItem('positions-columns'); \n          localStorage.removeItem('backend-column-settings-positions');\n          setVisibleCols(DEFAULT_COLS);\n          // Reset on backend\n          fetch('http://localhost:5000/api/column-settings/positions', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(DEFAULT_COLS)\n          }).catch(error => console.error('Error resetting column settings on backend:', error));\n        }}\n      />\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4831, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/table.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Table({ className, ...props }: React.ComponentProps<'table'>) {\n  return (\n    <div\n      data-slot=\"table-container\"\n      className=\"relative w-full overflow-x-auto\"\n    >\n      <table\n        data-slot=\"table\"\n        className={cn('w-full caption-bottom text-sm', className)}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction TableHeader({ className, ...props }: React.ComponentProps<'thead'>) {\n  return (\n    <thead\n      data-slot=\"table-header\"\n      className={cn('[&_tr]:border-b', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableBody({ className, ...props }: React.ComponentProps<'tbody'>) {\n  return (\n    <tbody\n      data-slot=\"table-body\"\n      className={cn('[&_tr:last-child]:border-0', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableFooter({ className, ...props }: React.ComponentProps<'tfoot'>) {\n  return (\n    <tfoot\n      data-slot=\"table-footer\"\n      className={cn(\n        'bg-muted/50 border-t font-medium [&>tr]:last:border-b-0',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableRow({ className, ...props }: React.ComponentProps<'tr'>) {\n  return (\n    <tr\n      data-slot=\"table-row\"\n      className={cn(\n        'hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableHead({ className, ...props }: React.ComponentProps<'th'>) {\n  return (\n    <th\n      data-slot=\"table-head\"\n      className={cn(\n        'text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCell({ className, ...props }: React.ComponentProps<'td'>) {\n  return (\n    <td\n      data-slot=\"table-cell\"\n      className={cn(\n        'p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCaption({\n  className,\n  ...props\n}: React.ComponentProps<'caption'>) {\n  return (\n    <caption\n      data-slot=\"table-caption\"\n      className={cn('text-muted-foreground mt-4 text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,EAAE,SAAS,EAAE,GAAG,OAAsC;IACnE,qBACE,6LAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,6LAAC;YACC,aAAU;YACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;KAbS;AAeT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAsC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAmC;IACnE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,+EACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,sJACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OAC6B;IAChC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 4975, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/options-chain-modal.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { X, ChevronDown, RefreshCw, Eye, EyeOff, AlertCircle } from 'lucide-react'\n\ninterface OptionData {\n  oiInt: string\n  oiPercent: string\n  oi: string\n  iv: string\n  ltpPercent: string\n  ltpChg: string\n  ltp: string\n  action: 'B' | 'S'\n  strike: string\n  delta?: string\n  gamma?: string\n  theta?: string\n  vega?: string\n  intrinsic?: string\n  extrinsic?: string\n}\n\ninterface OptionChainData {\n  calls: OptionData[]\n  puts: OptionData[]\n  spot: number\n  timestamp: string\n}\n\nimport { useMarket } from '@/components/market/market-context'\nimport { PlaceLimitOrderDialog } from './place-limit-order-dialog'\nimport { Table, TableHeader, TableBody, TableRow, TableHead, TableCell } from '@/components/ui/table'\n\nfunction formatExpiryForSymbol(expiry: string) {\n  // Accept '25-Nov-2025' and return '25-NOV-25'\n  const parts = expiry.split('-')\n  if (parts.length !== 3) return expiry\n  const day = parts[0]\n  const month = parts[1].toUpperCase()\n  const year = parts[2].slice(-2)\n  return `${day}-${month}-${year}`\n}\n\nexport function OptionsChainModal({ isOpen, onClose, symbol, expiryDate }: { isOpen: boolean; onClose: () => void; symbol?: string; expiryDate?: string }) {\n  const [selectedExpiry, setSelectedExpiry] = useState(expiryDate || '')\n  const [availableExpiries, setAvailableExpiries] = useState<string[]>([])\n  const [scrollPosition, setScrollPosition] = useState(0)\n  const [viewMode, setViewMode] = useState<'oi' | 'greeks' | 'premium'>('oi')\n  const [optionChainData, setOptionChainData] = useState<OptionChainData | null>(null)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [tokenInput, setTokenInput] = useState('')\n  const [showLimitDialog, setShowLimitDialog] = useState(false)\n  const [selectedOrder, setSelectedOrder] = useState<{\n    type: 'sell-call' | 'buy-call' | 'buy-put' | 'sell-put'\n    symbol: string\n    expiry?: string\n    strike?: number\n    cepe?: 'CE' | 'PE'\n  } | null>(null)\n\n  const market = useMarket()\n  const currentSymbol = symbol || 'BANKNIFTY'\n  const currentSpot = market?.symbols?.[currentSymbol]?.ltp || 47000\n\n  // Fetch option chain data from live API\n  const fetchOptionChain = async () => {\n    setLoading(true)\n    setError(null)\n    try {\n      const BACKEND_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:5000'\n      \n      // First, subscribe to underlying symbol for spot price\n      if (currentSymbol && market.subscribeTokens) {\n        try {\n          const symbolResp = await fetch(`${BACKEND_BASE}/api/symbols/${encodeURIComponent(currentSymbol)}`)\n          const symbolData = await symbolResp.json()\n          if (symbolData.status && symbolData.data?.token) {\n            market.subscribeTokens([{\n              token: symbolData.data.token,\n              exchange: symbolData.data.exchange || 'NSE',\n              symbol: currentSymbol,\n            }])\n            console.log('[OptionsChain] Subscribed to underlying token:', symbolData.data.token)\n          }\n        } catch (e) {\n          console.error('[OptionsChain] Error subscribing to underlying:', e)\n        }\n      }\n      \n      // Fetch real option chain from backend\n      const expiryParam = selectedExpiry ? `?expiry=${encodeURIComponent(selectedExpiry)}` : ''\n      const response = await fetch(`${BACKEND_BASE}/api/option-chain/${encodeURIComponent(currentSymbol)}${expiryParam}`)\n      const result = await response.json()\n      \n      if (result.success && result.data && Array.isArray(result.data)) {\n        // Transform backend data to component format\n        const calls: OptionData[] = []\n        const puts: OptionData[] = []\n        const optionTokens: Array<{ token: string; exchange?: string; symbol?: string }> = []\n        const expiryKey = formatExpiryForSymbol(selectedExpiry || '25-Nov-2025')\n        \n        result.data.forEach((item: any) => {\n          const strike = item.strike_price?.toString() || '0'\n          \n          if (item.CE) {\n            const quote = item.CE.marketData || {}\n            const tokenSymbolKey = `${currentSymbol}-${expiryKey}-${strike}-CE`\n            const oi = Number(quote.oi ?? item.CE.oi ?? 0)\n            const netChange = Number(quote.netChange ?? 0)\n            \n            // OI Interpretation: ↑ if OI is high relative to volume (accumulation), ↓ if unwinding\n            let oiInt = '—'\n            if (oi > 0) {\n              oiInt = netChange >= 0 ? '↑' : '↓'\n            }\n            \n            // Extract IV and Greeks from API response\n            const iv = item.CE.iv ?? quote.iv ?? 0\n            const delta = item.CE.delta ?? quote.delta ?? 0\n            const gamma = item.CE.gamma ?? quote.gamma ?? 0\n            const theta = item.CE.theta ?? quote.theta ?? 0\n            const vega = item.CE.vega ?? quote.vega ?? 0\n            \n            calls.push({\n              strike,\n              ltp: Number(quote.ltp ?? item.CE.ltp ?? 0).toFixed(2),\n              ltpChg: Number(quote.netChange ?? 0).toFixed(2),\n              ltpPercent: `${Number(quote.percentChange ?? 0).toFixed(2)}%`,\n              oi: oi.toLocaleString(),\n              oiPercent: quote.percentChange ? `${Number(quote.percentChange).toFixed(2)}%` : '0.00%',\n              oiInt,\n              iv: iv > 0 ? `${iv.toFixed(2)}%` : '—',\n              action: 'B' as const,\n              delta: delta !== 0 ? delta.toFixed(4) : '—',\n              gamma: gamma !== 0 ? gamma.toFixed(6) : '—',\n              theta: theta !== 0 ? theta.toFixed(2) : '—',\n              vega: vega !== 0 ? vega.toFixed(2) : '—'\n            })\n            if (item.CE.token) {\n              optionTokens.push({\n                token: item.CE.token,\n                exchange: item.CE.exchange || 'NFO',\n                symbol: tokenSymbolKey,\n              })\n            }\n          }\n          \n          if (item.PE) {\n            const quote = item.PE.marketData || {}\n            const tokenSymbolKey = `${currentSymbol}-${expiryKey}-${strike}-PE`\n            const oi = Number(quote.oi ?? item.PE.oi ?? 0)\n            const netChange = Number(quote.netChange ?? 0)\n            \n            // OI Interpretation\n            let oiInt = '—'\n            if (oi > 0) {\n              oiInt = netChange >= 0 ? '↑' : '↓'\n            }\n            \n            // Extract IV and Greeks from API response\n            const iv = item.PE.iv ?? quote.iv ?? 0\n            const delta = item.PE.delta ?? quote.delta ?? 0\n            const gamma = item.PE.gamma ?? quote.gamma ?? 0\n            const theta = item.PE.theta ?? quote.theta ?? 0\n            const vega = item.PE.vega ?? quote.vega ?? 0\n            \n            puts.push({\n              strike,\n              ltp: Number(quote.ltp ?? item.PE.ltp ?? 0).toFixed(2),\n              ltpChg: Number(quote.netChange ?? 0).toFixed(2),\n              ltpPercent: `${Number(quote.percentChange ?? 0).toFixed(2)}%`,\n              oi: oi.toLocaleString(),\n              oiPercent: quote.percentChange ? `${Number(quote.percentChange).toFixed(2)}%` : '0.00%',\n              oiInt,\n              iv: iv > 0 ? `${iv.toFixed(2)}%` : '—',\n              action: 'B' as const,\n              delta: delta !== 0 ? delta.toFixed(4) : '—',\n              gamma: gamma !== 0 ? gamma.toFixed(6) : '—',\n              theta: theta !== 0 ? theta.toFixed(2) : '—',\n              vega: vega !== 0 ? vega.toFixed(2) : '—'\n            })\n            if (item.PE.token) {\n              optionTokens.push({\n                token: item.PE.token,\n                exchange: item.PE.exchange || 'NFO',\n                symbol: tokenSymbolKey,\n              })\n            }\n          }\n        })\n        \n        setOptionChainData({\n          calls,\n          puts,\n          spot: currentSpot,\n          timestamp: new Date().toISOString()\n        })\n        \n        // Subscribe to all option tokens for real-time LTP updates\n        if (optionTokens.length > 0 && market.subscribeTokens) {\n          market.subscribeTokens(optionTokens)\n          console.log('[OptionsChain] Subscribed to', optionTokens.length, 'option tokens')\n        }\n      } else {\n        // Show error if no data received\n        setError('No option chain data available. Please check if market is open.')\n        setOptionChainData(null)\n      }\n    } catch (error) {\n      console.error('Error fetching option chain:', error)\n      setError('Failed to fetch option chain data. Please try again.')\n      setOptionChainData(null)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    if (isOpen) {\n      fetchOptionChain()\n    }\n  }, [isOpen, currentSymbol, selectedExpiry])\n\n  // Fetch available expiries when modal opens\n  useEffect(() => {\n    const fetchExpiries = async () => {\n      try {\n        const BACKEND_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:5000'\n        const response = await fetch(`${BACKEND_BASE}/api/symbols/${encodeURIComponent(currentSymbol)}/expiries`)\n        const result = await response.json()\n        if (result.status && Array.isArray(result.data) && result.data.length > 0) {\n          setAvailableExpiries(result.data)\n          // Set first expiry as default if none selected\n          if (!selectedExpiry || !result.data.includes(selectedExpiry)) {\n            setSelectedExpiry(result.data[0])\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching expiries:', error)\n      }\n    }\n    if (isOpen && currentSymbol) {\n      fetchExpiries()\n    }\n  }, [isOpen, currentSymbol])\n\n  // Helper to resolve option LTP from market.symbols\n  const resolveOptionLtp = (strike: string, side: 'CE' | 'PE') => {\n    const formattedExpiry = formatExpiryForSymbol(selectedExpiry || '25-Nov-2025')\n    const targetKey = `${currentSymbol}-${formattedExpiry}-${strike}-${side}`\n    return market.symbols[targetKey]?.ltp\n  }\n\n  if (!isOpen) return null\n\n  const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n    setScrollPosition(e.currentTarget.scrollLeft)\n  }\n\n  const openLimitDialog = (orderType: 'sell-call' | 'buy-call' | 'buy-put' | 'sell-put', strike: string | number, side: 'CE' | 'PE') => {\n    const formattedExpiry = formatExpiryForSymbol(selectedExpiry)\n    const targetKey = `${currentSymbol}-${formattedExpiry}-${String(strike)}-${side}`\n    setSelectedOrder({ type: orderType, symbol: targetKey, expiry: selectedExpiry, strike: Number(strike), cepe: side })\n    setShowLimitDialog(true)\n  }\n\n  // We'll render a single table where each row contains CALL cells, STRIKE cell and PUT cells.\n  // This ensures perfect vertical alignment between CALL / STRIKE / PUT across all rows.\n\n  const renderCallCells = (data: OptionData, resolvedLtp: string, viewMode: typeof viewMode) => {\n    if (viewMode === 'greeks') {\n      return (\n        <>\n          <TableCell className=\"text-center\">{data.delta}</TableCell>\n          <TableCell className=\"text-center\">{data.gamma}</TableCell>\n          <TableCell className=\"text-center text-red-600\">{data.theta}</TableCell>\n          <TableCell className=\"text-center\">{data.vega}</TableCell>\n          <TableCell className=\"text-center\">{data.iv}</TableCell>\n          <TableCell className=\"text-center\" style={{ color: data.ltpPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.ltpPercent}</TableCell>\n          <TableCell className=\"text-center\">{data.ltpChg}</TableCell>\n          <TableCell className=\"text-center font-semibold\">{resolvedLtp}</TableCell>\n          <TableCell className=\"text-center\">\n            <div className=\"inline-flex gap-2\">\n              <button\n                onClick={() => openLimitDialog('buy-call', data.strike, 'CE')}\n                className=\"bg-blue-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                B\n              </button>\n              <button\n                onClick={() => openLimitDialog('sell-call', data.strike, 'CE')}\n                className=\"bg-red-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                S\n              </button>\n            </div>\n          </TableCell>\n        </>\n      )\n    }\n\n    if (viewMode === 'premium') {\n      const straddlePremium = (parseFloat(data.ltp) + parseFloat(optionChainData?.puts.find(p => p.strike === data.strike)?.ltp || '0')).toFixed(2)\n      const totalPremium = (parseFloat(data.ltp) + parseFloat(data.extrinsic || '0')).toFixed(2)\n      return (\n        <>\n          <TableCell className=\"text-center font-semibold\">{straddlePremium}</TableCell>\n          <TableCell className=\"text-center\">{totalPremium}</TableCell>\n          <TableCell className=\"text-center\">{data.iv}</TableCell>\n          <TableCell className=\"text-center\" style={{ color: data.ltpPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.ltpPercent}</TableCell>\n          <TableCell className=\"text-center\">{data.ltpChg}</TableCell>\n          <TableCell className=\"text-center font-semibold\">{resolvedLtp}</TableCell>\n          <TableCell className=\"text-center\">\n            <div className=\"inline-flex gap-2\">\n              <button\n                onClick={() => openLimitDialog('buy-call', data.strike, 'CE')}\n                className=\"bg-blue-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                B\n              </button>\n              <button\n                onClick={() => openLimitDialog('sell-call', data.strike, 'CE')}\n                className=\"bg-red-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                S\n              </button>\n            </div>\n          </TableCell>\n        </>\n      )\n    }\n\n    // OI view\n    return (\n      <>\n        <TableCell className={`text-center font-semibold ${data.oiInt === '↑' ? 'text-green-600' : data.oiInt === '↓' ? 'text-red-600' : 'text-blue-600'}`}>{data.oiInt}</TableCell>\n        <TableCell className=\"text-center\" style={{ color: data.oiPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.oiPercent}</TableCell>\n        <TableCell className=\"text-center\">{data.oi}</TableCell>\n        <TableCell className=\"text-center\">{data.iv}</TableCell>\n        <TableCell className=\"text-center\" style={{ color: data.ltpPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.ltpPercent}</TableCell>\n        <TableCell className=\"text-center\">{data.ltpChg}</TableCell>\n        <TableCell className=\"text-center font-semibold\">{resolvedLtp}</TableCell>\n        <TableCell className=\"text-center\">\n          <div className=\"inline-flex gap-2\">\n            <button\n              onClick={() => openLimitDialog('buy-call', data.strike, 'CE')}\n              className=\"bg-blue-500 text-white px-2 py-0.5 rounded text-xs\"\n            >\n              B\n            </button>\n            <button\n              onClick={() => openLimitDialog('sell-call', data.strike, 'CE')}\n              className=\"bg-red-500 text-white px-2 py-0.5 rounded text-xs\"\n            >\n              S\n            </button>\n          </div>\n        </TableCell>\n      </>\n    )\n  }\n\n  const renderPutCells = (data: OptionData, resolvedLtp: string, viewMode: typeof viewMode) => {\n    if (viewMode === 'greeks') {\n      return (\n        <>\n          <TableCell className=\"text-center\">\n            <div className=\"inline-flex gap-2\">\n              <button\n                onClick={() => openLimitDialog('buy-put', data.strike, 'PE')}\n                className=\"bg-blue-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                B\n              </button>\n              <button\n                onClick={() => openLimitDialog('sell-put', data.strike, 'PE')}\n                className=\"bg-red-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                S\n              </button>\n            </div>\n          </TableCell>\n          <TableCell className=\"text-center font-semibold\">{resolvedLtp}</TableCell>\n          <TableCell className=\"text-center\">{data.ltpChg}</TableCell>\n          <TableCell className=\"text-center\" style={{ color: data.ltpPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.ltpPercent}</TableCell>\n          <TableCell className=\"text-center\">{data.iv}</TableCell>\n          <TableCell className=\"text-center\">{data.delta}</TableCell>\n          <TableCell className=\"text-center\">{data.gamma}</TableCell>\n          <TableCell className=\"text-center text-red-600\">{data.theta}</TableCell>\n          <TableCell className=\"text-center\">{data.vega}</TableCell>\n        </>\n      )\n    }\n\n    if (viewMode === 'premium') {\n      const totalPremium = (parseFloat(data.ltp) + parseFloat(data.extrinsic || '0')).toFixed(2)\n      const intrinsicValue = data.intrinsic || '0'\n      const straddlePremium = (parseFloat(optionChainData?.calls.find(c => c.strike === data.strike)?.ltp || '0') + parseFloat(data.ltp)).toFixed(2)\n      return (\n        <>\n          <TableCell className=\"text-center\">\n            <div className=\"inline-flex gap-2\">\n              <button\n                onClick={() => openLimitDialog('buy-put', data.strike, 'PE')}\n                className=\"bg-blue-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                B\n              </button>\n              <button\n                onClick={() => openLimitDialog('sell-put', data.strike, 'PE')}\n                className=\"bg-red-500 text-white px-2 py-0.5 rounded text-xs\"\n              >\n                S\n              </button>\n            </div>\n          </TableCell>\n          <TableCell className=\"text-center font-semibold\">{resolvedLtp}</TableCell>\n          <TableCell className=\"text-center\">{data.ltpChg}</TableCell>\n          <TableCell className=\"text-center\" style={{ color: data.ltpPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.ltpPercent}</TableCell>\n          <TableCell className=\"text-center\">{data.iv}</TableCell>\n          <TableCell className=\"text-center\">{totalPremium}</TableCell>\n          <TableCell className=\"text-center font-semibold\">{straddlePremium}</TableCell>\n        </>\n      )\n    }\n\n    // OI view\n    return (\n      <>\n        <TableCell className=\"text-center\">\n          <div className=\"inline-flex gap-2\">\n            <button\n              onClick={() => openLimitDialog('buy-put', data.strike, 'PE')}\n              className=\"bg-blue-500 text-white px-2 py-0.5 rounded text-xs\"\n            >\n              B\n            </button>\n            <button\n              onClick={() => openLimitDialog('sell-put', data.strike, 'PE')}\n              className=\"bg-red-500 text-white px-2 py-0.5 rounded text-xs\"\n            >\n              S\n            </button>\n          </div>\n        </TableCell>\n        <TableCell className=\"text-center font-semibold\">{resolvedLtp}</TableCell>\n        <TableCell className=\"text-center\">{data.ltpChg}</TableCell>\n        <TableCell className=\"text-center\" style={{ color: data.ltpPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.ltpPercent}</TableCell>\n        <TableCell className=\"text-center\">{data.iv}</TableCell>\n        <TableCell className=\"text-center\">{data.oi}</TableCell>\n        <TableCell className=\"text-center\" style={{ color: data.oiPercent.includes('-') ? '#dc2626' : '#16a34a' }}>{data.oiPercent}</TableCell>\n        <TableCell className={`text-center font-semibold ${data.oiInt === '↑' ? 'text-green-600' : data.oiInt === '↓' ? 'text-red-600' : 'text-blue-600'}`}>{data.oiInt}</TableCell>\n      </>\n    )\n  }\n  \n  \n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-start justify-center p-0 overflow-y-auto\">\n      <div className=\"bg-white w-full h-screen max-w-full flex flex-col\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-10\">\n          <div className=\"flex items-center gap-4\">\n            <button onClick={onClose} aria-label=\"Close options\" className=\"text-red-600 text-2xl hover:text-red-700\">✕</button>\n\n            <div className=\"flex items-center gap-2\">\n              <label className=\"text-sm font-medium text-gray-700\">Expiry Date</label>\n              <select\n                value={selectedExpiry}\n                onChange={(e) => setSelectedExpiry(e.target.value)}\n                className=\"px-3 py-1 text-xs border border-gray-300 rounded\"\n              >\n                {availableExpiries.length > 0 ? (\n                  availableExpiries.map((expiry) => (\n                    <option key={expiry} value={expiry}>{expiry}</option>\n                  ))\n                ) : (\n                  <option value=\"\">Loading expiries...</option>\n                )}\n              </select>\n            </div>\n\n            {/* View Mode Tabs */}\n            <div className=\"flex bg-gray-100 rounded p-1\">\n              <button\n                onClick={() => setViewMode('oi')}\n                className={`px-3 py-1 text-xs font-medium rounded ${viewMode === 'oi' ? 'bg-white shadow' : 'text-gray-600'}`}\n              >\n                OI\n              </button>\n              <button\n                onClick={() => setViewMode('greeks')}\n                className={`px-3 py-1 text-xs font-medium rounded ${viewMode === 'greeks' ? 'bg-white shadow' : 'text-gray-600'}`}\n              >\n                Greeks\n              </button>\n              <button\n                onClick={() => setViewMode('premium')}\n                className={`px-3 py-1 text-xs font-medium rounded ${viewMode === 'premium' ? 'bg-white shadow' : 'text-gray-600'}`}\n              >\n                Premium\n              </button>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <label className=\"text-sm font-medium text-gray-700\">Subscribe Tokens</label>\n              <input\n                value={tokenInput}\n                onChange={(e) => setTokenInput(e.target.value)}\n                placeholder=\"comma separated token ids\"\n                className=\"px-2 py-1 text-xs border border-gray-300 rounded\"\n              />\n              <button\n                onClick={() => {\n                  if (!tokenInput) return\n                  const tokens = tokenInput.split(',').map(s => s.trim()).filter(Boolean)\n                  if (tokens.length === 0) return\n                  market.subscribeTokens?.(tokens)\n                  setTokenInput('')\n                }}\n                className=\"px-2 py-1 bg-green-600 text-white text-xs font-semibold rounded hover:bg-green-700\"\n              >\n                Subscribe\n              </button>\n            </div>\n\n            <button\n              onClick={fetchOptionChain}\n              disabled={loading}\n              className=\"px-3 py-1 bg-blue-600 text-white text-xs font-semibold rounded hover:bg-blue-700 disabled:opacity-50 flex items-center gap-1\"\n            >\n              <RefreshCw className={`w-3 h-3 ${loading ? 'animate-spin' : ''}`} />\n              REFRESH\n            </button>\n\n            <button className=\"px-2 py-1 border border-red-600 text-red-600 text-xs font-semibold rounded hover:bg-red-50\">\n              SHOW OI\n            </button>\n          </div>\n\n          <div className=\"text-xs text-gray-600\">\n            <span className=\"text-right block\">\n              Underlying: <span className=\"font-semibold\">{currentSymbol} at {currentSpot.toFixed(2)},</span> Chg: <span className=\"text-green-600\">—</span>\n            </span>\n            <span className=\"text-right block\">Add to basket</span>\n          </div>\n        </div>\n\n        {/* Table Content: single aligned table */}\n        <div className=\"flex-1 overflow-y-auto p-4\">\n          {/* Error message */}\n          {error && (\n            <div className=\"flex items-center justify-center gap-2 p-4 mb-4 bg-red-50 border border-red-200 rounded-lg text-red-700\">\n              <AlertCircle className=\"w-5 h-5\" />\n              <span>{error}</span>\n            </div>\n          )}\n\n          {/* Loading state */}\n          {loading && (\n            <div className=\"flex items-center justify-center p-8\">\n              <RefreshCw className=\"w-6 h-6 animate-spin text-blue-600\" />\n              <span className=\"ml-2 text-gray-600\">Loading option chain data...</span>\n            </div>\n          )}\n\n          {/* No data state */}\n          {!loading && !error && !optionChainData && (\n            <div className=\"flex items-center justify-center p-8 text-gray-500\">\n              No option chain data available. Select an expiry date to load options.\n            </div>\n          )}\n\n          {/* Market data note */}\n          {!loading && optionChainData && (\n            <div className=\"text-xs text-gray-500 mb-2 text-center\">\n              💡 LTP, OI data from Smart API. IV and OI Change require additional data sources not available in basic quotes.\n            </div>\n          )}\n\n          {/* Option chain table */}\n          {!loading && optionChainData && (\n          <div className=\"w-full\">\n            <div className=\"bg-white border border-gray-200 shadow-sm rounded\">\n              <div className=\"px-3 py-2 bg-gray-100 font-semibold text-xs flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">CALL</div>\n                <div className=\"text-center w-28\">Strike</div>\n                <div className=\"flex items-center gap-2\">PUT</div>\n              </div>\n\n              <div className=\"overflow-x-auto\">\n                <Table className=\"min-w-[1200px] table-fixed\">\n                  <TableHeader>\n                    <tr>\n                      {/* CALL headers */}\n                      {viewMode === 'oi' && (\n                        <>\n                          <TableHead className=\"text-center\">OI Int.</TableHead>\n                          <TableHead className=\"text-center\">OI %</TableHead>\n                          <TableHead className=\"text-center\">OI</TableHead>\n                          <TableHead className=\"text-center\">IV</TableHead>\n                          <TableHead className=\"text-center\">LTP %</TableHead>\n                          <TableHead className=\"text-center\">LTP Chg</TableHead>\n                          <TableHead className=\"text-center\">LTP</TableHead>\n                          <TableHead className=\"text-center\">Action</TableHead>\n                        </>\n                      )}\n                      {viewMode === 'greeks' && (\n                        <>\n                          <TableHead className=\"text-center\">Delta</TableHead>\n                          <TableHead className=\"text-center\">Gamma</TableHead>\n                          <TableHead className=\"text-center\">Theta</TableHead>\n                          <TableHead className=\"text-center\">Vega</TableHead>\n                          <TableHead className=\"text-center\">IV</TableHead>\n                          <TableHead className=\"text-center\">LTP %</TableHead>\n                          <TableHead className=\"text-center\">LTP Chg</TableHead>\n                          <TableHead className=\"text-center\">LTP</TableHead>\n                          <TableHead className=\"text-center\">Action</TableHead>\n                        </>\n                      )}\n                      {viewMode === 'premium' && (\n                        <>\n                          <TableHead className=\"text-center\">Straddle</TableHead>\n                          <TableHead className=\"text-center\">Premium</TableHead>\n                          <TableHead className=\"text-center\">IV</TableHead>\n                          <TableHead className=\"text-center\">LTP %</TableHead>\n                          <TableHead className=\"text-center\">LTP Chg</TableHead>\n                          <TableHead className=\"text-center\">LTP</TableHead>\n                          <TableHead className=\"text-center\">Action</TableHead>\n                        </>\n                      )}\n\n                      {/* Strike header */}\n                      <TableHead className=\"text-center\">Strike</TableHead>\n\n                      {/* PUT headers (mirror) */}\n                      {viewMode === 'oi' && (\n                        <>\n                          <TableHead className=\"text-center\">Action</TableHead>\n                          <TableHead className=\"text-center\">LTP</TableHead>\n                          <TableHead className=\"text-center\">LTP Chg</TableHead>\n                          <TableHead className=\"text-center\">LTP %</TableHead>\n                          <TableHead className=\"text-center\">IV</TableHead>\n                          <TableHead className=\"text-center\">OI</TableHead>\n                          <TableHead className=\"text-center\">OI %</TableHead>\n                          <TableHead className=\"text-center\">OI Int.</TableHead>\n                        </>\n                      )}\n                      {viewMode === 'greeks' && (\n                        <>\n                          <TableHead className=\"text-center\">Action</TableHead>\n                          <TableHead className=\"text-center\">LTP</TableHead>\n                          <TableHead className=\"text-center\">LTP Chg</TableHead>\n                          <TableHead className=\"text-center\">LTP %</TableHead>\n                          <TableHead className=\"text-center\">IV</TableHead>\n                          <TableHead className=\"text-center\">Delta</TableHead>\n                          <TableHead className=\"text-center\">Gamma</TableHead>\n                          <TableHead className=\"text-center\">Theta</TableHead>\n                          <TableHead className=\"text-center\">Vega</TableHead>\n                        </>\n                      )}\n                      {viewMode === 'premium' && (\n                        <>\n                          <TableHead className=\"text-center\">Action</TableHead>\n                          <TableHead className=\"text-center\">LTP</TableHead>\n                          <TableHead className=\"text-center\">LTP Chg</TableHead>\n                          <TableHead className=\"text-center\">LTP %</TableHead>\n                          <TableHead className=\"text-center\">IV</TableHead>\n                          <TableHead className=\"text-center\">Premium</TableHead>\n                          <TableHead className=\"text-center\">Straddle</TableHead>\n                        </>\n                      )}\n                    </tr>\n                  </TableHeader>\n                </Table>\n              </div>\n\n              <div className=\"max-h-[68vh] overflow-auto\">\n                <Table className=\"min-w-[1200px] table-fixed\">\n                  <TableBody>\n                    {optionChainData?.calls.map((call, i) => {\n                      const put = optionChainData?.puts[i]\n                      const callLtp = resolveOptionLtp(call.strike, 'CE') ?? call.ltp\n                      const putLtp = resolveOptionLtp(put?.strike || call.strike, 'PE') ?? put?.ltp ?? ''\n                      const isNearest = Math.abs(Number(call.strike) - currentSpot) < (currentSymbol.includes('BANKNIFTY') ? 200 : 10)\n                      return (\n                        <TableRow key={i} className={`${isNearest ? 'bg-yellow-50 font-semibold' : ''}`}>\n                          {/* CALL cells */}\n                          {renderCallCells(call, callLtp, viewMode)}\n\n                          {/* Strike */}\n                          <TableCell className=\"text-center bg-amber-50\">{call.strike}</TableCell>\n\n                          {/* PUT cells */}\n                          {put && renderPutCells(put, putLtp, viewMode)}\n                        </TableRow>\n                      )\n                    })}\n                  </TableBody>\n                </Table>\n              </div>\n            </div>\n          </div>\n          )}\n        </div>\n      </div>\n      {selectedOrder && (\n        <PlaceLimitOrderDialog\n          isOpen={showLimitDialog}\n          onClose={() => {\n            setShowLimitDialog(false)\n            setSelectedOrder(null)\n          }}\n          orderType={selectedOrder.type}\n          symbol={selectedOrder.symbol}\n          expiry={selectedOrder.expiry}\n          strike={selectedOrder.strike}\n          cepe={selectedOrder.cepe}\n        />\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6713, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/basket-order-table.tsx"],"sourcesContent":["\"use client\"\n\nimport React, { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table'\nimport { Badge } from '@/components/ui/badge'\nimport { Progress } from '@/components/ui/progress'\nimport { Square, RefreshCw, CheckCircle, XCircle, AlertTriangle, Clock } from 'lucide-react'\nimport { toast } from 'sonner'\n\ninterface BasketPosition {\n  id: string\n  symbol: string\n  expiry: string\n  strike: number\n  cepe: 'CE' | 'PE'\n  qty: number\n  type: 'MKT' | 'LIMIT'\n  price: number\n  ltp?: number\n  brokerId?: number\n}\n\ninterface Broker {\n  id: number\n  name: string\n  broker_type: string\n  is_active: boolean\n}\n\ninterface BasketOrder {\n  id: number\n  basket_name: string\n  basket_type: string\n  total_quantity: number\n  total_value: number\n  status: 'pending' | 'executing' | 'partial' | 'completed' | 'failed' | 'cancelled'\n  distribution_algorithm: string\n  max_brokers: number\n  created_at: string\n  updated_at: string\n  completed_at?: string\n  items_count?: number\n  executed_items?: number\n  failed_items?: number\n}\n\ninterface BasketExecutionProgress {\n  overall: {\n    total_items: number\n    executed_items: number\n    failed_items: number\n    executing_items: number\n    pending_items: number\n    assigned_items: number\n  }\n  byBroker: Array<{\n    broker_name: string\n    total_items: number\n    executed_items: number\n    failed_items: number\n    executing_items: number\n  }>\n}\n\ninterface BasketOrderTableProps {\n  positions: BasketPosition[]\n  onUpdatePosition: (id: string, updates: Partial<BasketPosition>) => void\n  onRemovePosition: (id: string) => void\n  expiry?: string\n  orderType?: 'MKT' | 'LIMIT'\n  enableMultiBroker?: boolean\n  onDistributeBasket?: (algorithm: string, maxBrokers: number) => void\n  onCreateBasketOrder?: (basketData: any) => Promise<void>\n  onExecuteBasketOrder?: (basketId: number) => Promise<void>\n  onCancelBasketOrder?: (basketId: number) => Promise<void>\n}\n\nconst AVAILABLE_EXPIRIES = [\n  '25-Nov-2025',\n  '26-Nov-2025',\n  '27-Nov-2025',\n  '28-Nov-2025',\n  '29-Nov-2025',\n  '30-Nov-2025'\n]\n\nexport function BasketOrderTable({\n  positions,\n  onUpdatePosition,\n  onRemovePosition,\n  expiry = '25-Nov-2025',\n  orderType = 'MKT',\n  enableMultiBroker = false,\n  onDistributeBasket,\n  onCreateBasketOrder,\n  onExecuteBasketOrder,\n  onCancelBasketOrder\n}: BasketOrderTableProps) {\n  const [availableExpiries, setAvailableExpiries] = useState<string[]>(AVAILABLE_EXPIRIES)\n  const [availableStrikes, setAvailableStrikes] = useState<Record<string, number[]>>({})\n  const [loadingExpiries, setLoadingExpiries] = useState<Record<string, boolean>>({})\n  const [loadingStrikes, setLoadingStrikes] = useState<Record<string, boolean>>({})\n  const [brokers, setBrokers] = useState<Broker[]>([])\n  const [loadingBrokers, setLoadingBrokers] = useState(false)\n  const [distributionAlgorithm, setDistributionAlgorithm] = useState('round-robin')\n  const [maxBrokers, setMaxBrokers] = useState(2)\n\n  // Basket order management state\n  const [basketOrders, setBasketOrders] = useState<BasketOrder[]>([])\n  const [selectedBasket, setSelectedBasket] = useState<BasketOrder | null>(null)\n  const [executionProgress, setExecutionProgress] = useState<BasketExecutionProgress | null>(null)\n  const [showBasketDialog, setShowBasketDialog] = useState(false)\n  const [basketName, setBasketName] = useState('')\n  const [executingBaskets, setExecutingBaskets] = useState<Set<number>>(new Set())\n  const [progressIntervals, setProgressIntervals] = useState<Map<number, NodeJS.Timeout>>(new Map())\n\n  \n\n  const fetchBrokers = async () => {\n    if (!enableMultiBroker) return\n    setLoadingBrokers(true)\n    try {\n      const res = await fetch('http://localhost:5000/api/brokers')\n      const data = await res.json()\n      if (data?.status && data?.data) {\n        setBrokers(data.data.filter((b: Broker) => b.is_active))\n      }\n    } catch (err) {\n      console.error('Error fetching brokers', err)\n    } finally {\n      setLoadingBrokers(false)\n    }\n  }\n\n  useEffect(() => {\n    if (enableMultiBroker) {\n      fetchBrokers()\n    }\n  }, [enableMultiBroker])\n\n  const fetchExpiries = async (symbol: string) => {\n    if (!symbol) return\n    if (loadingExpiries[symbol]) return\n    setLoadingExpiries(prev => ({ ...prev, [symbol]: true }))\n    try {\n      const res = await fetch(`http://localhost:5000/api/symbols/${symbol}/expiries`)\n      const data = await res.json()\n      if (data?.status && data?.data) {\n        setAvailableExpiries(prev => {\n          const merged = Array.from(new Set([...prev, ...data.data]))\n          return merged.sort()\n        })\n      }\n    } catch (err) {\n      console.error('Error fetching expiries', err)\n    } finally {\n      setLoadingExpiries(prev => ({ ...prev, [symbol]: false }))\n    }\n  }\n\n  const fetchStrikes = async (symbol: string, expiryStr: string) => {\n    if (!symbol || !expiryStr) return\n    const key = `${symbol}-${expiryStr}`\n    if (loadingStrikes[key]) return\n    setLoadingStrikes(prev => ({ ...prev, [key]: true }))\n    try {\n      const res = await fetch(`http://localhost:5000/api/symbols/${symbol}/expiries/${encodeURIComponent(expiryStr)}/strikes`)\n      const data = await res.json()\n      if (data?.status && data?.data) {\n        setAvailableStrikes(prev => ({ ...prev, [key]: data.data.sort((a: number, b: number) => a - b) }))\n      }\n    } catch (err) {\n      console.error('Error fetching strikes', err)\n    } finally {\n      setLoadingStrikes(prev => ({ ...prev, [key]: false }))\n    }\n  }\n\n  const getAvailableStrikes = (symbol: string, expiryStr: string) => {\n    const key = `${symbol}-${expiryStr}`\n    return availableStrikes[key] || []\n  }\n\n  const handleExpiryChange = (id: string, symbol: string, newExpiry: string) => {\n    onUpdatePosition(id, { expiry: newExpiry })\n    fetchStrikes(symbol, newExpiry)\n  }\n\n  const handleSymbolChange = (id: string, newSymbol: string) => {\n    onUpdatePosition(id, { symbol: newSymbol })\n    fetchExpiries(newSymbol)\n    const pos = positions.find(p => p.id === id)\n    if (pos) fetchStrikes(newSymbol, pos.expiry)\n  }\n\n  const handleStrikeChange = (id: string, delta: number) => {\n    const pos = positions.find(p => p.id === id)\n    if (!pos) return\n    const strikes = getAvailableStrikes(pos.symbol, pos.expiry)\n    if (strikes.length > 0) {\n      let idx = strikes.indexOf(pos.strike)\n      if (idx === -1) {\n        idx = strikes.reduce((closest, s, i) => Math.abs(s - pos.strike) < Math.abs(strikes[closest] - pos.strike) ? i : closest, 0)\n      }\n      const newIdx = Math.max(0, Math.min(strikes.length - 1, idx + delta))\n      onUpdatePosition(id, { strike: strikes[newIdx] })\n    } else {\n      const newStrike = Math.max(1000, pos.strike + delta * 100)\n      onUpdatePosition(id, { strike: newStrike })\n    }\n  }\n\n  const handleQtyChange = (id: string, delta: number) => {\n    const pos = positions.find(p => p.id === id)\n    if (!pos) return\n    const newQty = Math.max(1, pos.qty + delta)\n    onUpdatePosition(id, { qty: newQty })\n  }\n\n  useEffect(() => {\n    const uniqueSymbols = Array.from(new Set(positions.map(p => p.symbol))).filter(Boolean)\n    uniqueSymbols.forEach(sym => {\n      if (!availableExpiries.some(e => e.includes(sym))) fetchExpiries(sym)\n    })\n\n    positions.forEach(p => {\n      const key = `${p.symbol}-${p.expiry}`\n      if (p.symbol && p.expiry && !availableStrikes[key]) fetchStrikes(p.symbol, p.expiry)\n    })\n  }, [positions])\n\n  // Basket order management functions\n  const fetchBasketOrders = async () => {\n    try {\n      const res = await fetch('http://localhost:5000/api/basket-orders')\n      const data = await res.json()\n      if (data.status) {\n        setBasketOrders(data.data)\n      }\n    } catch (error) {\n      console.error('Error fetching basket orders:', error)\n    }\n  }\n\n  const createBasketOrder = async () => {\n    if (!basketName.trim() || positions.length === 0) {\n      toast.error('Please provide a basket name and add positions')\n      return\n    }\n\n    const basketData = {\n      name: basketName,\n      type: 'options',\n      distributionAlgorithm,\n      maxBrokers,\n      items: positions.map(pos => ({\n        symbol: pos.symbol,\n        expiry: pos.expiry,\n        strike: pos.strike,\n        optionType: pos.cepe,\n        quantity: pos.qty,\n        orderType: pos.type,\n        price: pos.type === 'LIMIT' ? pos.price : null,\n        triggerPrice: null,\n        transactionType: 'BUY', // Default to BUY, can be enhanced\n        productType: 'MIS',\n        brokerId: pos.brokerId\n      }))\n    }\n\n    try {\n      if (onCreateBasketOrder) {\n        await onCreateBasketOrder(basketData)\n      } else {\n        const res = await fetch('http://localhost:5000/api/basket-orders', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(basketData)\n        })\n        const data = await res.json()\n        if (data.status) {\n          toast.success('Basket order created successfully')\n          setShowBasketDialog(false)\n          setBasketName('')\n          fetchBasketOrders()\n        } else {\n          toast.error('Failed to create basket order')\n        }\n      }\n    } catch (error) {\n      console.error('Error creating basket order:', error)\n      toast.error('Failed to create basket order')\n    }\n  }\n\n  const executeBasketOrder = async (basketId: number) => {\n    try {\n      setExecutingBaskets(prev => new Set(prev).add(basketId))\n\n      if (onExecuteBasketOrder) {\n        await onExecuteBasketOrder(basketId)\n      } else {\n        const res = await fetch(`http://localhost:5000/api/basket-orders/${basketId}/execute`, {\n          method: 'POST'\n        })\n        const data = await res.json()\n        if (data.status) {\n          toast.success('Basket execution started')\n          fetchBasketOrders()\n          // Start progress monitoring\n          startProgressMonitoring(basketId)\n        } else {\n          toast.error('Failed to start basket execution')\n        }\n      }\n    } catch (error) {\n      console.error('Error executing basket order:', error)\n      toast.error('Failed to execute basket order')\n    } finally {\n      setExecutingBaskets(prev => {\n        const newSet = new Set(prev)\n        newSet.delete(basketId)\n        return newSet\n      })\n    }\n  }\n\n  const cancelBasketOrder = async (basketId: number) => {\n    try {\n      if (onCancelBasketOrder) {\n        await onCancelBasketOrder(basketId)\n      } else {\n        const res = await fetch(`http://localhost:5000/api/basket-orders/${basketId}/cancel`, {\n          method: 'PUT'\n        })\n        const data = await res.json()\n        if (data.status) {\n          toast.success('Basket order cancelled')\n          fetchBasketOrders()\n          stopProgressMonitoring(basketId)\n        } else {\n          toast.error('Failed to cancel basket order')\n        }\n      }\n    } catch (error) {\n      console.error('Error cancelling basket order:', error)\n      toast.error('Failed to cancel basket order')\n    }\n  }\n\n  const startProgressMonitoring = (basketId: number) => {\n    const interval = setInterval(async () => {\n      try {\n        const res = await fetch(`http://localhost:5000/api/basket-orders/${basketId}/progress`)\n        const data = await res.json()\n        if (data.status) {\n          setExecutionProgress(data.data)\n          // Stop monitoring if execution is complete\n          const progress = data.data.overall\n          if (progress.executing_items === 0 && progress.pending_items === 0 && progress.assigned_items === 0) {\n            stopProgressMonitoring(basketId)\n            fetchBasketOrders() // Refresh basket status\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching progress:', error)\n      }\n    }, 2000) // Update every 2 seconds\n\n    setProgressIntervals(prev => new Map(prev).set(basketId, interval))\n  }\n\n  const stopProgressMonitoring = (basketId: number) => {\n    const interval = progressIntervals.get(basketId)\n    if (interval) {\n      clearInterval(interval)\n      setProgressIntervals(prev => {\n        const newMap = new Map(prev)\n        newMap.delete(basketId)\n        return newMap\n      })\n    }\n  }\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed': return <CheckCircle className=\"h-4 w-4 text-green-500\" />\n      case 'failed': return <XCircle className=\"h-4 w-4 text-red-500\" />\n      case 'executing': return <RefreshCw className=\"h-4 w-4 text-blue-500 animate-spin\" />\n      case 'partial': return <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />\n      case 'cancelled': return <Square className=\"h-4 w-4 text-gray-500\" />\n      default: return <Clock className=\"h-4 w-4 text-gray-400\" />\n    }\n  }\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'completed': return 'bg-green-100 text-green-800'\n      case 'failed': return 'bg-red-100 text-red-800'\n      case 'executing': return 'bg-blue-100 text-blue-800'\n      case 'partial': return 'bg-yellow-100 text-yellow-800'\n      case 'cancelled': return 'bg-gray-100 text-gray-800'\n      default: return 'bg-gray-100 text-gray-600'\n    }\n  }\n\n  useEffect(() => {\n    if (enableMultiBroker) {\n      fetchBasketOrders()\n    }\n    // Cleanup intervals on unmount\n    return () => {\n      progressIntervals.forEach(interval => clearInterval(interval))\n    }\n  }, [enableMultiBroker])\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Original Basket Order Table */}\n\n      {/* Original Basket Order Table */}\n      <table className=\"w-full text-xs border-collapse\">\n      <thead>\n        <tr className=\"border-b border-gray-200 bg-gray-50\">\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700 w-6\">\n            <input type=\"checkbox\" className=\"rounded\" />\n          </th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Symbol</th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Expiry</th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Strike</th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">CE/PE</th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Qty</th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Type</th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Price</th>\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">LTP</th>\n          {enableMultiBroker && (\n            <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Broker</th>\n          )}\n          <th className=\"text-left px-2 py-2 font-semibold text-gray-700\">Action</th>\n        </tr>\n      </thead>\n      <tbody>\n        {(positions || []).map(pos => (\n          <tr key={pos.id} className=\"border-b border-gray-100 hover:bg-gray-50 transition-colors\">\n            <td className=\"px-2 py-2\">\n              <input type=\"checkbox\" className=\"rounded\" />\n            </td>\n            <td className=\"px-2 py-2 font-semibold text-red-600\">\n              <input\n                type=\"text\"\n                value={pos.symbol}\n                onChange={(e) => handleSymbolChange(pos.id, e.target.value.toUpperCase())}\n                className=\"w-16 px-1 py-0.5 border border-gray-300 rounded text-xs focus:outline-none focus:border-red-500\"\n                placeholder=\"SYMBOL\"\n              />\n            </td>\n            <td className=\"px-2 py-2\">\n              <select\n                value={pos.expiry}\n                onChange={(e) => handleExpiryChange(pos.id, pos.symbol, e.target.value)}\n                className=\"px-1 py-0.5 border border-gray-300 rounded text-xs hover:border-gray-400 focus:outline-none focus:border-red-500\"\n              >\n                {availableExpiries.map(exp => (\n                  <option key={exp} value={exp}>{exp}</option>\n                ))}\n              </select>\n            </td>\n            <td className=\"px-2 py-2\">\n              <div className=\"flex items-center gap-1\">\n                <button onClick={() => handleStrikeChange(pos.id, -1)} className=\"px-1 hover:bg-gray-200 rounded\">−</button>\n                <span className=\"px-2 py-0.5 border border-gray-300 rounded text-xs min-w-12 text-center\">{pos.strike}</span>\n                <button onClick={() => handleStrikeChange(pos.id, 1)} className=\"px-1 hover:bg-gray-200 rounded\">+</button>\n              </div>\n            </td>\n            <td className=\"px-2 py-2 font-semibold\">{pos.cepe}</td>\n            <td className=\"px-2 py-2\">\n              <div className=\"flex items-center gap-1\">\n                <button onClick={() => handleQtyChange(pos.id, -1)} className=\"px-1 hover:bg-gray-200 rounded\">−</button>\n                <span className=\"px-2 py-0.5 border border-gray-300 rounded text-xs min-w-10 text-center\">{pos.qty}</span>\n                <button onClick={() => handleQtyChange(pos.id, 1)} className=\"px-1 hover:bg-gray-200 rounded\">+</button>\n              </div>\n            </td>\n            <td className=\"px-2 py-2\">\n              <select\n                value={pos.type}\n                onChange={(e) => onUpdatePosition(pos.id, { type: e.target.value as 'MKT' | 'LIMIT' })}\n                className=\"px-1 py-0.5 border border-gray-300 rounded text-xs hover:border-gray-400 focus:outline-none focus:border-red-500\"\n              >\n                <option value=\"MKT\">MKT</option>\n                <option value=\"LIMIT\">LIMIT</option>\n              </select>\n            </td>\n            <td className=\"px-2 py-2\">\n              <input\n                type=\"number\"\n                value={pos.price}\n                onChange={(e) => onUpdatePosition(pos.id, { price: parseFloat(e.target.value) || 0 })}\n                className=\"w-16 px-1 py-0.5 border border-gray-300 rounded text-xs focus:outline-none focus:border-red-500\"\n              />\n            </td>\n            <td className=\"px-2 py-2 text-gray-600\">{typeof pos.ltp === 'number' ? pos.ltp.toFixed(2) : '-'}</td>\n            {enableMultiBroker && (\n              <td className=\"px-2 py-2\">\n                <select\n                  value={pos.brokerId || ''}\n                  onChange={(e) => onUpdatePosition(pos.id, { brokerId: parseInt(e.target.value) || undefined })}\n                  className=\"px-1 py-0.5 border border-gray-300 rounded text-xs hover:border-gray-400 focus:outline-none focus:border-red-500\"\n                >\n                  <option value=\"\">Auto</option>\n                  {brokers.map(broker => (\n                    <option key={broker.id} value={broker.id}>{broker.name}</option>\n                  ))}\n                </select>\n              </td>\n            )}\n            <td className=\"px-2 py-2\">\n              <button onClick={() => onRemovePosition(pos.id)} className=\"px-2 py-1 text-xs text-red-600 hover:bg-red-50 rounded\">Remove</button>\n            </td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n\n    {enableMultiBroker && onDistributeBasket && positions.length > 0 && (\n      <div className=\"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n        <h4 className=\"text-sm font-semibold text-blue-800 mb-3\">Multi-Broker Distribution</h4>\n        <div className=\"flex flex-wrap gap-4 items-center\">\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-xs font-medium text-blue-700\">Algorithm:</label>\n            <select\n              value={distributionAlgorithm}\n              onChange={(e) => setDistributionAlgorithm(e.target.value)}\n              className=\"px-2 py-1 border border-blue-300 rounded text-xs focus:outline-none focus:border-blue-500\"\n            >\n              <option value=\"round-robin\">Round Robin</option>\n              <option value=\"load-balance\">Load Balance</option>\n              <option value=\"priority\">Priority</option>\n              <option value=\"random\">Random</option>\n            </select>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-xs font-medium text-blue-700\">Max Brokers:</label>\n            <input\n              type=\"number\"\n              min=\"1\"\n              max={brokers.length}\n              value={maxBrokers}\n              onChange={(e) => setMaxBrokers(Math.max(1, parseInt(e.target.value) || 1))}\n              className=\"w-16 px-2 py-1 border border-blue-300 rounded text-xs focus:outline-none focus:border-blue-500\"\n            />\n          </div>\n          <button\n            onClick={() => onDistributeBasket?.(distributionAlgorithm, maxBrokers)}\n            className=\"px-4 py-2 bg-blue-600 text-white text-xs font-medium rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n          >\n            Distribute Basket\n          </button>\n        </div>\n        <p className=\"text-xs text-blue-600 mt-2\">\n          Distribute basket orders across multiple brokers using the selected algorithm.\n          Orders without specific broker assignment will be auto-distributed.\n        </p>\n      </div>\n    )}\n    </div>\n  )\n}\n\n// Removed local handleRemovePosition; parent handles removal via onRemovePosition\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7686, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/oi-pulse-payoff-chart.tsx"],"sourcesContent":["\"use client\"\n\nimport React, { useMemo, useState } from 'react'\nimport { AreaChart, Area, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine, ReferenceDot } from 'recharts'\n\ninterface PayoffData {\n  spot: number\n  pnl: number\n  t0?: number\n}\n\ninterface Metrics {\n  currentSpot?: number\n  pnl?: number\n  margin?: string | number\n  maxProfit?: number\n  maxLoss?: number\n  breakeven?: string | number\n  riskReward?: string | number\n  daysLeft?: number\n}\n\ninterface Props {\n  data: PayoffData[]\n  metrics?: Metrics\n  currentSpot?: number\n}\n\nfunction formatCurrency(v: number | string | undefined | null) {\n  if (v == null) return '—'\n  const n = typeof v === 'number' ? v : Number(v)\n  if (Number.isNaN(n)) return String(v)\n  if (Math.abs(n) >= 1000) return `₹${(n / 1000).toFixed(1)}k`\n  return `₹${n.toFixed(0)}`\n}\n\nexport function OiPulsePayoffChart({ data, metrics = {}, currentSpot }: Props) {\n  const [showT0, setShowT0] = useState(true)\n  const [showPnl, setShowPnl] = useState(true)\n\n  const transformed = useMemo(() => {\n    if (!Array.isArray(data) || data.length === 0) return []\n    return data.map((d) => ({\n      spot: d.spot,\n      pnl: d.pnl,\n      t0: d.t0 ?? null,\n      profit: d.pnl > 0 ? d.pnl : 0,\n      loss: d.pnl < 0 ? d.pnl : 0,\n    }))\n  }, [data])\n\n  const finalYMin = useMemo(() => {\n    if (!transformed.length) return -100\n    const min = Math.min(...transformed.map((d) => d.pnl))\n    return Math.floor(Math.min(min, 0) * 1.25)\n  }, [transformed])\n\n  const finalYMax = useMemo(() => {\n    if (!transformed.length) return 100\n    const max = Math.max(...transformed.map((d) => d.pnl))\n    return Math.ceil(Math.max(max, 0) * 1.25)\n  }, [transformed])\n\n  // annotations: peak and breakevens\n  const annotations = useMemo(() => {\n    if (!transformed.length) return { peak: null as PayoffData | null, breakevens: [] as number[] }\n    let peak = transformed[0]\n    for (const d of transformed) if (d.pnl > peak.pnl) peak = d\n    const breakevens: number[] = []\n    for (let i = 0; i < transformed.length - 1; i++) {\n      const a = transformed[i]\n      const b = transformed[i + 1]\n      if ((a.pnl <= 0 && b.pnl >= 0) || (a.pnl >= 0 && b.pnl <= 0)) {\n        const denom = b.pnl - a.pnl\n        if (denom === 0) breakevens.push(a.spot)\n        else {\n          const t = -a.pnl / denom\n          const x = a.spot + t * (b.spot - a.spot)\n          breakevens.push(Number(x.toFixed(2)))\n        }\n      }\n    }\n    return { peak, breakevens }\n  }, [transformed])\n\n  const currentSpotValue = currentSpot ?? metrics.currentSpot ?? (transformed.length ? transformed[Math.floor(transformed.length / 2)].spot : 0)\n  const currentSpotData = transformed.find((d) => Math.abs(d.spot - currentSpotValue) < 0.0001) || transformed[Math.floor(transformed.length / 2)]\n\n  function exportCsv() {\n    const rows = ['spot,pnl,t0']\n    transformed.forEach((r) => rows.push(`${r.spot},${r.pnl},${r.t0 ?? ''}`))\n    const blob = new Blob([rows.join('\\n')], { type: 'text/csv' })\n    const url = URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.href = url\n    a.download = 'payoff.csv'\n    a.click()\n    URL.revokeObjectURL(url)\n  }\n\n  return (\n    <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\n      <div className=\"flex items-start justify-between mb-4 gap-4\">\n        <div />\n        <div className=\"grid grid-cols-2 gap-x-6 gap-y-2 text-sm text-gray-700 w-72\">\n          <div className=\"text-xs text-gray-500\">P&L:</div>\n          <div className={`font-bold ${((metrics.pnl ?? 0) as number) < 0 ? 'text-red-600' : 'text-green-600'}`}>{formatCurrency(metrics.pnl)}</div>\n\n          <div className=\"text-xs text-gray-500\">Max Profit:</div>\n          <div className=\"font-bold text-green-600\">{formatCurrency(metrics.maxProfit)}</div>\n\n          <div className=\"text-xs text-gray-500\">Max Loss:</div>\n          <div className=\"font-bold text-red-600\">{formatCurrency(metrics.maxLoss)}</div>\n\n          <div className=\"text-xs text-gray-500\">Breakeven:</div>\n          <div className=\"font-bold text-gray-700\">{metrics.breakeven ?? '-'}</div>\n        </div>\n      </div>\n\n      <div className=\"bg-white border border-gray-200 rounded p-2\">\n        <ResponsiveContainer width=\"100%\" height={320}>\n          <AreaChart data={transformed} margin={{ top: 10, right: 10, left: -20, bottom: 20 }}>\n            <defs>\n              <linearGradient id=\"colorProfit\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                <stop offset=\"5%\" stopColor=\"#22c55e\" stopOpacity={0.28} />\n                <stop offset=\"95%\" stopColor=\"#22c55e\" stopOpacity={0} />\n              </linearGradient>\n              <pattern id=\"hatchLoss\" patternUnits=\"userSpaceOnUse\" width=\"8\" height=\"8\">\n                <rect width=\"8\" height=\"8\" fill=\"#ef4444\" fillOpacity={0.04} />\n                <path d=\"M0 0 L0 8\" stroke=\"#ef4444\" strokeWidth=\"1\" strokeOpacity=\"0.18\" />\n                <path d=\"M4 0 L4 8\" stroke=\"#ef4444\" strokeWidth=\"1\" strokeOpacity=\"0.08\" />\n              </pattern>\n            </defs>\n\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n            <XAxis dataKey=\"spot\" tick={{ fontSize: 11 }} stroke=\"#6b7280\" />\n            <YAxis\n              tick={{ fontSize: 11 }}\n              stroke=\"#6b7280\"\n              domain={[finalYMin, finalYMax]}\n              tickFormatter={(value) => {\n                if (Number.isNaN(Number(value))) return String(value)\n                if (Math.abs(Number(value)) >= 1000) return `₹${(Number(value) / 1000).toFixed(1)}k`\n                return `₹${Number(value).toFixed(0)}`\n              }}\n            />\n\n            <Tooltip\n              contentStyle={{ backgroundColor: '#fff', border: '1px solid #e5e7eb', borderRadius: '6px', fontSize: '12px' }}\n              formatter={(value, name) => {\n                const numValue = Number(value)\n                return [`₹${numValue.toFixed(2)}`, name === 'pnl' ? 'P&L' : name === 't0' ? 'T+0' : name]\n              }}\n              labelFormatter={(label) => `Spot: ₹${label}`}\n            />\n\n            <ReferenceLine x={currentSpotValue} stroke=\"#3b82f6\" strokeDasharray=\"5 5\" label={{ value: `₹${currentSpotValue}`, position: 'top', fill: '#1f2937', fontSize: 11 }} />\n\n            {currentSpotData && (\n              <ReferenceDot x={currentSpotValue} y={currentSpotData.pnl} r={4} fill=\"#2563eb\" stroke=\"#2563eb\" label={{ value: `₹${Number(currentSpotData.pnl).toFixed(2)}`, position: 'top', fill: '#2563eb', fontSize: 10 }} />\n            )}\n\n            <ReferenceLine y={0} stroke=\"#6b7280\" strokeWidth={1} />\n\n            <Area type=\"monotone\" dataKey=\"profit\" stroke=\"#16a34a\" strokeWidth={0} fill=\"url(#colorProfit)\" isAnimationActive={false} baseValue={0} />\n            <Area type=\"monotone\" dataKey=\"loss\" stroke=\"#ef4444\" strokeWidth={0} fill=\"url(#hatchLoss)\" isAnimationActive={false} baseValue={0} />\n\n            {showPnl && <Line type=\"monotone\" dataKey=\"pnl\" stroke=\"#1f2937\" strokeWidth={2} dot={false} name=\"P&L\" />}\n            {showT0 && <Line type=\"monotone\" dataKey=\"t0\" stroke=\"#06b6d4\" strokeWidth={2} dot={false} name=\"T+0\" strokeDasharray=\"4 6\" />}\n\n            {annotations.breakevens.map((b, i) => (\n              <ReferenceLine key={`be-${i}`} x={b} stroke=\"#374151\" strokeDasharray=\"3 3\" label={{ value: `BE ${b}`, position: 'bottom', fill: '#374151', fontSize: 10 }} />\n            ))}\n\n            {annotations.peak && (\n              <ReferenceDot x={annotations.peak.spot} y={annotations.peak.pnl} r={5} fill=\"#16a34a\" stroke=\"#16a34a\" label={{ value: `Peak: ₹${Number(annotations.peak.pnl).toFixed(0)}`, position: 'top', fill: '#16a34a', fontSize: 11 }} />\n            )}\n\n          </AreaChart>\n        </ResponsiveContainer>\n      </div>\n\n      <div className=\"flex items-center justify-between gap-2 mt-2\">\n        <div className=\"flex items-center gap-2\">\n          <label className=\"flex items-center gap-2 text-xs text-gray-600\">\n            <input type=\"checkbox\" checked={showPnl} onChange={() => setShowPnl((s) => !s)} className=\"w-4 h-4\" />\n            <span>P&L</span>\n          </label>\n          <label className=\"flex items-center gap-2 text-xs text-gray-600\">\n            <input type=\"checkbox\" checked={showT0} onChange={() => setShowT0((s) => !s)} className=\"w-4 h-4\" />\n            <span>T+0</span>\n          </label>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button onClick={exportCsv} className=\"p-1 hover:bg-gray-200 rounded text-gray-600 text-xs\">Export CSV</button>\n        </div>\n      </div>\n\n      <div className=\"flex justify-center gap-4 mt-3 text-xs\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-3 h-3 rounded-full border-2 border-blue-500\" />\n          <span>P&L</span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-3 h-3 rounded-full border-2 border-cyan-500\" />\n          <span>T+0</span>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8348, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/basket-order-tab.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { useMarket } from '@/components/market/market-context'\r\nimport { BasketOrderTable } from './basket-order-table'\r\nimport { OiPulsePayoffChart } from './oi-pulse-payoff-chart'\r\n\r\ninterface BasketPosition {\r\n  id: string\r\n  symbol: string\r\n  expiry: string\r\n  strike: number\r\n  cepe: 'CE' | 'PE'\r\n  qty: number\r\n  type: 'MKT' | 'LIMIT'\r\n  price: number\r\n  ltp: number\r\n  brokerId?: number\r\n}\r\n\r\ninterface SavedBasket {\r\n  id: number\r\n  name: string\r\n  positions: BasketPosition[]\r\n  createdAt: string\r\n}\r\n\r\ninterface ReadyBasket {\r\n  name: string\r\n  description: string\r\n  positions: Omit<BasketPosition, 'id'>[]\r\n}\r\n\r\nconst READY_BASKETS: ReadyBasket[] = [\r\n  // Demo baskets removed - load real baskets from API\r\n]\r\n\r\nexport function BasketOrderTab() {\r\n  const [basketPositions, setBasketPositions] = useState<BasketPosition[]>([])\r\n  const [savedBaskets, setSavedBaskets] = useState<SavedBasket[]>([])\r\n  const [dynamicReadyBaskets, setDynamicReadyBaskets] = useState<ReadyBasket[]>(READY_BASKETS)\r\n  const [currentBasketName, setCurrentBasketName] = useState('')\r\n  const [showLoadDialog, setShowLoadDialog] = useState(false)\r\n  const [showReadyBaskets, setShowReadyBaskets] = useState(false)\r\n  const [multiplier, setMultiplier] = useState(1)\r\n  const [expiry, setExpiry] = useState('25-Nov-2025')\r\n  const [orderType, setOrderType] = useState<'MKT' | 'LIMIT'>('MKT')\r\n  const [isPlacingOrders, setIsPlacingOrders] = useState(false)\r\n  const [lastAdded, setLastAdded] = useState<BasketPosition | null>(null)\r\n  const [showAddToast, setShowAddToast] = useState(false)\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const market = useMarket()\r\n\r\n  // Load saved baskets from backend\r\n  useEffect(() => {\r\n    fetchSavedBaskets()\r\n    initializeDynamicReadyBaskets()\r\n  }, [])\r\n\r\n  const initializeDynamicReadyBaskets = async () => {\r\n    try {\r\n      // Fetch current expiries and strikes for BANKNIFTY\r\n      const expiriesResponse = await fetch('http://localhost:5000/api/symbols/BANKNIFTY/expiries')\r\n      const expiriesData = await expiriesResponse.json()\r\n      \r\n      if (expiriesData.status && expiriesData.data && expiriesData.data.length > 0) {\r\n        const currentExpiry = expiriesData.data[0] // Use first available expiry\r\n        \r\n        // Fetch strikes for the current expiry\r\n        const strikesResponse = await fetch(`http://localhost:5000/api/symbols/BANKNIFTY/expiries/${encodeURIComponent(currentExpiry)}/strikes`)\r\n        const strikesData = await strikesResponse.json()\r\n        \r\n        if (strikesData.status && strikesData.data && strikesData.data.length > 0) {\r\n          const strikes = strikesData.data.sort((a: number, b: number) => a - b)\r\n          const atmStrike = strikes[Math.floor(strikes.length / 2)] // ATM strike\r\n          const otmStrike = strikes[Math.floor(strikes.length / 2) + 2] || atmStrike + 1000 // OTM strike\r\n          const itmStrike = strikes[Math.floor(strikes.length / 2) - 2] || atmStrike - 1000 // ITM strike\r\n\r\n          const dynamicBaskets: ReadyBasket[] = [\r\n            {\r\n              name: 'Bull Call Spread',\r\n              description: 'Buy ATM Call, Sell OTM Call',\r\n              positions: [\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: atmStrike, cepe: 'CE', qty: 1, type: 'MKT', price: 0, ltp: 0 },\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: otmStrike, cepe: 'CE', qty: -1, type: 'MKT', price: 0, ltp: 0 }\r\n              ]\r\n            },\r\n            {\r\n              name: 'Bear Put Spread',\r\n              description: 'Buy ATM Put, Sell OTM Put',\r\n              positions: [\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: atmStrike, cepe: 'PE', qty: 1, type: 'MKT', price: 0, ltp: 0 },\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: itmStrike, cepe: 'PE', qty: -1, type: 'MKT', price: 0, ltp: 0 }\r\n              ]\r\n            },\r\n            {\r\n              name: 'Iron Condor',\r\n              description: 'Sell OTM Call, Buy farther OTM Call, Sell OTM Put, Buy farther OTM Put',\r\n              positions: [\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: otmStrike, cepe: 'CE', qty: -1, type: 'MKT', price: 0, ltp: 0 },\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: otmStrike + 1000, cepe: 'CE', qty: 1, type: 'MKT', price: 0, ltp: 0 },\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: itmStrike, cepe: 'PE', qty: -1, type: 'MKT', price: 0, ltp: 0 },\r\n                { symbol: 'BANKNIFTY', expiry: currentExpiry, strike: itmStrike - 1000, cepe: 'PE', qty: 1, type: 'MKT', price: 0, ltp: 0 }\r\n              ]\r\n            }\r\n          ]\r\n          \r\n          setDynamicReadyBaskets(dynamicBaskets)\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error initializing dynamic ready baskets:', error)\r\n      // Fallback to static baskets\r\n      setDynamicReadyBaskets(READY_BASKETS)\r\n    }\r\n  }\r\n\r\n  const fetchSavedBaskets = async () => {\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/baskets')\r\n      const data = await response.json()\r\n      if (data.status && data.data) {\r\n        setSavedBaskets(data.data)\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching saved baskets:', err)\r\n    }\r\n  }\r\n\r\n  // Update LTP in real-time\r\n  useEffect(() => {\r\n    if (!market.symbols || Object.keys(market.symbols).length === 0) return\r\n\r\n    setBasketPositions(prev => prev.map(pos => {\r\n      // Try to find LTP for the specific option contract first\r\n      const formatExpiry = (expiry: string) => {\r\n        const parts = expiry.split('-')\r\n        if (parts.length !== 3) return expiry\r\n        const day = parts[0]\r\n        const month = parts[1].toUpperCase()\r\n        const year = parts[2].slice(-2)\r\n        return `${day}-${month}-${year}`\r\n      }\r\n      const formattedExpiry = formatExpiry(pos.expiry)\r\n      const optionKey = `${pos.symbol}-${formattedExpiry}-${pos.strike}-${pos.cepe}`\r\n      \r\n      // First try the specific option key, then fallback to base symbol\r\n      const marketData = market.symbols[optionKey] || market.symbols[pos.symbol]\r\n      return { ...pos, ltp: marketData?.ltp || pos.ltp }\r\n    }))\r\n  }, [market.symbols])\r\n\r\n  // Listen for addToBasket events\r\n  useEffect(() => {\r\n    const handleAddToBasket = (e: Event) => {\r\n      const custom = e as CustomEvent\r\n      const positionData = custom.detail\r\n      const newPosition: BasketPosition = { id: Date.now().toString(), ...positionData }\r\n      setBasketPositions(prev => [...prev, newPosition])\r\n      setLastAdded(newPosition)\r\n      setShowAddToast(true)\r\n      window.setTimeout(() => setShowAddToast(false), 2000)\r\n    }\r\n    const handleMessage = (ev: MessageEvent) => {\r\n      try {\r\n        if (ev?.data && ev.data.type === 'addToBasket') {\r\n          const positionData = ev.data.detail\r\n          const newPosition: BasketPosition = { id: Date.now().toString(), ...positionData }\r\n          setBasketPositions(prev => [...prev, newPosition])\r\n          setLastAdded(newPosition)\r\n          setShowAddToast(true)\r\n          window.setTimeout(() => setShowAddToast(false), 2000)\r\n        }\r\n      } catch (err) { console.error('postMessage handler error', err) }\r\n    }\r\n\r\n    window.addEventListener('addToBasket', handleAddToBasket)\r\n    window.addEventListener('message', handleMessage)\r\n\r\n    return () => {\r\n      window.removeEventListener('addToBasket', handleAddToBasket)\r\n      window.removeEventListener('message', handleMessage)\r\n    }\r\n  }, [])\r\n\r\n  const handleUpdatePosition = (id: string, updates: Partial<BasketPosition>) => {\r\n    setBasketPositions(positions => positions.map(p => p.id === id ? { ...p, ...updates } : p))\r\n  }\r\n\r\n  const handleRemovePosition = (id: string) => {\r\n    setBasketPositions(positions => positions.filter(p => p.id !== id))\r\n  }\r\n\r\n  const handleClearAllOrders = () => setBasketPositions([])\r\n\r\n  const handleSaveBasket = async () => {\r\n    if (!currentBasketName.trim()) {\r\n      setError('Please enter a basket name')\r\n      return\r\n    }\r\n    if (basketPositions.length === 0) {\r\n      setError('No positions to save')\r\n      return\r\n    }\r\n\r\n    setLoading(true)\r\n    setError(null)\r\n    try {\r\n      const basketData = {\r\n        name: currentBasketName,\r\n        positions: basketPositions.map(p => ({\r\n          symbol: p.symbol,\r\n          expiry: p.expiry,\r\n          strike: p.strike,\r\n          cepe: p.cepe,\r\n          qty: p.qty,\r\n          type: p.type,\r\n          price: p.price,\r\n          transaction_type: p.qty > 0 ? 'BUY' : 'SELL'\r\n        }))\r\n      }\r\n\r\n      const response = await fetch('http://localhost:5000/api/baskets', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(basketData)\r\n      })\r\n      const data = await response.json()\r\n      if (data.status) {\r\n        await fetchSavedBaskets()\r\n        setCurrentBasketName('')\r\n        setError('Basket saved successfully')\r\n        setTimeout(() => setError(null), 3000)\r\n      } else {\r\n        setError(data.error || 'Failed to save basket')\r\n      }\r\n    } catch (err) {\r\n      setError('Error saving basket')\r\n      console.error('Save basket error:', err)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleLoadBasket = (basket: SavedBasket) => {\r\n    setBasketPositions(basket.positions.map(p => ({ ...p, id: Date.now().toString() + Math.random() })))\r\n    setShowLoadDialog(false)\r\n  }\r\n\r\n  const handleLoadReadyBasket = (basket: ReadyBasket) => {\r\n    setBasketPositions(basket.positions.map(p => ({ ...p, id: Date.now().toString() + Math.random() })))\r\n    setShowReadyBaskets(false)\r\n  }\r\n\r\n  const handlePlaceAllOrders = async () => {\r\n    if (basketPositions.length === 0) return\r\n\r\n    setIsPlacingOrders(true)\r\n    setError(null)\r\n    let successCount = 0\r\n    let errorCount = 0\r\n\r\n    for (const position of basketPositions) {\r\n      try {\r\n        const orderData = {\r\n          symbol: position.symbol,\r\n          order_type: position.type,\r\n          transaction_type: position.qty > 0 ? 'BUY' : 'SELL',\r\n          quantity: Math.abs(position.qty),\r\n          price: position.type === 'LIMIT' ? position.price : null,\r\n          product_type: 'MIS' // Default to MIS for options\r\n        }\r\n\r\n        const response = await fetch('http://localhost:5000/api/orders', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(orderData)\r\n        })\r\n        const data = await response.json()\r\n        if (data.status) {\r\n          successCount++\r\n        } else {\r\n          errorCount++\r\n        }\r\n      } catch (err) {\r\n        errorCount++\r\n        console.error('Error placing order:', err)\r\n      }\r\n    }\r\n\r\n    setIsPlacingOrders(false)\r\n    if (errorCount === 0) {\r\n      setError(`All ${successCount} orders placed successfully`)\r\n      setBasketPositions([]) // Clear basket after successful placement\r\n    } else {\r\n      setError(`${successCount} orders placed, ${errorCount} failed`)\r\n    }\r\n    setTimeout(() => setError(null), 5000)\r\n  }\r\n\r\n  // Payoff calculation using real LTP\r\n  const payoffData = useMemo(() => {\r\n    if (basketPositions.length === 0) return [] as any[]\r\n    const strikes = basketPositions.map(p => p.strike)\r\n    const minStrike = Math.min(...strikes) - 2000\r\n    const maxStrike = Math.max(...strikes) + 2000\r\n    const step = 100\r\n    const data = [] as any[]\r\n    for (let spot = minStrike; spot <= maxStrike; spot += step) {\r\n      let pnl = 0\r\n      let t0 = 0\r\n      basketPositions.forEach(pos => {\r\n        const intrinsic = pos.cepe === 'CE' ? Math.max(0, spot - pos.strike) : Math.max(0, pos.strike - spot)\r\n        const premium = pos.price\r\n        const pay = (intrinsic - premium) * pos.qty * 100\r\n        const t0pay = (intrinsic - (pos.ltp || pos.price)) * pos.qty * 100\r\n        pnl += pay\r\n        t0 += t0pay\r\n      })\r\n      data.push({ spot, pnl, t0 })\r\n    }\r\n    return data\r\n  }, [basketPositions])\r\n\r\n  const metrics = useMemo(() => {\r\n    if (basketPositions.length === 0) return { currentSpot: 0, pnl: 0, margin: '-', maxProfit: 0, maxLoss: 0, breakeven: 0, riskReward: '-', daysLeft: 7 }\r\n    const currentSpot = basketPositions[0]?.strike || 0\r\n    const pnl = payoffData.find(d => Math.abs(d.spot - currentSpot) < 50)?.t0 || 0\r\n    const maxProfit = Math.max(...payoffData.map(d => d.pnl))\r\n    const maxLoss = Math.min(...payoffData.map(d => d.pnl))\r\n    const breakevens = payoffData.filter(d => Math.abs(d.pnl) < 100).map(d => d.spot)\r\n    return { currentSpot, pnl, margin: '-', maxProfit, maxLoss, breakeven: breakevens.length ? `${breakevens[0]} - ${breakevens[breakevens.length-1]}` : '-', riskReward: maxLoss !== 0 ? (Math.abs(maxProfit / maxLoss)).toFixed(2) : '-', daysLeft: 7 }\r\n  }, [basketPositions, payoffData])\r\n\r\n  const handleDistributeBasket = async (algorithm: string, maxBrokers: number) => {\r\n    if (basketPositions.length === 0) return\r\n\r\n    setIsPlacingOrders(true)\r\n    setError(null)\r\n\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/brokers/orders/basket', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          positions: basketPositions.map(p => ({\r\n            symbol: p.symbol,\r\n            expiry: p.expiry,\r\n            strike: p.strike,\r\n            cepe: p.cepe,\r\n            qty: p.qty,\r\n            type: p.type,\r\n            price: p.price,\r\n            brokerId: p.brokerId,\r\n            transaction_type: p.qty > 0 ? 'BUY' : 'SELL'\r\n          })),\r\n          distributionAlgorithm: algorithm,\r\n          maxBrokers: maxBrokers\r\n        })\r\n      })\r\n\r\n      const data = await response.json()\r\n      if (data.status) {\r\n        setError(`Basket distributed successfully across ${data.data?.brokersUsed || maxBrokers} brokers`)\r\n        setBasketPositions([]) // Clear basket after successful distribution\r\n      } else {\r\n        setError(data.error || 'Failed to distribute basket')\r\n      }\r\n    } catch (err) {\r\n      setError('Error distributing basket')\r\n      console.error('Error distributing basket:', err)\r\n    } finally {\r\n      setIsPlacingOrders(false)\r\n      setTimeout(() => setError(null), 5000)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white\">\r\n      <div className=\"px-3 md:px-6 py-3 border-b border-gray-200 bg-gray-50\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <button onClick={handleClearAllOrders} className=\"px-3 py-1.5 text-xs font-semibold text-red-600\">CLEAR ALL ORDERS</button>\r\n          <button disabled={basketPositions.length === 0 || isPlacingOrders} onClick={handlePlaceAllOrders} className=\"px-3 py-1.5 text-xs font-semibold text-green-600 disabled:opacity-50\">\r\n            {isPlacingOrders ? 'PLACING...' : 'PLACE ALL ORDERS'}\r\n          </button>\r\n          <button onClick={() => setShowLoadDialog(true)} className=\"px-3 py-1.5 text-xs font-semibold text-blue-600\">LOAD BASKET</button>\r\n          <button onClick={() => setShowReadyBaskets(true)} className=\"px-3 py-1.5 text-xs font-semibold text-purple-600\">READY BASKETS</button>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Basket name\"\r\n            value={currentBasketName}\r\n            onChange={(e) => setCurrentBasketName(e.target.value)}\r\n            className=\"px-2 py-1 text-xs border border-gray-300 rounded\"\r\n          />\r\n          <button onClick={handleSaveBasket} disabled={loading} className=\"px-3 py-1.5 text-xs font-semibold text-green-600 disabled:opacity-50\">\r\n            {loading ? 'SAVING...' : 'SAVE BASKET'}\r\n          </button>\r\n        </div>\r\n        {error && <div className=\"mt-2 text-xs text-red-600\">{error}</div>}\r\n      </div>\r\n\r\n      {/* Load Basket Dialog */}\r\n      {showLoadDialog && (\r\n        <div className=\"fixed inset-0 flex items-center justify-center z-50\" style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>\r\n          <div className=\"bg-white p-6 rounded-lg max-w-md w-full mx-4\">\r\n            <h3 className=\"text-lg font-semibold mb-4\">Load Saved Basket</h3>\r\n            <div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n              {savedBaskets.map(basket => (\r\n                <button\r\n                  key={basket.id}\r\n                  onClick={() => handleLoadBasket(basket)}\r\n                  className=\"w-full text-left p-2 border rounded hover:bg-gray-50\"\r\n                >\r\n                  <div className=\"font-medium\">{basket.name}</div>\r\n                  <div className=\"text-sm text-gray-600\">{basket.positions.length} positions</div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n            <button onClick={() => setShowLoadDialog(false)} className=\"mt-4 px-4 py-2 bg-gray-200 rounded\">Close</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Ready Baskets Dialog */}\r\n      {showReadyBaskets && (\r\n        <div className=\"fixed inset-0 flex items-center justify-center z-50\" style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>\r\n          <div className=\"bg-white p-6 rounded-lg max-w-md w-full mx-4\">\r\n            <h3 className=\"text-lg font-semibold mb-4\">Ready Baskets</h3>\r\n            <div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n              {dynamicReadyBaskets.map((basket, idx) => (\r\n                <button\r\n                  key={idx}\r\n                  onClick={() => handleLoadReadyBasket(basket)}\r\n                  className=\"w-full text-left p-2 border rounded hover:bg-gray-50\"\r\n                >\r\n                  <div className=\"font-medium\">{basket.name}</div>\r\n                  <div className=\"text-sm text-gray-600\">{basket.description}</div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n            <button onClick={() => setShowReadyBaskets(false)} className=\"mt-4 px-4 py-2 bg-gray-200 rounded\">Close</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"p-3 md:p-6 flex gap-4\">\r\n        <div className=\"flex-1 overflow-x-auto\">\r\n          <BasketOrderTable \r\n            positions={basketPositions} \r\n            onUpdatePosition={handleUpdatePosition} \r\n            onRemovePosition={handleRemovePosition} \r\n            expiry={expiry} \r\n            orderType={orderType}\r\n            enableMultiBroker={true}\r\n            onDistributeBasket={handleDistributeBasket}\r\n          />\r\n        </div>\r\n        <div className=\"w-96\">\r\n          <OiPulsePayoffChart data={payoffData} metrics={metrics as any} currentSpot={metrics.currentSpot} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9149, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/order-book-table.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useCallback } from 'react'\r\nimport ColumnSettings from './column-settings'\r\nimport { Settings } from 'lucide-react'\r\n\r\ninterface Order {\r\n  // support multiple naming conventions from backend (snake_case, camelCase, different keys)\r\n  id?: number\r\n  orderid?: string\r\n  symbol_name?: string\r\n  symbol?: string\r\n  symbolname?: string\r\n  name?: string\r\n  transaction_type?: string\r\n  transactiontype?: string\r\n  order_type?: string\r\n  ordertype?: string\r\n  product_type?: string\r\n  producttype?: string\r\n  quantity?: number\r\n  qty?: number\r\n  price?: number\r\n  status?: string\r\n  order_status?: string\r\n  orderstatus?: string\r\n  order_timestamp?: string | number\r\n  updatetime?: string | number\r\n  broker_id?: number\r\n  brokerId?: number\r\n}\r\n\r\ninterface Broker {\r\n  id: number\r\n  name: string\r\n  broker_type: string\r\n  is_active: boolean\r\n}\r\n\r\ninterface TableColumn {\r\n  id: string\r\n  label: string\r\n}\r\n\r\nconst allColumns: TableColumn[] = [\r\n  { id: 'symbolname', label: 'Symbol Name' },\r\n  { id: 'type', label: 'Type' },\r\n  { id: 'side', label: 'Side' },\r\n  { id: 'qty', label: 'Qty' },\r\n  { id: 'remqty', label: 'Rem Qty' },\r\n  { id: 'orderprice', label: 'Order Price' },\r\n  { id: 'tradedprice', label: 'Traded Price' },\r\n  { id: 'triggerprice', label: 'Trigger Price' },\r\n  { id: 'status', label: 'Status' },\r\n  { id: 'time', label: 'Time/Date 1' },\r\n  { id: 'orderid', label: 'Order Id 2' },\r\n  { id: 'errormsg', label: 'Error Msg.' },\r\n  { id: 'action', label: 'Action' },\r\n]\r\n\r\nexport function OrderBookTable({ openSettings, onOpenSettings, onTotalsChange, provideExportFn }: { openSettings?: boolean; onOpenSettings?: (open: boolean) => void; onTotalsChange?: (t: { total: number; pending: number; executed: number; rejected: number; cancelled: number }) => void; provideExportFn?: (fn: () => void) => void }) {\r\n  const [orders, setOrders] = useState<Order[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [brokers, setBrokers] = useState<Broker[]>([])\r\n  const [selectedBrokerId, setSelectedBrokerId] = useState<number | null>(null)\r\n  const [loadingBrokers, setLoadingBrokers] = useState(false)\r\n\r\n  const [showColumnSettingsState, setShowColumnSettingsState] = useState<boolean>(() => !!openSettings)\r\n  useEffect(() => {\r\n    if (typeof openSettings !== 'undefined') setShowColumnSettingsState(openSettings)\r\n  }, [openSettings])\r\n\r\n  const setShowColumnSettings = (open: boolean) => {\r\n    setShowColumnSettingsState(open)\r\n    onOpenSettings?.(open)\r\n  }\r\n\r\n  // Column settings persisted per-tab\r\n  const DEFAULT_COLS = allColumns.reduce((acc, c) => ({ ...acc, [c.id]: true }), {} as Record<string, boolean>)\r\n  const [visibleCols, setVisibleCols] = useState<Record<string, boolean>>(() => {\r\n    // First try to load from backend, fallback to localStorage, then defaults\r\n    try {\r\n      const backendSettings = localStorage.getItem('backend-column-settings-orderbook')\r\n      if (backendSettings) {\r\n        return JSON.parse(backendSettings)\r\n      }\r\n      \r\n      const raw = localStorage.getItem('orderbook-columns')\r\n      if (raw) return JSON.parse(raw)\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n    return DEFAULT_COLS\r\n  })\r\n\r\n  // Load column settings from backend on mount\r\n  useEffect(() => {\r\n    const loadBackendSettings = async () => {\r\n      try {\r\n        const response = await fetch('http://localhost:5000/api/column-settings/orderbook')\r\n        const data = await response.json()\r\n        if (data.status && data.data) {\r\n          setVisibleCols(data.data)\r\n          localStorage.setItem('backend-column-settings-orderbook', JSON.stringify(data.data))\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading column settings from backend:', error)\r\n      }\r\n    }\r\n    \r\n    loadBackendSettings()\r\n  }, [])\r\n\r\n  const fetchBrokers = async () => {\r\n    setLoadingBrokers(true)\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/brokers')\r\n      const data = await response.json()\r\n      if (data.status && data.data) {\r\n        setBrokers(data.data.filter((b: Broker) => b.is_active))\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching brokers:', error)\r\n    } finally {\r\n      setLoadingBrokers(false)\r\n    }\r\n  }\r\n\r\n  const fetchOrders = async () => {\r\n    try {\r\n      setLoading(true)\r\n      const url = selectedBrokerId \r\n        ? `http://localhost:5000/api/orders?brokerId=${selectedBrokerId}`\r\n        : 'http://localhost:5000/api/orders'\r\n      const response = await fetch(url)\r\n      const data = await response.json()\r\n\r\n      if (data.status && data.data) {\r\n        // Normalize orders to the shape expected by the table renderer.\r\n        const normalized = (data.data as any[]).map(o => {\r\n          const order: any = {\r\n            // prefer explicit ids\r\n            orderid: o.id ?? o.orderid ?? String(o.id ?? ''),\r\n            symbolname: o.symbol_name ?? o.symbolname ?? o.name ?? o.symbol ?? '-',\r\n            transactiontype: o.transaction_type ?? o.transactiontype ?? o.transactionType ?? '-',\r\n            ordertype: o.order_type ?? o.ordertype ?? o.orderType ?? '-',\r\n            producttype: o.product_type ?? o.producttype ?? o.productType ?? '-',\r\n            quantity: o.quantity ?? o.qty ?? 0,\r\n            price: o.price ?? null,\r\n            status: o.status ?? null,\r\n            orderstatus: o.order_status ?? o.orderstatus ?? o.orderStatus ?? null,\r\n            updatetime: o.order_timestamp ?? o.updatetime ?? o.update_time ?? null,\r\n            brokerId: o.broker_id ?? o.brokerId,\r\n            // keep original payload available for any other fields\r\n            __raw: o,\r\n          }\r\n          return order as Order\r\n        })\r\n\r\n        setOrders(normalized)\r\n      } else {\r\n        setError('Failed to fetch orders')\r\n      }\r\n    } catch (err) {\r\n      setError('Error fetching orders')\r\n      console.error('Error fetching orders:', err)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchOrders()\r\n    fetchBrokers()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    fetchOrders()\r\n  }, [selectedBrokerId])\r\n\r\n  // Keep header and settings available even on loading or error to match UX from the screenshot.\r\n\r\n  const totals = {\r\n    total: orders.length,\r\n    pending: orders.filter(o => o.orderstatus?.toLowerCase?.() === 'pending').length,\r\n    executed: orders.filter(o => o.orderstatus?.toLowerCase?.() === 'executed').length,\r\n    rejected: orders.filter(o => o.orderstatus?.toLowerCase?.() === 'rejected').length,\r\n    cancelled: orders.filter(o => o.orderstatus?.toLowerCase?.() === 'cancelled').length,\r\n  }\r\n\r\n  // Report totals back to parent (TabsSection via page state)\r\n  useEffect(() => {\r\n    onTotalsChange?.(totals)\r\n  }, [orders])\r\n\r\n  const exportCSV = useCallback(() => {\r\n    // Build CSV using visibleCols order\r\n    const columns = allColumns.filter(c => visibleCols[c.id])\r\n    const header = columns.map(c => `\"${c.label}\"`).join(',')\r\n    const rows = orders.map(o => {\r\n      return columns\r\n        .map(col => {\r\n          const v = (o as any)[col.id]\r\n          if (v === undefined || v === null) return '\"\"'\r\n          const str = typeof v === 'string' ? v : String(v)\r\n          return `\"${str.replace(/\"/g, '\"\"')}\"`\r\n        })\r\n        .join(',')\r\n    })\r\n    const content = [header, ...rows].join('\\n')\r\n    const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' })\r\n    const url = URL.createObjectURL(blob)\r\n    const link = document.createElement('a')\r\n    link.href = url\r\n    link.setAttribute('download', `orderbook_${new Date().toISOString()}.csv`)\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    link.remove()\r\n    URL.revokeObjectURL(url)\r\n  }, [orders, visibleCols])\r\n\r\n  useEffect(() => {\r\n    if (provideExportFn) provideExportFn(exportCSV)\r\n  }, [provideExportFn, exportCSV])\r\n\r\n  return (\r\n    <div className=\"overflow-x-auto h-full bg-white\">\r\n      {/* Broker Filter */}\r\n      <div className=\"p-4 bg-gray-50 border-b border-gray-200\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <label className=\"text-sm font-medium text-gray-700\">Broker:</label>\r\n            <select\r\n              value={selectedBrokerId || ''}\r\n              onChange={(e) => setSelectedBrokerId(e.target.value ? parseInt(e.target.value) : null)}\r\n              className=\"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            >\r\n              <option value=\"\">All Brokers</option>\r\n              {brokers.map(broker => (\r\n                <option key={broker.id} value={broker.id}>{broker.name}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <button\r\n            onClick={() => fetchOrders()}\r\n            className=\"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\r\n          >\r\n            Refresh\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* totals moved to TabsSection. Expose export function to parent (if requested). */}\r\n\r\n      <table className=\"w-full text-xs min-w-max whitespace-nowrap\">\r\n        <thead className=\"bg-gray-50 border-b border-gray-200 sticky top-0\">\r\n          <tr>\r\n            {allColumns.filter(c => visibleCols[c.id]).map(col => (\r\n              <th key={col.id} className=\"px-4 py-3 text-left font-medium text-gray-700\">\r\n                {col.label}\r\n              </th>\r\n            ))}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {error ? (\r\n            <tr>\r\n              <td colSpan={allColumns.filter(c => visibleCols[c.id]).length} className=\"px-3 py-12 text-center text-red-500 text-xs\">{error}</td>\r\n            </tr>\r\n          ) : orders.length === 0 ? (\r\n            <tr>\r\n              <td colSpan={allColumns.filter(c => visibleCols[c.id]).length} className=\"px-3 py-12 text-center text-gray-500 text-xs\">\r\n                No Orders To Show\r\n              </td>\r\n            </tr>\r\n          ) : (\r\n            orders.map((order, index) => (\r\n              <tr key={index} className=\"border-b border-gray-100 hover:bg-gray-50\">\r\n                {allColumns.filter(c => visibleCols[c.id]).map(col => {\r\n                  const val: any = (order as any)[col.id]\r\n                  switch (col.id) {\r\n                    case 'symbolname':\r\n                      return <td key={col.id} className=\"px-4 py-3 font-medium\">{order.symbolname}</td>\r\n                    case 'type':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{order.transactiontype}{order.ordertype ? ` ${order.ordertype}` : ''}</td>\r\n                    case 'side':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{order.transactiontype}</td>\r\n                    case 'qty':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{order.quantity}</td>\r\n                    case 'remqty':\r\n                    case 'tradedprice':\r\n                    case 'triggerprice':\r\n                    case 'errormsg':\r\n                    case 'action':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{val ?? '-'}</td>\r\n                    case 'orderprice':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{order.price}</td>\r\n                    case 'status':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{order.orderstatus || order.status}</td>\r\n                    case 'time':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{order.updatetime ? new Date(order.updatetime).toLocaleString() : '-'}</td>\r\n                    case 'orderid':\r\n                      return <td key={col.id} className=\"px-4 py-3\">{order.orderid}</td>\r\n                    default:\r\n                      return <td key={col.id} className=\"px-4 py-3\">{val ?? '-'}</td>\r\n                  }\r\n                })}\r\n              </tr>\r\n            ))\r\n          )}\r\n        </tbody>\r\n      </table>\r\n      <ColumnSettings\r\n        open={showColumnSettingsState}\r\n        onOpenChange={setShowColumnSettings}\r\n        columns={allColumns.map(c => ({ id: c.id, label: c.label }))}\r\n        selected={visibleCols}\r\n        onSave={(sel) => { \r\n          setVisibleCols(sel); \r\n          localStorage.setItem('orderbook-columns', JSON.stringify(sel));\r\n          localStorage.setItem('backend-column-settings-orderbook', JSON.stringify(sel));\r\n          // Save to backend\r\n          fetch('http://localhost:5000/api/column-settings/orderbook', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(sel)\r\n          }).catch(error => console.error('Error saving column settings to backend:', error));\r\n        }}\r\n        onReset={() => { \r\n          localStorage.removeItem('orderbook-columns'); \r\n          localStorage.removeItem('backend-column-settings-orderbook');\r\n          setVisibleCols(DEFAULT_COLS);\r\n          // Reset on backend\r\n          fetch('http://localhost:5000/api/column-settings/orderbook', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(DEFAULT_COLS)\r\n          }).catch(error => console.error('Error resetting column settings on backend:', error));\r\n        }}\r\n      />\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9712, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/select.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SelectPrimitive from '@radix-ui/react-select'\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Select({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\n}\n\nfunction SelectGroup({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\n}\n\nfunction SelectValue({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\n}\n\nfunction SelectTrigger({\n  className,\n  size = 'default',\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\n  size?: 'sm' | 'default'\n}) {\n  return (\n    <SelectPrimitive.Trigger\n      data-slot=\"select-trigger\"\n      data-size={size}\n      className={cn(\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      {...props}\n    >\n      {children}\n      <SelectPrimitive.Icon asChild>\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\n      </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n  )\n}\n\nfunction SelectContent({\n  className,\n  children,\n  position = 'popper',\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\n  return (\n    <SelectPrimitive.Portal>\n      <SelectPrimitive.Content\n        data-slot=\"select-content\"\n        className={cn(\n          'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md',\n          position === 'popper' &&\n            'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',\n          className,\n        )}\n        position={position}\n        {...props}\n      >\n        <SelectScrollUpButton />\n        <SelectPrimitive.Viewport\n          className={cn(\n            'p-1',\n            position === 'popper' &&\n              'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1',\n          )}\n        >\n          {children}\n        </SelectPrimitive.Viewport>\n        <SelectScrollDownButton />\n      </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n  )\n}\n\nfunction SelectLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\n  return (\n    <SelectPrimitive.Label\n      data-slot=\"select-label\"\n      className={cn('text-muted-foreground px-2 py-1.5 text-xs', className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectItem({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\n  return (\n    <SelectPrimitive.Item\n      data-slot=\"select-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\n        className,\n      )}\n      {...props}\n    >\n      <span className=\"absolute right-2 flex size-3.5 items-center justify-center\">\n        <SelectPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </SelectPrimitive.ItemIndicator>\n      </span>\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n    </SelectPrimitive.Item>\n  )\n}\n\nfunction SelectSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\n  return (\n    <SelectPrimitive.Separator\n      data-slot=\"select-separator\"\n      className={cn('bg-border pointer-events-none -mx-1 my-1 h-px', className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectScrollUpButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\n  return (\n    <SelectPrimitive.ScrollUpButton\n      data-slot=\"select-scroll-up-button\"\n      className={cn(\n        'flex cursor-default items-center justify-center py-1',\n        className,\n      )}\n      {...props}\n    >\n      <ChevronUpIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollUpButton>\n  )\n}\n\nfunction SelectScrollDownButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\n  return (\n    <SelectPrimitive.ScrollDownButton\n      data-slot=\"select-scroll-down-button\"\n      className={cn(\n        'flex cursor-default items-center justify-center py-1',\n        className,\n      )}\n      {...props}\n    >\n      <ChevronDownIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollDownButton>\n  )\n}\n\nexport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectScrollDownButton,\n  SelectScrollUpButton,\n  SelectSeparator,\n  SelectTrigger,\n  SelectValue,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAAA;AAAA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,6KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,OAAO,SAAS,EAChB,QAAQ,EACR,GAAG,OAGJ;IACC,qBACE,6LAAC,gLAAuB;QACtB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,qHAAE,EACX,gzBACA;QAED,GAAG,KAAK;;YAER;0BACD,6LAAC,6KAAoB;gBAAC,OAAO;0BAC3B,cAAA,6LAAC,8OAAe;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAInC;MAxBS;AA0BT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,WAAW,QAAQ,EACnB,GAAG,OACkD;IACrD,qBACE,6LAAC,+KAAsB;kBACrB,cAAA,6LAAC,gLAAuB;YACtB,aAAU;YACV,WAAW,IAAA,qHAAE,EACX,ijBACA,aAAa,YACX,mIACF;YAEF,UAAU;YACT,GAAG,KAAK;;8BAET,6LAAC;;;;;8BACD,6LAAC,iLAAwB;oBACvB,WAAW,IAAA,qHAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,6LAAC;;;;;;;;;;;;;;;;AAIT;MAjCS;AAmCT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,6CAA6C;QAC1D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+C;IAClD,qBACE,6LAAC,6KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6aACA;QAED,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACd,cAAA,6LAAC,sLAA6B;8BAC5B,cAAA,6LAAC,wNAAS;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGzB,6LAAC,iLAAwB;0BAAE;;;;;;;;;;;;AAGjC;MAtBS;AAwBT,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OACoD;IACvD,qBACE,6LAAC,kLAAyB;QACxB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iDAAiD;QAC9D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,qBAAqB,EAC5B,SAAS,EACT,GAAG,OACyD;IAC5D,qBACE,6LAAC,uLAA8B;QAC7B,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,wOAAa;YAAC,WAAU;;;;;;;;;;;AAG/B;MAhBS;AAkBT,SAAS,uBAAuB,EAC9B,SAAS,EACT,GAAG,OAC2D;IAC9D,qBACE,6LAAC,yLAAgC;QAC/B,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,8OAAe;YAAC,WAAU;;;;;;;;;;;AAGjC;MAhBS"}},
    {"offset": {"line": 9969, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/label.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as LabelPrimitive from '@radix-ui/react-label'\n\nimport { cn } from '@/lib/utils'\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,4KAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 10002, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/trade-book-table.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { Label } from '@/components/ui/label'\r\n\r\ninterface Trade {\r\n  tradeid?: string\r\n  symbolname?: string\r\n  producttype?: string\r\n  side?: string\r\n  avgprice?: number\r\n  netqty?: number\r\n  tradetime?: string\r\n}\r\n\r\nexport function TradeBookTable({ disableFetch }: { disableFetch?: boolean }) {\r\n  const [trades, setTrades] = useState<Trade[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [brokers, setBrokers] = useState<any[]>([])\r\n  const [selectedBrokerId, setSelectedBrokerId] = useState<number | null>(null)\r\n\r\n  useEffect(() => {\r\n    if (disableFetch) {\r\n      // Do not hit remote API in development; show empty state instead\r\n      setTrades([])\r\n      setLoading(false)\r\n      setError(null)\r\n      return\r\n    }\r\n    fetchBrokers()\r\n    fetchTrades()\r\n  }, [disableFetch])\r\n\r\n  useEffect(() => {\r\n    if (!disableFetch) {\r\n      fetchTrades()\r\n    }\r\n  }, [selectedBrokerId, disableFetch])\r\n\r\n  const fetchTrades = async () => {\r\n    try {\r\n      setLoading(true)\r\n      const url = selectedBrokerId \r\n        ? `http://localhost:5000/api/trades?brokerId=${selectedBrokerId}`\r\n        : 'http://localhost:5000/api/trades'\r\n      const response = await fetch(url)\r\n      const data = await response.json()\r\n      \r\n      if (data.status && data.data) {\r\n        setTrades(data.data)\r\n      } else {\r\n        setError('Failed to fetch trades')\r\n      }\r\n    } catch (err) {\r\n      setError('Error fetching trades')\r\n      console.error('Error fetching trades:', err)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const fetchBrokers = async () => {\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/brokers')\r\n      const data = await response.json()\r\n      if (data.status && data.data) {\r\n        setBrokers(data.data)\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching brokers:', err)\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"overflow-x-auto h-full bg-white\">\r\n        <div className=\"flex items-center justify-center h-32\">\r\n          <div className=\"text-gray-500\">Loading trades...</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"overflow-x-auto h-full bg-white\">\r\n        <div className=\"flex items-center justify-center h-32\">\r\n          <div className=\"text-red-500\">{error}</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"overflow-x-auto h-full bg-white\">\r\n      {/* Broker Filter */}\r\n      <div className=\"p-4 border-b border-gray-200\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <Label htmlFor=\"broker-select\" className=\"text-sm font-medium\">Filter by Broker:</Label>\r\n          <Select \r\n            value={selectedBrokerId?.toString() || 'all'} \r\n            onValueChange={(value) => setSelectedBrokerId(value === 'all' ? null : parseInt(value))}\r\n          >\r\n            <SelectTrigger className=\"w-48\">\r\n              <SelectValue placeholder=\"All Brokers\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Brokers</SelectItem>\r\n              {brokers.map((broker) => (\r\n                <SelectItem key={broker.id} value={broker.id.toString()}>\r\n                  {broker.name}\r\n                </SelectItem>\r\n              ))}\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n      </div>\r\n\r\n      <table className=\"w-full text-xs min-w-max whitespace-nowrap\">\r\n        <thead className=\"bg-gray-50 border-b border-gray-200 sticky top-0\">\r\n          <tr>\r\n            <th className=\"px-4 py-3 text-left font-medium text-gray-700\">Symbol Name</th>\r\n            <th className=\"px-4 py-3 text-left font-medium text-gray-700\">Product Type</th>\r\n            <th className=\"px-4 py-3 text-left font-medium text-gray-700\">Side</th>\r\n            <th className=\"px-4 py-3 text-left font-medium text-gray-700\">Avg Price</th>\r\n            <th className=\"px-4 py-3 text-left font-medium text-gray-700\">Net Qty</th>\r\n            <th className=\"px-4 py-3 text-left font-medium text-gray-700\">Time/Date</th>\r\n            <th className=\"px-4 py-3 text-left font-medium text-gray-700\">Order Id</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {trades.length === 0 ? (\r\n            <tr>\r\n              <td colSpan={7} className=\"px-3 py-12 text-center text-gray-500 text-xs\">\r\n                No Trades To Show\r\n              </td>\r\n            </tr>\r\n          ) : (\r\n            trades.map((trade, index) => (\r\n              <tr key={index} className=\"border-b border-gray-100 hover:bg-gray-50\">\r\n                <td className=\"px-4 py-3 font-medium\">{trade.symbolname ?? '-'}</td>\r\n                <td className=\"px-4 py-3\">{trade.producttype ?? '-'}</td>\r\n                <td className=\"px-4 py-3\">{trade.side ?? '-'}</td>\r\n                <td className=\"px-4 py-3\">{typeof trade.avgprice === 'number' ? trade.avgprice.toFixed(2) : '-'}</td>\r\n                <td className=\"px-4 py-3\">{typeof trade.netqty === 'number' ? trade.netqty : '-'}</td>\r\n                <td className=\"px-4 py-3\">{trade.tradetime ? new Date(trade.tradetime).toLocaleString() : '-'}</td>\r\n                <td className=\"px-4 py-3\">{trade.tradeid ?? '-'}</td>\r\n              </tr>\r\n            ))\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10384, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/holdings-table.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\n\r\ninterface Holding {\r\n  symboltoken: string\r\n  symbolname: string\r\n  producttype: string\r\n  quantity: number\r\n  avgnetprice: number\r\n  ltp: number\r\n  pnl: number\r\n  unrealised: number\r\n  realised: number\r\n  broker_id?: number\r\n  brokerId?: number\r\n}\r\n\r\ninterface Broker {\r\n  id: number\r\n  name: string\r\n  broker_type: string\r\n  is_active: boolean\r\n}\r\n\r\nexport function HoldingsTable({ onTotalsChange, disableFetch }: { onTotalsChange?: (t: { totalPnl: number; investedValue: number; marketValue: number }) => void, disableFetch?: boolean }) {\r\n  const [holdings, setHoldings] = useState<Holding[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [brokers, setBrokers] = useState<Broker[]>([])\r\n  const [selectedBrokerId, setSelectedBrokerId] = useState<number | null>(null)\r\n  const [loadingBrokers, setLoadingBrokers] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (disableFetch) {\r\n      // Avoid touching remote API during development; show empty UI instead\r\n      setHoldings([])\r\n      setLoading(false)\r\n      setError(null)\r\n      // Report empty totals\r\n      onTotalsChange?.({ totalPnl: 0, investedValue: 0, marketValue: 0 })\r\n      return\r\n    }\r\n    fetchHoldings()\r\n    fetchBrokers()\r\n  }, [disableFetch])\r\n\r\n  useEffect(() => {\r\n    if (!disableFetch) {\r\n      fetchHoldings()\r\n    }\r\n  }, [selectedBrokerId])\r\n\r\n  const fetchBrokers = async () => {\r\n    setLoadingBrokers(true)\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/brokers')\r\n      const data = await response.json()\r\n      if (data.status && data.data) {\r\n        setBrokers(data.data.filter((b: Broker) => b.is_active))\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching brokers:', error)\r\n    } finally {\r\n      setLoadingBrokers(false)\r\n    }\r\n  }\r\n\r\n  const fetchHoldings = async () => {\r\n    try {\r\n      setLoading(true)\r\n      const url = selectedBrokerId \r\n        ? `http://localhost:5000/api/holdings?brokerId=${selectedBrokerId}`\r\n        : 'http://localhost:5000/api/holdings'\r\n      const response = await fetch(url)\r\n      const data = await response.json()\r\n\r\n      if (data.status && data.data) {\r\n        const holdingsWithBroker = data.data.map((h: any) => ({\r\n          ...h,\r\n          quantity: parseFloat(h.quantity) || 0,\r\n          avgnetprice: parseFloat(h.avgnetprice) || 0,\r\n          ltp: parseFloat(h.ltp) || 0,\r\n          pnl: parseFloat(h.pnl) || 0,\r\n          unrealised: parseFloat(h.unrealised) || 0,\r\n          realised: parseFloat(h.realised) || 0,\r\n          brokerId: h.broker_id ?? h.brokerId\r\n        }))\r\n        setHoldings(holdingsWithBroker)\r\n\r\n        // Compute totals and report to parent\r\n        const totalPnl = data.data.reduce((sum: number, h: Holding) => sum + (h.pnl || 0), 0)\r\n        const investedValue = data.data.reduce((sum: number, h: Holding) => sum + ((h.quantity || 0) * (h.avgnetprice || 0)), 0)\r\n        const marketValue = data.data.reduce((sum: number, h: Holding) => sum + ((h.quantity || 0) * (h.ltp || 0)), 0)\r\n        onTotalsChange?.({ totalPnl, investedValue, marketValue })\r\n      } else {\r\n        setHoldings([])\r\n        setError('Failed to fetch holdings')\r\n        onTotalsChange?.({ totalPnl: 0, investedValue: 0, marketValue: 0 })\r\n      }\r\n    } catch (err) {\r\n      setError('Error fetching holdings')\r\n      console.error('Error fetching holdings:', err)\r\n      onTotalsChange?.({ totalPnl: 0, investedValue: 0, marketValue: 0 })\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"overflow-x-auto h-full bg-white\">\r\n        <div className=\"flex items-center justify-center h-32\">\r\n          <div className=\"text-gray-500\">Loading holdings...</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"overflow-x-auto h-full bg-white\">\r\n        <div className=\"flex items-center justify-center h-32\">\r\n          <div className=\"text-red-500\">{error}</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"overflow-x-auto h-full bg-white\">\r\n      {/* Broker Filter */}\r\n      <div className=\"p-4 bg-gray-50 border-b border-gray-200\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <label className=\"text-sm font-medium text-gray-700\">Broker:</label>\r\n            <select\r\n              value={selectedBrokerId || ''}\r\n              onChange={(e) => setSelectedBrokerId(e.target.value ? parseInt(e.target.value) : null)}\r\n              className=\"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            >\r\n              <option value=\"\">All Brokers</option>\r\n              {brokers.map(broker => (\r\n                <option key={broker.id} value={broker.id}>{broker.name}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <button\r\n            onClick={() => fetchHoldings()}\r\n            className=\"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\r\n          >\r\n            Refresh\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <table className=\"w-full text-xs\">\r\n        <thead className=\"bg-gray-50 border-b border-gray-200 sticky top-0\">\r\n          <tr>\r\n            <th className=\"px-3 py-2 text-left font-medium text-gray-700\">Symbol</th>\r\n            <th className=\"px-3 py-2 text-left font-medium text-gray-700\">Product</th>\r\n            <th className=\"px-3 py-2 text-left font-medium text-gray-700\">Qty</th>\r\n            <th className=\"px-3 py-2 text-left font-medium text-gray-700\">Avg Price</th>\r\n            <th className=\"px-3 py-2 text-left font-medium text-gray-700\">LTP</th>\r\n            <th className=\"px-3 py-2 text-left font-medium text-gray-700\">Unrealised</th>\r\n            <th className=\"px-3 py-2 text-left font-medium text-gray-700\">Realised</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {holdings.length === 0 ? (\r\n            <tr>\r\n              <td colSpan={8} className=\"px-3 py-12 text-center text-gray-500 text-xs\">\r\n                No Holdings To Show\r\n              </td>\r\n            </tr>\r\n          ) : (\r\n            holdings.map((holding, index) => (\r\n              <tr key={index} className=\"border-b border-gray-100 hover:bg-gray-50\">\r\n                <td className=\"px-3 py-2 font-medium\">{holding.symbolname}</td>\r\n                <td className=\"px-3 py-2\">{holding.producttype}</td>\r\n                <td className=\"px-3 py-2\">{holding.quantity}</td>\r\n                <td className=\"px-3 py-2\">{typeof holding.avgnetprice === 'number' ? holding.avgnetprice.toFixed(2) : '-'}</td>\r\n                <td className=\"px-3 py-2\">{typeof holding.ltp === 'number' ? holding.ltp.toFixed(2) : '-'}</td>\r\n                <td className={`px-3 py-2 ${holding.pnl >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                  {typeof holding.pnl === 'number' ? holding.pnl.toFixed(2) : '-'}\r\n                </td>\r\n                <td className={`px-3 py-2 ${holding.unrealised >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                  {typeof holding.unrealised === 'number' ? holding.unrealised.toFixed(2) : '-'}\r\n                </td>\r\n                <td className={`px-3 py-2 ${holding.realised >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                  {typeof holding.realised === 'number' ? holding.realised.toFixed(2) : '-'}\r\n                </td>\r\n              </tr>\r\n            ))\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10805, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/funds-table.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React, { useState, useEffect } from 'react'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { AlertTriangle } from 'lucide-react'\r\n\r\ninterface FundsProps {\r\n  disableFetch?: boolean\r\n}\r\n\r\ninterface BrokerFunds {\r\n  broker_id: number\r\n  broker_name: string\r\n  broker_type: string\r\n  available_margin: number\r\n  used_margin: number\r\n  total_balance: number\r\n  realized_pnl: number\r\n  unrealized_pnl: number\r\n  margin_utilization: number\r\n  risk_level: 'low' | 'medium' | 'high' | 'critical'\r\n}\r\n\r\nexport function FundsTable({ disableFetch }: FundsProps) {\r\n  const [funds, setFunds] = useState<any>(null)\r\n  const [accounts, setAccounts] = useState<any[]>([])\r\n  const [realizedPnL, setRealizedPnL] = useState<number | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [brokers, setBrokers] = useState<any[]>([])\r\n  const [brokerFunds, setBrokerFunds] = useState<BrokerFunds[]>([])\r\n  const [selectedBroker, setSelectedBroker] = useState<string>('all')\r\n  const [viewMode, setViewMode] = useState<'consolidated' | 'individual'>('consolidated')\r\n  const [alerts, setAlerts] = useState<any[]>([])\r\n\r\n  useEffect(() => {\r\n    if (disableFetch) {\r\n      setFunds({ available_margin: 100000, used_margin: 0, total_balance: 100000 })\r\n      setAccounts([\r\n        { name: 'NSE - Derivatives' },\r\n        { name: 'NSE - Equity' }\r\n      ])\r\n      setRealizedPnL(0)\r\n      setLoading(false)\r\n      return\r\n    }\r\n\r\n    fetchData()\r\n    fetchBrokers()\r\n  }, [disableFetch])\r\n\r\n  useEffect(() => {\r\n    if (!disableFetch) {\r\n      fetchData()\r\n    }\r\n  }, [selectedBroker, viewMode])\r\n\r\n  const fetchBrokers = async () => {\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/brokers')\r\n      const data = await response.json()\r\n      if (data.status && data.data) {\r\n        setBrokers(data.data.filter((b: any) => b.is_active))\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching brokers:', error)\r\n    }\r\n  }\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      setLoading(true)\r\n\r\n      if (viewMode === 'individual' && selectedBroker && selectedBroker !== 'all') {\r\n        // Fetch individual broker funds\r\n        const [fundsResponse, accountsResponse, pnlResponse] = await Promise.all([\r\n          fetch(`http://localhost:5000/api/funds?brokerId=${selectedBroker}`),\r\n          fetch('http://localhost:5000/api/accounts'),\r\n          fetch(`http://localhost:5000/api/realized-pnl?brokerId=${selectedBroker}`)\r\n        ])\r\n\r\n        const fundsData = await fundsResponse.json()\r\n        const accountsData = await accountsResponse.json()\r\n        const pnlData = await pnlResponse.json()\r\n\r\n        if (fundsData.status && fundsData.data) {\r\n          setFunds(fundsData.data)\r\n        }\r\n        if (accountsData.status && accountsData.data) {\r\n          setAccounts(accountsData.data)\r\n        }\r\n        if (pnlData.status && pnlData.data) {\r\n          setRealizedPnL(pnlData.data.realized_pnl)\r\n        }\r\n      } else {\r\n        // Fetch consolidated funds across all brokers\r\n        const [fundsResponse, accountsResponse, pnlResponse, brokerFundsResponse] = await Promise.all([\r\n          fetch('http://localhost:5000/api/funds'),\r\n          fetch('http://localhost:5000/api/accounts'),\r\n          fetch('http://localhost:5000/api/realized-pnl'),\r\n          fetch('http://localhost:5000/api/brokers/funds/all')\r\n        ])\r\n\r\n        const fundsData = await fundsResponse.json()\r\n        const accountsData = await accountsResponse.json()\r\n        const pnlData = await pnlResponse.json()\r\n        const brokerFundsData = await brokerFundsResponse.json()\r\n\r\n        if (fundsData.status && fundsData.data) {\r\n          setFunds(fundsData.data)\r\n        }\r\n        if (accountsData.status && accountsData.data) {\r\n          setAccounts(accountsData.data)\r\n        }\r\n        if (pnlData.status && pnlData.data) {\r\n          setRealizedPnL(pnlData.data.realized_pnl)\r\n        }\r\n        if (brokerFundsData.status && brokerFundsData.data) {\r\n          setBrokerFunds(brokerFundsData.data)\r\n          generateAlerts(brokerFundsData.data)\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching data:', error)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const generateAlerts = (brokerFundsData: BrokerFunds[]) => {\r\n    const newAlerts: any[] = []\r\n\r\n    brokerFundsData.forEach(broker => {\r\n      const utilization = broker.margin_utilization || 0\r\n\r\n      if (utilization > 90) {\r\n        newAlerts.push({\r\n          type: 'critical',\r\n          broker: broker.broker_name,\r\n          message: `Critical: Margin utilization at ${utilization.toFixed(1)}%`,\r\n          action: 'Reduce positions or add funds'\r\n        })\r\n      } else if (utilization > 75) {\r\n        newAlerts.push({\r\n          type: 'high',\r\n          broker: broker.broker_name,\r\n          message: `High margin utilization: ${utilization.toFixed(1)}%`,\r\n          action: 'Monitor closely'\r\n        })\r\n      }\r\n\r\n      if (broker.unrealized_pnl < -5000) {\r\n        newAlerts.push({\r\n          type: 'warning',\r\n          broker: broker.broker_name,\r\n          message: `Significant unrealized loss: ₹${broker.unrealized_pnl.toLocaleString()}`,\r\n          action: 'Consider position management'\r\n        })\r\n      }\r\n    })\r\n\r\n    setAlerts(newAlerts)\r\n  }\r\n\r\n  const rows = [\r\n    {\r\n      label: 'Total Balance',\r\n      value: funds ? `₹${funds.total_balance?.toLocaleString() || '0'}` : '-',\r\n      change: viewMode === 'individual' ? 2500 : undefined\r\n    },\r\n    {\r\n      label: 'Used Margin',\r\n      value: funds ? `₹${funds.used_margin?.toLocaleString() || '0'}` : '-',\r\n      change: viewMode === 'individual' ? -1200 : undefined\r\n    },\r\n    {\r\n      label: 'Realized P&L',\r\n      value: realizedPnL !== null ? `₹${realizedPnL.toLocaleString()}` : '-',\r\n      change: viewMode === 'individual' ? realizedPnL || 0 : undefined\r\n    },\r\n    {\r\n      label: 'Available',\r\n      value: funds ? `₹${funds.available_margin?.toLocaleString() || '0'}` : '-',\r\n      change: viewMode === 'individual' ? 3700 : undefined\r\n    },\r\n  ]\r\n\r\n  return (\r\n    <div className=\"px-4 py-4 md:px-6 md:py-6 space-y-6\">\r\n      {/* Header with Broker Selection and View Mode */}\r\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <h2 className=\"text-2xl font-semibold text-gray-900\">Funds & Margin Dashboard</h2>\r\n          <Badge variant=\"outline\" className=\"text-xs\">\r\n            {viewMode === 'consolidated' ? 'All Brokers' : selectedBroker || 'All Brokers'}\r\n          </Badge>\r\n        </div>\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Label htmlFor=\"broker-select\" className=\"text-sm font-medium\">Broker:</Label>\r\n            <Select value={selectedBroker} onValueChange={setSelectedBroker}>\r\n              <SelectTrigger className=\"w-48\">\r\n                <SelectValue placeholder=\"Select broker\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Brokers</SelectItem>\r\n                {brokers.map((broker) => (\r\n                  <SelectItem key={broker.broker_id} value={broker.broker_id}>\r\n                    {broker.broker_name}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Label htmlFor=\"view-mode\" className=\"text-sm font-medium\">View:</Label>\r\n            <Select value={viewMode} onValueChange={(value: 'consolidated' | 'individual') => setViewMode(value)}>\r\n              <SelectTrigger className=\"w-32\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"consolidated\">Consolidated</SelectItem>\r\n                <SelectItem value=\"individual\">Individual</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Risk Alerts Section */}\r\n      {alerts.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-red-200 p-4\">\r\n          <div className=\"flex items-center gap-2 mb-3\">\r\n            <AlertTriangle className=\"h-5 w-5 text-red-500\" />\r\n            <h3 className=\"text-lg font-semibold text-red-700\">Risk Management Alerts</h3>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            {alerts.map((alert, index) => (\r\n              <div key={index} className={`flex items-start gap-3 p-3 rounded-md ${\r\n                alert.type === 'critical' ? 'bg-red-50 border border-red-200' :\r\n                alert.type === 'warning' ? 'bg-yellow-50 border border-yellow-200' :\r\n                'bg-blue-50 border border-blue-200'\r\n              }`}>\r\n                <div className={`mt-0.5 h-2 w-2 rounded-full ${\r\n                  alert.type === 'critical' ? 'bg-red-500' :\r\n                  alert.type === 'warning' ? 'bg-yellow-500' :\r\n                  'bg-blue-500'\r\n                }`} />\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-sm font-medium text-gray-900\">{alert.broker}</span>\r\n                    <Badge variant={alert.type === 'critical' ? 'destructive' : 'secondary'} className=\"text-xs\">\r\n                      {alert.type.toUpperCase()}\r\n                    </Badge>\r\n                  </div>\r\n                  <p className=\"text-sm text-gray-700 mt-1\">{alert.message}</p>\r\n                  {alert.action && (\r\n                    <p className=\"text-xs text-gray-600 mt-1 font-medium\">Action: {alert.action}</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Funds Display */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        {accounts.map((account, idx) => (\r\n          <div key={idx} className=\"bg-white rounded-lg shadow-sm p-6 border\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-2xl text-gray-700\">{account.name}</h3>\r\n              {viewMode === 'individual' && selectedBroker && (\r\n                <Badge variant=\"outline\" className=\"text-xs\">\r\n                  {brokers.find(b => b.broker_id === selectedBroker)?.broker_name}\r\n                </Badge>\r\n              )}\r\n            </div>\r\n\r\n            {/* Margin Utilization Chart */}\r\n            {funds && (\r\n              <div className=\"mb-6\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <span className=\"text-sm font-medium text-gray-700\">Margin Utilization</span>\r\n                  <span className=\"text-sm text-gray-600\">\r\n                    {((funds.used_margin / funds.total_balance) * 100).toFixed(1)}%\r\n                  </span>\r\n                </div>\r\n                <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n                  <div\r\n                    className={`h-3 rounded-full transition-all duration-300 ${\r\n                      (funds.used_margin / funds.total_balance) > 0.8 ? 'bg-red-500' :\r\n                      (funds.used_margin / funds.total_balance) > 0.6 ? 'bg-yellow-500' :\r\n                      'bg-green-500'\r\n                    }`}\r\n                    style={{ width: `${Math.min((funds.used_margin / funds.total_balance) * 100, 100)}%` }}\r\n                  />\r\n                </div>\r\n                <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\r\n                  <span>Used: ₹{funds.used_margin?.toLocaleString() || '0'}</span>\r\n                  <span>Total: ₹{funds.total_balance?.toLocaleString() || '0'}</span>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"border-t border-gray-200 -mx-6\">\r\n              <table className=\"w-full text-sm\">\r\n                <thead>\r\n                  <tr>\r\n                    <th className=\"text-left px-4 py-3 text-gray-700\">Type</th>\r\n                    <th className=\"text-left px-4 py-3 text-gray-700\">Balance</th>\r\n                    {viewMode === 'individual' && (\r\n                      <th className=\"text-left px-4 py-3 text-gray-700\">Change</th>\r\n                    )}\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {rows.map((row, i) => (\r\n                    <tr key={i} className=\"border-t border-gray-100\">\r\n                      <td className=\"px-4 py-4 text-gray-600 font-medium\">{row.label}</td>\r\n                      <td className=\"px-4 py-4 text-gray-600\">{row.value}</td>\r\n                      {viewMode === 'individual' && (\r\n                        <td className=\"px-4 py-4 text-gray-600\">\r\n                          {row.change !== undefined ? (\r\n                            <span className={row.change >= 0 ? 'text-green-600' : 'text-red-600'}>\r\n                              {row.change >= 0 ? '+' : ''}₹{row.change.toLocaleString()}\r\n                            </span>\r\n                          ) : '-'}\r\n                        </td>\r\n                      )}\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Cross-Broker Summary (only show in consolidated view) */}\r\n      {viewMode === 'consolidated' && brokers.length > 1 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm p-6 border\">\r\n          <h3 className=\"text-xl font-semibold text-gray-900 mb-4\">Cross-Broker Summary</h3>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-blue-600\">\r\n                ₹{brokers.reduce((sum, b) => sum + (b.total_balance || 0), 0).toLocaleString()}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">Total Balance</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-green-600\">\r\n                ₹{brokers.reduce((sum, b) => sum + (b.available_margin || 0), 0).toLocaleString()}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">Available Margin</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className={`text-2xl font-bold ${\r\n                brokers.reduce((sum, b) => sum + (b.unrealized_pnl || 0), 0) >= 0 ? 'text-green-600' : 'text-red-600'\r\n              }`}>\r\n                ₹{brokers.reduce((sum, b) => sum + (b.unrealized_pnl || 0), 0).toLocaleString()}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">Unrealized P&L</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11631, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 11696, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 11727, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 11847, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/broker-tab.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table'\r\nimport { Switch } from '@/components/ui/switch'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { Trash2, Edit, Plus, RefreshCw, CheckCircle, XCircle, AlertCircle, Settings } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\n\r\ninterface Broker {\r\n  id: number\r\n  name: string\r\n  broker_type: string\r\n  api_key: string\r\n  api_secret: string\r\n  is_active: boolean\r\n  status?: string\r\n  health_status?: string\r\n  last_health_check?: string\r\n  created_at?: string\r\n  updated_at?: string\r\n}\r\n\r\ninterface BrokerHealth {\r\n  id: number\r\n  name: string\r\n  type: string\r\n  status: string\r\n  healthStatus: string\r\n  lastHealthCheck: string\r\n  isActive: boolean\r\n  responseTime?: number\r\n  errorMessage?: string\r\n}\r\n\r\nexport function BrokerTab() {\r\n  const [brokers, setBrokers] = useState<Broker[]>([])\r\n  const [brokerHealth, setBrokerHealth] = useState<BrokerHealth[]>([])\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\r\n  const [editingBroker, setEditingBroker] = useState<Broker | null>(null)\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [isSyncing, setIsSyncing] = useState<number | null>(null)\r\n  const [selectedBroker, setSelectedBroker] = useState<Broker | null>(null)\r\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false)\r\n  const [autoRefresh, setAutoRefresh] = useState(true)\r\n  const [refreshInterval, setRefreshInterval] = useState<NodeJS.Timeout | null>(null)\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    brokerType: 'angelone',\r\n    apiKey: '',\r\n    apiSecret: '',\r\n    isActive: false\r\n  })\r\n\r\n  useEffect(() => {\r\n    loadBrokers()\r\n    loadBrokerHealth()\r\n  }, [])\r\n\r\n  // Auto-refresh broker health\r\n  useEffect(() => {\r\n    if (autoRefresh) {\r\n      const interval = setInterval(() => {\r\n        loadBrokerHealth()\r\n      }, 30000) // Refresh every 30 seconds\r\n      setRefreshInterval(interval)\r\n      return () => clearInterval(interval)\r\n    } else {\r\n      if (refreshInterval) {\r\n        clearInterval(refreshInterval)\r\n        setRefreshInterval(null)\r\n      }\r\n    }\r\n  }, [autoRefresh])\r\n\r\n  const loadBrokers = async () => {\r\n    try {\r\n      const response = await fetch('/api/brokers')\r\n      const data = await response.json()\r\n      if (data.status) {\r\n        setBrokers(data.data)\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load brokers:', error)\r\n      toast.error('Failed to load brokers')\r\n    }\r\n  }\r\n\r\n  const loadBrokerHealth = async () => {\r\n    try {\r\n      const response = await fetch('/api/brokers/health')\r\n      const data = await response.json()\r\n      if (data.status) {\r\n        setBrokerHealth(data.data)\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load broker health:', error)\r\n    }\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setIsLoading(true)\r\n\r\n    try {\r\n      const url = editingBroker ? `/api/brokers/${editingBroker.id}` : '/api/brokers'\r\n      const method = editingBroker ? 'PUT' : 'POST'\r\n\r\n      const response = await fetch(url, {\r\n        method,\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          name: formData.name,\r\n          brokerType: formData.brokerType,\r\n          apiKey: formData.apiKey,\r\n          apiSecret: formData.apiSecret,\r\n          isActive: formData.isActive\r\n        })\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (data.status) {\r\n        toast.success(editingBroker ? 'Broker updated successfully' : 'Broker added successfully')\r\n        resetForm()\r\n        setIsDialogOpen(false)\r\n        loadBrokers()\r\n        loadBrokerHealth()\r\n      } else {\r\n        toast.error(data.error || 'Failed to save broker')\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to save broker:', error)\r\n      toast.error('Failed to save broker')\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleEdit = (broker: Broker) => {\r\n    setEditingBroker(broker)\r\n    setFormData({\r\n      name: broker.name,\r\n      brokerType: broker.broker_type,\r\n      apiKey: broker.api_key,\r\n      apiSecret: broker.api_secret,\r\n      isActive: broker.is_active\r\n    })\r\n    setIsDialogOpen(true)\r\n  }\r\n\r\n  const handleDelete = async (brokerId: number) => {\r\n    if (!confirm('Are you sure you want to delete this broker?')) return\r\n\r\n    try {\r\n      const response = await fetch(`/api/brokers/${brokerId}`, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (data.status) {\r\n        toast.success('Broker deleted successfully')\r\n        loadBrokers()\r\n        loadBrokerHealth()\r\n      } else {\r\n        toast.error(data.error || 'Failed to delete broker')\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to delete broker:', error)\r\n      toast.error('Failed to delete broker')\r\n    }\r\n  }\r\n\r\n  const handleToggleActive = async (brokerId: number, isActive: boolean) => {\r\n    try {\r\n      const response = await fetch(`/api/brokers/${brokerId}/toggle`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ isActive })\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (data.status) {\r\n        toast.success(`Broker ${isActive ? 'activated' : 'deactivated'} successfully`)\r\n        loadBrokers()\r\n        loadBrokerHealth()\r\n      } else {\r\n        toast.error(data.error || 'Failed to toggle broker status')\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to toggle broker status:', error)\r\n      toast.error('Failed to toggle broker status')\r\n    }\r\n  }\r\n\r\n  const handleOpenSettings = (broker: Broker) => {\r\n    setSelectedBroker(broker)\r\n    setIsSettingsOpen(true)\r\n  }\r\n\r\n  const handleSaveSettings = async (settings: any) => {\r\n    if (!selectedBroker) return\r\n\r\n    try {\r\n      // Save broker-specific settings (this would be implemented in the backend)\r\n      const response = await fetch(`/api/brokers/${selectedBroker.id}/settings`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(settings)\r\n      })\r\n\r\n      const data = await response.json()\r\n      if (data.status) {\r\n        toast.success('Broker settings saved successfully')\r\n        setIsSettingsOpen(false)\r\n        setSelectedBroker(null)\r\n      } else {\r\n        toast.error(data.error || 'Failed to save settings')\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to save broker settings:', error)\r\n      toast.error('Failed to save broker settings')\r\n    }\r\n  }\r\n\r\n  const handleSyncBroker = async (brokerId: number) => {\r\n    setIsSyncing(brokerId)\r\n    try {\r\n      const response = await fetch(`/api/brokers/${brokerId}/sync`, {\r\n        method: 'POST'\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (data.status) {\r\n        toast.success('Broker data synced successfully')\r\n        loadBrokerHealth()\r\n      } else {\r\n        toast.error(data.error || 'Failed to sync broker data')\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to sync broker data:', error)\r\n      toast.error('Failed to sync broker data')\r\n    } finally {\r\n      setIsSyncing(null)\r\n    }\r\n  }\r\n\r\n  const getHealthDetails = (broker: Broker) => {\r\n    const health = brokerHealth.find(h => h.id === broker.id)\r\n    if (!health) return null\r\n\r\n    return {\r\n      status: health.healthStatus,\r\n      lastCheck: health.lastHealthCheck,\r\n      responseTime: health.responseTime || null,\r\n      errorMessage: health.errorMessage || null\r\n    }\r\n  }\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      name: '',\r\n      brokerType: 'angelone',\r\n      apiKey: '',\r\n      apiSecret: '',\r\n      isActive: false\r\n    })\r\n    setEditingBroker(null)\r\n  }\r\n\r\n  const getStatusBadge = (broker: Broker) => {\r\n    const health = brokerHealth.find(h => h.id === broker.id)\r\n\r\n    if (!broker.is_active) {\r\n      return <Badge variant=\"secondary\">Inactive</Badge>\r\n    }\r\n\r\n    if (!health) {\r\n      return <Badge variant=\"outline\">Unknown</Badge>\r\n    }\r\n\r\n    switch (health.healthStatus) {\r\n      case 'healthy':\r\n        return <Badge variant=\"default\" className=\"bg-green-500\"><CheckCircle className=\"w-3 h-3 mr-1\" />Healthy</Badge>\r\n      case 'warning':\r\n        return <Badge variant=\"default\" className=\"bg-yellow-500\"><AlertCircle className=\"w-3 h-3 mr-1\" />Warning</Badge>\r\n      case 'error':\r\n        return <Badge variant=\"destructive\"><XCircle className=\"w-3 h-3 mr-1\" />Error</Badge>\r\n      default:\r\n        return <Badge variant=\"outline\">Unknown</Badge>\r\n    }\r\n  }\r\n\r\n  const getBrokerTypeDisplay = (type: string) => {\r\n    switch (type) {\r\n      case 'angelone':\r\n        return 'Angel One'\r\n      case 'motilal':\r\n        return 'Motilal Oswal'\r\n      case 'tradesmart':\r\n        return 'TradeSmart'\r\n      case 'jainam':\r\n        return 'Jainam'\r\n      case 'jmfinancial':\r\n        return 'JM Financial'\r\n      default:\r\n        return type.charAt(0).toUpperCase() + type.slice(1)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <h2 className=\"text-2xl font-bold\">Broker Management</h2>\r\n        <div className=\"flex space-x-2 items-center\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Switch\r\n              id=\"autoRefresh\"\r\n              checked={autoRefresh}\r\n              onCheckedChange={setAutoRefresh}\r\n            />\r\n            <Label htmlFor=\"autoRefresh\" className=\"text-sm\">Auto-refresh (30s)</Label>\r\n          </div>\r\n          <Button variant=\"outline\" onClick={loadBrokerHealth}>\r\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n            Refresh Status\r\n          </Button>\r\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\r\n            <DialogTrigger asChild>\r\n              <Button onClick={resetForm}>\r\n                <Plus className=\"w-4 h-4 mr-2\" />\r\n                Add Broker\r\n              </Button>\r\n            </DialogTrigger>\r\n            <DialogContent className=\"max-w-md\">\r\n              <DialogHeader>\r\n                <DialogTitle>{editingBroker ? 'Edit Broker' : 'Add New Broker'}</DialogTitle>\r\n              </DialogHeader>\r\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                <div>\r\n                  <Label htmlFor=\"name\">Broker Name</Label>\r\n                  <Input\r\n                    id=\"name\"\r\n                    value={formData.name}\r\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"brokerType\">Broker Type</Label>\r\n                  <select\r\n                    id=\"brokerType\"\r\n                    value={formData.brokerType}\r\n                    onChange={(e) => setFormData({ ...formData, brokerType: e.target.value })}\r\n                    className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n                    required\r\n                  >\r\n                    <option value=\"angelone\">Angel One</option>\r\n                    <option value=\"motilal\">Motilal Oswal</option>\r\n                    <option value=\"tradesmart\">TradeSmart</option>\r\n                    <option value=\"jainam\">Jainam</option>\r\n                    <option value=\"jmfinancial\">JM Financial</option>\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"apiKey\">API Key</Label>\r\n                  <Input\r\n                    id=\"apiKey\"\r\n                    type=\"password\"\r\n                    value={formData.apiKey}\r\n                    onChange={(e) => setFormData({ ...formData, apiKey: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"apiSecret\">API Secret</Label>\r\n                  <Input\r\n                    id=\"apiSecret\"\r\n                    type=\"password\"\r\n                    value={formData.apiSecret}\r\n                    onChange={(e) => setFormData({ ...formData, apiSecret: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <Switch\r\n                    id=\"isActive\"\r\n                    checked={formData.isActive}\r\n                    onCheckedChange={(checked) => setFormData({ ...formData, isActive: checked })}\r\n                  />\r\n                  <Label htmlFor=\"isActive\">Active</Label>\r\n                </div>\r\n                <div className=\"flex justify-end space-x-2\">\r\n                  <Button type=\"button\" variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\r\n                    Cancel\r\n                  </Button>\r\n                  <Button type=\"submit\" disabled={isLoading}>\r\n                    {isLoading ? 'Saving...' : (editingBroker ? 'Update' : 'Add')} Broker\r\n                  </Button>\r\n                </div>\r\n              </form>\r\n            </DialogContent>\r\n          </Dialog>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Broker Settings Dialog */}\r\n      <Dialog open={isSettingsOpen} onOpenChange={setIsSettingsOpen}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>Broker Settings - {selectedBroker?.name}</DialogTitle>\r\n          </DialogHeader>\r\n          {selectedBroker && (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <Label className=\"text-sm font-medium\">Risk Management</Label>\r\n                  <div className=\"space-y-2 mt-2\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Label htmlFor=\"maxOrderValue\" className=\"text-sm\">Max Order Value (₹)</Label>\r\n                      <Input\r\n                        id=\"maxOrderValue\"\r\n                        type=\"number\"\r\n                        defaultValue=\"100000\"\r\n                        className=\"w-24 h-8\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Label htmlFor=\"maxDailyLoss\" className=\"text-sm\">Max Daily Loss (%)</Label>\r\n                      <Input\r\n                        id=\"maxDailyLoss\"\r\n                        type=\"number\"\r\n                        defaultValue=\"5\"\r\n                        className=\"w-20 h-8\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Label htmlFor=\"maxPositions\" className=\"text-sm\">Max Open Positions</Label>\r\n                      <Input\r\n                        id=\"maxPositions\"\r\n                        type=\"number\"\r\n                        defaultValue=\"10\"\r\n                        className=\"w-20 h-8\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <Label className=\"text-sm font-medium\">Order Settings</Label>\r\n                  <div className=\"space-y-2 mt-2\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Label htmlFor=\"defaultProduct\" className=\"text-sm\">Default Product</Label>\r\n                      <select className=\"w-24 h-8 px-2 border rounded text-sm\">\r\n                        <option>MIS</option>\r\n                        <option>CNC</option>\r\n                        <option>NRML</option>\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Label htmlFor=\"orderTimeout\" className=\"text-sm\">Order Timeout (s)</Label>\r\n                      <Input\r\n                        id=\"orderTimeout\"\r\n                        type=\"number\"\r\n                        defaultValue=\"30\"\r\n                        className=\"w-20 h-8\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <input type=\"checkbox\" id=\"autoCancel\" defaultChecked />\r\n                      <Label htmlFor=\"autoCancel\" className=\"text-sm\">Auto-cancel pending orders</Label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <Label className=\"text-sm font-medium\">Notification Settings</Label>\r\n                <div className=\"grid grid-cols-2 gap-4 mt-2\">\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <input type=\"checkbox\" id=\"orderAlerts\" defaultChecked />\r\n                      <Label htmlFor=\"orderAlerts\" className=\"text-sm\">Order execution alerts</Label>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <input type=\"checkbox\" id=\"positionAlerts\" defaultChecked />\r\n                      <Label htmlFor=\"positionAlerts\" className=\"text-sm\">Position alerts</Label>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <input type=\"checkbox\" id=\"marginAlerts\" defaultChecked />\r\n                      <Label htmlFor=\"marginAlerts\" className=\"text-sm\">Margin threshold alerts</Label>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <input type=\"checkbox\" id=\"errorAlerts\" defaultChecked />\r\n                      <Label htmlFor=\"errorAlerts\" className=\"text-sm\">Error alerts</Label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end space-x-2\">\r\n                <Button variant=\"outline\" onClick={() => setIsSettingsOpen(false)}>\r\n                  Cancel\r\n                </Button>\r\n                <Button onClick={() => handleSaveSettings({})}>\r\n                  Save Settings\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Configured Brokers</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {brokers.length === 0 ? (\r\n            <p className=\"text-gray-500 text-center py-8\">No brokers configured yet. Add your first broker to get started.</p>\r\n          ) : (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Name</TableHead>\r\n                  <TableHead>Type</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead>Health Details</TableHead>\r\n                  <TableHead>Active</TableHead>\r\n                  <TableHead>API Key</TableHead>\r\n                  <TableHead>Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {brokers.map((broker) => {\r\n                  const healthDetails = getHealthDetails(broker)\r\n                  return (\r\n                    <TableRow key={broker.id}>\r\n                      <TableCell className=\"font-medium\">{broker.name}</TableCell>\r\n                      <TableCell>{getBrokerTypeDisplay(broker.broker_type)}</TableCell>\r\n                      <TableCell>{getStatusBadge(broker)}</TableCell>\r\n                      <TableCell>\r\n                        <div className=\"text-xs\">\r\n                          {healthDetails ? (\r\n                            <div>\r\n                              <div>Last check: {new Date(healthDetails.lastCheck).toLocaleTimeString()}</div>\r\n                              {healthDetails.responseTime && (\r\n                                <div className=\"text-gray-500\">{healthDetails.responseTime}ms</div>\r\n                              )}\r\n                              {healthDetails.errorMessage && (\r\n                                <div className=\"text-red-500 truncate max-w-32\" title={healthDetails.errorMessage}>\r\n                                  Error: {healthDetails.errorMessage.substring(0, 20)}...\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          ) : (\r\n                            <span className=\"text-gray-400\">No data</span>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Switch\r\n                          checked={broker.is_active}\r\n                          onCheckedChange={(checked) => handleToggleActive(broker.id, checked)}\r\n                        />\r\n                      </TableCell>\r\n                      <TableCell className=\"font-mono text-sm\">\r\n                        {broker.api_key.substring(0, 8)}...\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex space-x-1\">\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleSyncBroker(broker.id)}\r\n                            disabled={isSyncing === broker.id}\r\n                            title=\"Sync broker data\"\r\n                          >\r\n                            <RefreshCw className={`w-4 h-4 ${isSyncing === broker.id ? 'animate-spin' : ''}`} />\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleOpenSettings(broker)}\r\n                            title=\"Broker settings\"\r\n                          >\r\n                            <Settings className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleEdit(broker)}\r\n                            title=\"Edit broker\"\r\n                          >\r\n                            <Edit className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleDelete(broker.id)}\r\n                            title=\"Delete broker\"\r\n                          >\r\n                            <Trash2 className=\"w-4 h-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  )\r\n                })}\r\n              </TableBody>\r\n            </Table>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 13379, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/hooks/use-backend-socket.tsx"],"sourcesContent":["import { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { io, Socket } from 'socket.io-client';\r\n\r\nconst SOCKET_URL = process.env.NEXT_PUBLIC_SOCKET_URL || 'http://localhost:5000';\r\n\r\nexport interface MarketDataPayload {\r\n  token?: string;\r\n  exchange?: string;\r\n  ltp?: number;\r\n  open?: number;\r\n  high?: number;\r\n  low?: number;\r\n  close?: number;\r\n  volume?: number;\r\n  timestamp?: number;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface SubscriptionToken {\r\n  exchange: string;\r\n  token: string;\r\n}\r\n\r\nexport function useBackendSocket() {\r\n  const [connected, setConnected] = useState(false);\r\n  const [marketData, setMarketData] = useState<Record<string, MarketDataPayload>>({});\r\n  const socketRef = useRef<Socket | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    // Initialize Socket.IO connection\r\n    const socket = io(SOCKET_URL, {\r\n      transports: ['websocket', 'polling'],\r\n      reconnection: true,\r\n      reconnectionDelay: 1000,\r\n      reconnectionDelayMax: 5000,\r\n      reconnectionAttempts: 5,\r\n    });\r\n\r\n    socketRef.current = socket;\r\n\r\n    socket.on('connect', () => {\r\n      console.log('✅ Connected to backend Socket.IO server');\r\n      setConnected(true);\r\n      setError(null);\r\n    });\r\n\r\n    socket.on('disconnect', () => {\r\n      console.log('❌ Disconnected from backend Socket.IO server');\r\n      setConnected(false);\r\n    });\r\n\r\n    socket.on('connect_error', (err) => {\r\n      console.error('Connection error:', err.message);\r\n      setError(err.message);\r\n      setConnected(false);\r\n    });\r\n\r\n    socket.on('marketData', (payload: MarketDataPayload | MarketDataPayload[]) => {\r\n      const updates = Array.isArray(payload) ? payload : [payload];\r\n\r\n      if (updates.length === 0) {\r\n        return;\r\n      }\r\n\r\n      setMarketData((prev) => {\r\n        const next = { ...prev };\r\n\r\n        updates.forEach((data) => {\r\n          if (!data) return;\r\n          const key = data.token || data.exchange;\r\n          if (!key) return;\r\n          next[key] = data;\r\n        });\r\n\r\n        return next;\r\n      });\r\n    });\r\n\r\n    socket.on('subscribed', (data) => {\r\n      console.log('✅ Subscribed to symbols:', data);\r\n    });\r\n\r\n    socket.on('unsubscribed', (data) => {\r\n      console.log('📴 Unsubscribed from symbols:', data);\r\n    });\r\n\r\n    socket.on('error', (data) => {\r\n      console.error('❌ Socket error:', data);\r\n      setError(data.message);\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  const subscribe = useCallback((tokens: SubscriptionToken[], mode: number = 3) => {\r\n    if (socketRef.current?.connected) {\r\n      socketRef.current.emit('subscribe', { tokens, mode });\r\n      console.log('📡 Subscribing to tokens:', tokens);\r\n    } else {\r\n      console.warn('⚠️ Socket not connected, cannot subscribe');\r\n    }\r\n  }, []);\r\n\r\n  const unsubscribe = useCallback((tokens: SubscriptionToken[]) => {\r\n    if (socketRef.current?.connected) {\r\n      socketRef.current.emit('unsubscribe', { tokens });\r\n      console.log('📴 Unsubscribing from tokens:', tokens);\r\n    }\r\n  }, []);\r\n\r\n  const getSubscriptions = useCallback(() => {\r\n    if (socketRef.current?.connected) {\r\n      socketRef.current.emit('getSubscriptions');\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    connected,\r\n    marketData,\r\n    error,\r\n    subscribe,\r\n    unsubscribe,\r\n    getSubscriptions,\r\n    socket: socketRef.current,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;AAGmB;AAHnB;AACA;;;;AAEA,MAAM,aAAa,6DAAsC;AAoBlD,SAAS;;IACd,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAoC,CAAC;IACjF,MAAM,YAAY,IAAA,uKAAM,EAAgB;IACxC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,IAAA,0KAAS;sCAAC;YACR,kCAAkC;YAClC,MAAM,SAAS,IAAA,wLAAE,EAAC,YAAY;gBAC5B,YAAY;oBAAC;oBAAa;iBAAU;gBACpC,cAAc;gBACd,mBAAmB;gBACnB,sBAAsB;gBACtB,sBAAsB;YACxB;YAEA,UAAU,OAAO,GAAG;YAEpB,OAAO,EAAE,CAAC;8CAAW;oBACnB,QAAQ,GAAG,CAAC;oBACZ,aAAa;oBACb,SAAS;gBACX;;YAEA,OAAO,EAAE,CAAC;8CAAc;oBACtB,QAAQ,GAAG,CAAC;oBACZ,aAAa;gBACf;;YAEA,OAAO,EAAE,CAAC;8CAAiB,CAAC;oBAC1B,QAAQ,KAAK,CAAC,qBAAqB,IAAI,OAAO;oBAC9C,SAAS,IAAI,OAAO;oBACpB,aAAa;gBACf;;YAEA,OAAO,EAAE,CAAC;8CAAc,CAAC;oBACvB,MAAM,UAAU,MAAM,OAAO,CAAC,WAAW,UAAU;wBAAC;qBAAQ;oBAE5D,IAAI,QAAQ,MAAM,KAAK,GAAG;wBACxB;oBACF;oBAEA;sDAAc,CAAC;4BACb,MAAM,OAAO;gCAAE,GAAG,IAAI;4BAAC;4BAEvB,QAAQ,OAAO;8DAAC,CAAC;oCACf,IAAI,CAAC,MAAM;oCACX,MAAM,MAAM,KAAK,KAAK,IAAI,KAAK,QAAQ;oCACvC,IAAI,CAAC,KAAK;oCACV,IAAI,CAAC,IAAI,GAAG;gCACd;;4BAEA,OAAO;wBACT;;gBACF;;YAEA,OAAO,EAAE,CAAC;8CAAc,CAAC;oBACvB,QAAQ,GAAG,CAAC,4BAA4B;gBAC1C;;YAEA,OAAO,EAAE,CAAC;8CAAgB,CAAC;oBACzB,QAAQ,GAAG,CAAC,iCAAiC;gBAC/C;;YAEA,OAAO,EAAE,CAAC;8CAAS,CAAC;oBAClB,QAAQ,KAAK,CAAC,mBAAmB;oBACjC,SAAS,KAAK,OAAO;gBACvB;;YAEA;8CAAO;oBACL,OAAO,UAAU;gBACnB;;QACF;qCAAG,EAAE;IAEL,MAAM,YAAY,IAAA,4KAAW;mDAAC,CAAC,QAA6B,OAAe,CAAC;YAC1E,IAAI,UAAU,OAAO,EAAE,WAAW;gBAChC,UAAU,OAAO,CAAC,IAAI,CAAC,aAAa;oBAAE;oBAAQ;gBAAK;gBACnD,QAAQ,GAAG,CAAC,6BAA6B;YAC3C,OAAO;gBACL,QAAQ,IAAI,CAAC;YACf;QACF;kDAAG,EAAE;IAEL,MAAM,cAAc,IAAA,4KAAW;qDAAC,CAAC;YAC/B,IAAI,UAAU,OAAO,EAAE,WAAW;gBAChC,UAAU,OAAO,CAAC,IAAI,CAAC,eAAe;oBAAE;gBAAO;gBAC/C,QAAQ,GAAG,CAAC,iCAAiC;YAC/C;QACF;oDAAG,EAAE;IAEL,MAAM,mBAAmB,IAAA,4KAAW;0DAAC;YACnC,IAAI,UAAU,OAAO,EAAE,WAAW;gBAChC,UAAU,OAAO,CAAC,IAAI,CAAC;YACzB;QACF;yDAAG,EAAE;IAEL,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;QACA,QAAQ,UAAU,OAAO;IAC3B;AACF;GAzGgB"}},
    {"offset": {"line": 13527, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/trading/watchlist-tab.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect, useCallback, useRef } from 'react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Trash2, Plus, Search, X, TrendingUp, TrendingDown, RefreshCw, Star } from 'lucide-react'\r\nimport { useBackendSocket } from '@/hooks/use-backend-socket'\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'\r\n\r\ninterface WatchlistItem {\r\n  id: string\r\n  symbol: string\r\n  name: string\r\n  token: string\r\n  exchange: string\r\n  ltp: number\r\n  prevClose: number\r\n  change: number\r\n  changePercent: number\r\n}\r\n\r\ninterface SearchResult {\r\n  symbol: string\r\n  name: string\r\n  token: string\r\n  exchange: string\r\n  segment: string\r\n  instrument_type?: string\r\n}\r\n\r\n// Default indices to show initially\r\nconst DEFAULT_INDICES = [\r\n  { symbol: 'Nifty 50', name: 'NIFTY 50', exchange: 'NSE', token: '99926000' },\r\n  { symbol: 'Nifty Bank', name: 'NIFTY BANK', exchange: 'NSE', token: '99926009' },\r\n  { symbol: 'SENSEX', name: 'SENSEX', exchange: 'BSE', token: '99919000' },\r\n  { symbol: 'Nifty Fin Service', name: 'NIFTY FIN SERVICE', exchange: 'NSE', token: '99926037' },\r\n  { symbol: 'NIFTY MID SELECT', name: 'NIFTY MIDCAP SELECT', exchange: 'NSE', token: '99926074' },\r\n  { symbol: 'Nifty Next 50', name: 'NIFTY NEXT 50', exchange: 'NSE', token: '99926013' },\r\n  { symbol: 'BANKEX', name: 'BANKEX', exchange: 'BSE', token: '99919012' },\r\n]\r\n\r\nexport function WatchlistTab() {\r\n  const [watchlist, setWatchlist] = useState<WatchlistItem[]>([])\r\n  const [searchQuery, setSearchQuery] = useState('')\r\n  const [searchResults, setSearchResults] = useState<SearchResult[]>([])\r\n  const [isSearching, setIsSearching] = useState(false)\r\n  const [showSuggestions, setShowSuggestions] = useState(false)\r\n  const [isInitialized, setIsInitialized] = useState(false)\r\n  const searchInputRef = useRef<HTMLInputElement>(null)\r\n  const suggestionsRef = useRef<HTMLDivElement>(null)\r\n  const watchlistRef = useRef<WatchlistItem[]>([])\r\n  const { connected, marketData, subscribe } = useBackendSocket()\r\n\r\n  // Keep watchlist ref in sync\r\n  useEffect(() => {\r\n    watchlistRef.current = watchlist\r\n  }, [watchlist])\r\n\r\n  // Load watchlist from localStorage on mount or initialize with defaults\r\n  useEffect(() => {\r\n    const savedWatchlist = localStorage.getItem('watchlist')\r\n    if (savedWatchlist) {\r\n      try {\r\n        const parsed = JSON.parse(savedWatchlist)\r\n        if (Array.isArray(parsed) && parsed.length > 0) {\r\n          setWatchlist(parsed)\r\n          setIsInitialized(true)\r\n          return\r\n        }\r\n      } catch (e) {\r\n        console.error('Error parsing saved watchlist:', e)\r\n      }\r\n    }\r\n    \r\n    // Initialize with default indices\r\n    initializeDefaultWatchlist()\r\n  }, [])\r\n\r\n  const initializeDefaultWatchlist = async () => {\r\n    const defaultItems: WatchlistItem[] = DEFAULT_INDICES.map((item, index) => ({\r\n      id: `default-${index}-${Date.now()}`,\r\n      symbol: item.symbol,\r\n      name: item.name,\r\n      token: item.token,\r\n      exchange: item.exchange,\r\n      ltp: 0,\r\n      prevClose: 0,\r\n      change: 0,\r\n      changePercent: 0,\r\n    }))\r\n    \r\n    setWatchlist(defaultItems)\r\n    localStorage.setItem('watchlist', JSON.stringify(defaultItems))\r\n    setIsInitialized(true)\r\n  }\r\n\r\n  // Subscribe to watchlist tokens when connected\r\n  useEffect(() => {\r\n    if (connected && watchlist.length > 0 && isInitialized) {\r\n      const tokens = watchlist.map(item => ({\r\n        exchange: item.exchange || 'NSE',\r\n        token: item.token\r\n      }))\r\n      subscribe(tokens, 3) // Mode 3 = Full quote with OHLC\r\n      console.log('📡 Subscribing to watchlist tokens:', tokens)\r\n    }\r\n  }, [connected, isInitialized]) // Don't depend on watchlist.length to avoid re-subscribing loops\r\n\r\n  // Re-subscribe when watchlist changes (adding/removing items)\r\n  const watchlistTokensKey = watchlist.map(w => w.token).join(',')\r\n  useEffect(() => {\r\n    if (connected && watchlist.length > 0 && isInitialized) {\r\n      const tokens = watchlist.map(item => ({\r\n        exchange: item.exchange || 'NSE',\r\n        token: item.token\r\n      }))\r\n      subscribe(tokens, 3)\r\n    }\r\n  }, [watchlistTokensKey, connected, isInitialized])\r\n\r\n  // Update prices from market data - use a ref to avoid dependency loops\r\n  const marketDataRef = useRef(marketData)\r\n  useEffect(() => {\r\n    marketDataRef.current = marketData\r\n  }, [marketData])\r\n\r\n  // Update prices periodically from market data\r\n  useEffect(() => {\r\n    const updatePrices = () => {\r\n      const data = marketDataRef.current\r\n      if (Object.keys(data).length === 0) return\r\n      \r\n      setWatchlist(prev => {\r\n        let hasChanges = false\r\n        const updated = prev.map(item => {\r\n          // Try both string and number token keys\r\n          const tokenData = data[item.token] || data[String(item.token)] || data[Number(item.token)]\r\n          if (tokenData && tokenData.ltp && tokenData.ltp !== item.ltp) {\r\n            hasChanges = true\r\n            const newLtp = tokenData.ltp\r\n            const prevClose = tokenData.close || item.prevClose || newLtp\r\n            const change = newLtp - prevClose\r\n            const changePercent = prevClose > 0 ? (change / prevClose) * 100 : 0\r\n            return {\r\n              ...item,\r\n              ltp: newLtp,\r\n              prevClose,\r\n              change,\r\n              changePercent\r\n            }\r\n          }\r\n          return item\r\n        })\r\n        return hasChanges ? updated : prev\r\n      })\r\n    }\r\n\r\n    // Update immediately\r\n    updatePrices()\r\n\r\n    // Then update every second\r\n    const interval = setInterval(updatePrices, 1000)\r\n    return () => clearInterval(interval)\r\n  }, [isInitialized])\r\n\r\n  // Save watchlist to localStorage whenever it changes\r\n  useEffect(() => {\r\n    if (isInitialized && watchlist.length > 0) {\r\n      localStorage.setItem('watchlist', JSON.stringify(watchlist))\r\n    }\r\n  }, [watchlist, isInitialized])\r\n\r\n  // Debounced search\r\n  useEffect(() => {\r\n    if (!searchQuery.trim()) {\r\n      setSearchResults([])\r\n      setShowSuggestions(false)\r\n      return\r\n    }\r\n\r\n    const timer = setTimeout(async () => {\r\n      setIsSearching(true)\r\n      try {\r\n        const response = await fetch(`${API_URL}/symbols/search?q=${encodeURIComponent(searchQuery)}&limit=20`)\r\n        const data = await response.json()\r\n        \r\n        if (data.success && data.data) {\r\n          // Filter out already added symbols\r\n          const existingTokens = new Set(watchlist.map(w => w.token))\r\n          const filtered = data.data.filter((item: SearchResult) => !existingTokens.has(item.token))\r\n          setSearchResults(filtered)\r\n          setShowSuggestions(true)\r\n        }\r\n      } catch (error) {\r\n        console.error('Error searching symbols:', error)\r\n      } finally {\r\n        setIsSearching(false)\r\n      }\r\n    }, 300) // 300ms debounce\r\n\r\n    return () => clearTimeout(timer)\r\n  }, [searchQuery, watchlist])\r\n\r\n  // Close suggestions when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (\r\n        suggestionsRef.current && \r\n        !suggestionsRef.current.contains(event.target as Node) &&\r\n        searchInputRef.current &&\r\n        !searchInputRef.current.contains(event.target as Node)\r\n      ) {\r\n        setShowSuggestions(false)\r\n      }\r\n    }\r\n\r\n    document.addEventListener('mousedown', handleClickOutside)\r\n    return () => document.removeEventListener('mousedown', handleClickOutside)\r\n  }, [])\r\n\r\n  const addSymbol = useCallback((item: SearchResult) => {\r\n    const newItem: WatchlistItem = {\r\n      id: `${item.token}-${Date.now()}`,\r\n      symbol: item.symbol,\r\n      name: item.name || item.symbol,\r\n      token: item.token,\r\n      exchange: item.exchange || 'NSE',\r\n      ltp: 0,\r\n      prevClose: 0,\r\n      change: 0,\r\n      changePercent: 0,\r\n    }\r\n\r\n    setWatchlist(prev => [...prev, newItem])\r\n    setSearchQuery('')\r\n    setSearchResults([])\r\n    setShowSuggestions(false)\r\n\r\n    // Subscribe to the new token\r\n    if (connected) {\r\n      subscribe([{ exchange: newItem.exchange, token: newItem.token }], 3)\r\n    }\r\n  }, [connected, subscribe])\r\n\r\n  const removeSymbol = useCallback((id: string) => {\r\n    setWatchlist(prev => {\r\n      const updated = prev.filter(item => item.id !== id)\r\n      localStorage.setItem('watchlist', JSON.stringify(updated))\r\n      return updated\r\n    })\r\n  }, [])\r\n\r\n  // Fetch quotes via REST API as fallback\r\n  const fetchQuotesViaAPI = useCallback(async () => {\r\n    const currentWatchlist = watchlistRef.current\r\n    if (currentWatchlist.length === 0) return\r\n    \r\n    try {\r\n      const tokens = currentWatchlist.map(item => ({\r\n        exchange: item.exchange || 'NSE',\r\n        token: item.token\r\n      }))\r\n      \r\n      const response = await fetch(`${API_URL}/quotes/full`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ tokens })\r\n      })\r\n      \r\n      const json = await response.json()\r\n      if (!json?.success || !Array.isArray(json.data)) return\r\n      \r\n      // Create a map of token to quote data\r\n      const quoteMap: Record<string, any> = {}\r\n      json.data.forEach((quote: any) => {\r\n        if (quote?.token) {\r\n          quoteMap[String(quote.token)] = quote\r\n        }\r\n      })\r\n      \r\n      setWatchlist(prev => {\r\n        let hasChanges = false\r\n        const updated = prev.map(item => {\r\n          const quote = quoteMap[String(item.token)]\r\n          if (quote && quote.ltp && quote.ltp !== item.ltp) {\r\n            hasChanges = true\r\n            const newLtp = quote.ltp\r\n            const prevClose = quote.close || item.prevClose || newLtp\r\n            const change = newLtp - prevClose\r\n            const changePercent = prevClose > 0 ? (change / prevClose) * 100 : 0\r\n            return {\r\n              ...item,\r\n              ltp: newLtp,\r\n              prevClose,\r\n              change,\r\n              changePercent\r\n            }\r\n          }\r\n          return item\r\n        })\r\n        return hasChanges ? updated : prev\r\n      })\r\n    } catch (error) {\r\n      console.error('Error fetching quotes via API:', error)\r\n    }\r\n  }, []) // No dependencies - uses ref\r\n\r\n  // Periodically fetch quotes via API as fallback (every 2 seconds)\r\n  useEffect(() => {\r\n    if (!isInitialized) return\r\n    \r\n    // Initial fetch after a small delay to ensure watchlist is set\r\n    const initialTimeout = setTimeout(fetchQuotesViaAPI, 500)\r\n    \r\n    // Then poll every 2 seconds\r\n    const interval = setInterval(fetchQuotesViaAPI, 2000)\r\n    return () => {\r\n      clearTimeout(initialTimeout)\r\n      clearInterval(interval)\r\n    }\r\n  }, [isInitialized, fetchQuotesViaAPI])\r\n\r\n  const refreshPrices = useCallback(() => {\r\n    const currentWatchlist = watchlistRef.current\r\n    // Try both WebSocket subscription and REST API\r\n    if (connected && currentWatchlist.length > 0) {\r\n      const tokens = currentWatchlist.map(item => ({\r\n        exchange: item.exchange || 'NSE',\r\n        token: item.token\r\n      }))\r\n      subscribe(tokens, 3)\r\n    }\r\n    // Also fetch via API\r\n    fetchQuotesViaAPI()\r\n  }, [connected, subscribe, fetchQuotesViaAPI])\r\n\r\n  const clearWatchlist = useCallback(() => {\r\n    if (confirm('Clear watchlist and reset to default indices?')) {\r\n      localStorage.removeItem('watchlist')\r\n      initializeDefaultWatchlist()\r\n    }\r\n  }, [])\r\n\r\n  const formatChange = (change: number, changePercent: number) => {\r\n    const sign = change >= 0 ? '+' : ''\r\n    return `${sign}${change.toFixed(2)} / ${sign}${changePercent.toFixed(2)}%`\r\n  }\r\n\r\n  const getSegmentBadge = (exchange: string, segment?: string) => {\r\n    if (segment === 'Index' || segment === 'INDICES') {\r\n      return <span className=\"text-xs px-1.5 py-0.5 rounded bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400\">IDX</span>\r\n    }\r\n    return <span className=\"text-xs px-1.5 py-0.5 rounded bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400\">{exchange}</span>\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-4 md:p-6 space-y-4\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <Star className=\"w-6 h-6 text-yellow-500\" />\r\n          <h2 className=\"text-xl md:text-2xl font-bold\">Watchlist</h2>\r\n          <span className={cn(\r\n            \"text-xs px-2 py-1 rounded-full font-medium\",\r\n            connected \r\n              ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400' \r\n              : 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'\r\n          )}>\r\n            {connected ? '● Live' : '○ Offline'}\r\n          </span>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button onClick={refreshPrices} variant=\"outline\" size=\"sm\" disabled={!connected}>\r\n            <RefreshCw className=\"w-4 h-4 mr-1\" />\r\n            Refresh\r\n          </Button>\r\n          <Button onClick={clearWatchlist} variant=\"outline\" size=\"sm\">\r\n            Reset\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Search Box */}\r\n      <Card>\r\n        <CardContent className=\"pt-4\">\r\n          <div className=\"relative\">\r\n            <div className=\"relative\">\r\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n              <Input\r\n                ref={searchInputRef}\r\n                placeholder=\"Search symbol (e.g., RELIANCE, TCS, NIFTY)...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                onFocus={() => searchQuery.trim() && setShowSuggestions(true)}\r\n                className=\"pl-10 pr-10\"\r\n              />\r\n              {searchQuery && (\r\n                <button\r\n                  onClick={() => {\r\n                    setSearchQuery('')\r\n                    setSearchResults([])\r\n                    setShowSuggestions(false)\r\n                  }}\r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground\"\r\n                >\r\n                  <X className=\"w-4 h-4\" />\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            {/* Search Suggestions Dropdown */}\r\n            {showSuggestions && (\r\n              <div\r\n                ref={suggestionsRef}\r\n                className=\"absolute z-50 w-full mt-1 bg-background border rounded-md shadow-lg max-h-80 overflow-y-auto\"\r\n              >\r\n                {isSearching ? (\r\n                  <div className=\"p-4 text-center text-muted-foreground\">\r\n                    <RefreshCw className=\"w-4 h-4 animate-spin inline mr-2\" />\r\n                    Searching...\r\n                  </div>\r\n                ) : searchResults.length > 0 ? (\r\n                  <div className=\"py-1\">\r\n                    {searchResults.map((result, index) => (\r\n                      <button\r\n                        key={`${result.token}-${index}`}\r\n                        onClick={() => addSymbol(result)}\r\n                        className=\"w-full px-4 py-2.5 text-left hover:bg-accent flex items-center justify-between group\"\r\n                      >\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <span className=\"font-medium truncate\">{result.symbol}</span>\r\n                            {getSegmentBadge(result.exchange, result.segment)}\r\n                          </div>\r\n                          <div className=\"text-xs text-muted-foreground truncate\">\r\n                            {result.name}\r\n                          </div>\r\n                        </div>\r\n                        <Plus className=\"w-4 h-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity shrink-0 ml-2\" />\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                ) : searchQuery.trim() ? (\r\n                  <div className=\"p-4 text-center text-muted-foreground\">\r\n                    No symbols found for \"{searchQuery}\"\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Watchlist */}\r\n      <Card className=\"flex flex-col\">\r\n        <CardHeader className=\"pb-3 shrink-0\">\r\n          <CardTitle className=\"text-lg flex items-center justify-between\">\r\n            <span>My Watchlist</span>\r\n            <span className=\"text-sm font-normal text-muted-foreground\">{watchlist.length} symbols</span>\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"flex-1 overflow-hidden\">\r\n          {watchlist.length === 0 ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              <Star className=\"w-12 h-12 mx-auto mb-3 opacity-20\" />\r\n              <p>No symbols in watchlist</p>\r\n              <p className=\"text-sm\">Search and add symbols above</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"flex flex-col h-full\">\r\n              {/* Header Row */}\r\n              <div className=\"grid grid-cols-12 gap-2 px-3 py-2 text-xs font-medium text-muted-foreground border-b shrink-0\">\r\n                <div className=\"col-span-4\">Symbol</div>\r\n                <div className=\"col-span-2 text-center\">Exchange</div>\r\n                <div className=\"col-span-2 text-right\">LTP</div>\r\n                <div className=\"col-span-3 text-right\">Change</div>\r\n                <div className=\"col-span-1\"></div>\r\n              </div>\r\n              \r\n              {/* Scrollable List */}\r\n              <div className=\"flex-1 overflow-y-auto max-h-[60vh]\">\r\n                {/* Watchlist Items */}\r\n                {watchlist.map((item) => (\r\n                  <div\r\n                    key={item.id}\r\n                    className=\"grid grid-cols-12 gap-2 px-3 py-3 hover:bg-accent/50 rounded-lg items-center group transition-colors\"\r\n                  >\r\n                    {/* Symbol & Name */}\r\n                    <div className=\"col-span-4 min-w-0\">\r\n                      <div className=\"font-semibold truncate\">{item.symbol}</div>\r\n                      <div className=\"text-xs text-muted-foreground truncate\">{item.name}</div>\r\n                    </div>\r\n\r\n                    {/* Exchange */}\r\n                    <div className=\"col-span-2 text-center\">\r\n                      <span className={cn(\r\n                        \"text-xs px-2 py-0.5 rounded font-medium\",\r\n                        item.exchange === 'BSE' \r\n                          ? 'bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400'\r\n                          : 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400'\r\n                      )}>\r\n                        {item.exchange}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {/* LTP */}\r\n                    <div className=\"col-span-2 text-right\">\r\n                      <span className=\"font-mono font-semibold\">\r\n                        {item.ltp > 0 ? `₹${item.ltp.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : '—'}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {/* Change */}\r\n                    <div className=\"col-span-3 text-right\">\r\n                      <div className={cn(\r\n                        \"flex items-center justify-end gap-1 text-sm font-medium\",\r\n                        item.change > 0 ? 'text-green-600 dark:text-green-400' : \r\n                        item.change < 0 ? 'text-red-600 dark:text-red-400' : \r\n                        'text-muted-foreground'\r\n                      )}>\r\n                        {item.change !== 0 && (\r\n                          item.change > 0 ? \r\n                            <TrendingUp className=\"w-3 h-3 shrink-0\" /> : \r\n                            <TrendingDown className=\"w-3 h-3 shrink-0\" />\r\n                        )}\r\n                        <span className=\"font-mono text-xs whitespace-nowrap\">\r\n                          {item.ltp > 0 ? formatChange(item.change, item.changePercent) : '—'}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Remove Button */}\r\n                    <div className=\"col-span-1 text-right\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => removeSymbol(item.id)}\r\n                        className=\"opacity-0 group-hover:opacity-100 transition-opacity h-7 w-7 p-0\"\r\n                      >\r\n                        <Trash2 className=\"w-4 h-4 text-muted-foreground hover:text-destructive\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;AAUgB;;AARhB;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;AARA;;;;;;;;AAUA,MAAM,UAAU,iEAAmC;AAuBnD,oCAAoC;AACpC,MAAM,kBAAkB;IACtB;QAAE,QAAQ;QAAY,MAAM;QAAY,UAAU;QAAO,OAAO;IAAW;IAC3E;QAAE,QAAQ;QAAc,MAAM;QAAc,UAAU;QAAO,OAAO;IAAW;IAC/E;QAAE,QAAQ;QAAU,MAAM;QAAU,UAAU;QAAO,OAAO;IAAW;IACvE;QAAE,QAAQ;QAAqB,MAAM;QAAqB,UAAU;QAAO,OAAO;IAAW;IAC7F;QAAE,QAAQ;QAAoB,MAAM;QAAuB,UAAU;QAAO,OAAO;IAAW;IAC9F;QAAE,QAAQ;QAAiB,MAAM;QAAiB,UAAU;QAAO,OAAO;IAAW;IACrF;QAAE,QAAQ;QAAU,MAAM;QAAU,UAAU;QAAO,OAAO;IAAW;CACxE;AAEM,SAAS;;IACd,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAkB,EAAE;IAC9D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAiB,EAAE;IACrE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,iBAAiB,IAAA,uKAAM,EAAmB;IAChD,MAAM,iBAAiB,IAAA,uKAAM,EAAiB;IAC9C,MAAM,eAAe,IAAA,uKAAM,EAAkB,EAAE;IAC/C,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,IAAA,yJAAgB;IAE7D,6BAA6B;IAC7B,IAAA,0KAAS;kCAAC;YACR,aAAa,OAAO,GAAG;QACzB;iCAAG;QAAC;KAAU;IAEd,wEAAwE;IACxE,IAAA,0KAAS;kCAAC;YACR,MAAM,iBAAiB,aAAa,OAAO,CAAC;YAC5C,IAAI,gBAAgB;gBAClB,IAAI;oBACF,MAAM,SAAS,KAAK,KAAK,CAAC;oBAC1B,IAAI,MAAM,OAAO,CAAC,WAAW,OAAO,MAAM,GAAG,GAAG;wBAC9C,aAAa;wBACb,iBAAiB;wBACjB;oBACF;gBACF,EAAE,OAAO,GAAG;oBACV,QAAQ,KAAK,CAAC,kCAAkC;gBAClD;YACF;YAEA,kCAAkC;YAClC;QACF;iCAAG,EAAE;IAEL,MAAM,6BAA6B;QACjC,MAAM,eAAgC,gBAAgB,GAAG,CAAC,CAAC,MAAM,QAAU,CAAC;gBAC1E,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,EAAE,KAAK,GAAG,IAAI;gBACpC,QAAQ,KAAK,MAAM;gBACnB,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;gBACjB,UAAU,KAAK,QAAQ;gBACvB,KAAK;gBACL,WAAW;gBACX,QAAQ;gBACR,eAAe;YACjB,CAAC;QAED,aAAa;QACb,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;QACjD,iBAAiB;IACnB;IAEA,+CAA+C;IAC/C,IAAA,0KAAS;kCAAC;YACR,IAAI,aAAa,UAAU,MAAM,GAAG,KAAK,eAAe;gBACtD,MAAM,SAAS,UAAU,GAAG;qDAAC,CAAA,OAAQ,CAAC;4BACpC,UAAU,KAAK,QAAQ,IAAI;4BAC3B,OAAO,KAAK,KAAK;wBACnB,CAAC;;gBACD,UAAU,QAAQ,IAAG,gCAAgC;gBACrD,QAAQ,GAAG,CAAC,uCAAuC;YACrD;QACF;iCAAG;QAAC;QAAW;KAAc,GAAE,iEAAiE;IAEhG,8DAA8D;IAC9D,MAAM,qBAAqB,UAAU,GAAG,CAAC,CAAA,IAAK,EAAE,KAAK,EAAE,IAAI,CAAC;IAC5D,IAAA,0KAAS;kCAAC;YACR,IAAI,aAAa,UAAU,MAAM,GAAG,KAAK,eAAe;gBACtD,MAAM,SAAS,UAAU,GAAG;qDAAC,CAAA,OAAQ,CAAC;4BACpC,UAAU,KAAK,QAAQ,IAAI;4BAC3B,OAAO,KAAK,KAAK;wBACnB,CAAC;;gBACD,UAAU,QAAQ;YACpB;QACF;iCAAG;QAAC;QAAoB;QAAW;KAAc;IAEjD,uEAAuE;IACvE,MAAM,gBAAgB,IAAA,uKAAM,EAAC;IAC7B,IAAA,0KAAS;kCAAC;YACR,cAAc,OAAO,GAAG;QAC1B;iCAAG;QAAC;KAAW;IAEf,8CAA8C;IAC9C,IAAA,0KAAS;kCAAC;YACR,MAAM;uDAAe;oBACnB,MAAM,OAAO,cAAc,OAAO;oBAClC,IAAI,OAAO,IAAI,CAAC,MAAM,MAAM,KAAK,GAAG;oBAEpC;+DAAa,CAAA;4BACX,IAAI,aAAa;4BACjB,MAAM,UAAU,KAAK,GAAG;+EAAC,CAAA;oCACvB,wCAAwC;oCACxC,MAAM,YAAY,IAAI,CAAC,KAAK,KAAK,CAAC,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;oCAC1F,IAAI,aAAa,UAAU,GAAG,IAAI,UAAU,GAAG,KAAK,KAAK,GAAG,EAAE;wCAC5D,aAAa;wCACb,MAAM,SAAS,UAAU,GAAG;wCAC5B,MAAM,YAAY,UAAU,KAAK,IAAI,KAAK,SAAS,IAAI;wCACvD,MAAM,SAAS,SAAS;wCACxB,MAAM,gBAAgB,YAAY,IAAI,AAAC,SAAS,YAAa,MAAM;wCACnE,OAAO;4CACL,GAAG,IAAI;4CACP,KAAK;4CACL;4CACA;4CACA;wCACF;oCACF;oCACA,OAAO;gCACT;;4BACA,OAAO,aAAa,UAAU;wBAChC;;gBACF;;YAEA,qBAAqB;YACrB;YAEA,2BAA2B;YAC3B,MAAM,WAAW,YAAY,cAAc;YAC3C;0CAAO,IAAM,cAAc;;QAC7B;iCAAG;QAAC;KAAc;IAElB,qDAAqD;IACrD,IAAA,0KAAS;kCAAC;YACR,IAAI,iBAAiB,UAAU,MAAM,GAAG,GAAG;gBACzC,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;YACnD;QACF;iCAAG;QAAC;QAAW;KAAc;IAE7B,mBAAmB;IACnB,IAAA,0KAAS;kCAAC;YACR,IAAI,CAAC,YAAY,IAAI,IAAI;gBACvB,iBAAiB,EAAE;gBACnB,mBAAmB;gBACnB;YACF;YAEA,MAAM,QAAQ;gDAAW;oBACvB,eAAe;oBACf,IAAI;wBACF,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,kBAAkB,EAAE,mBAAmB,aAAa,SAAS,CAAC;wBACtG,MAAM,OAAO,MAAM,SAAS,IAAI;wBAEhC,IAAI,KAAK,OAAO,IAAI,KAAK,IAAI,EAAE;4BAC7B,mCAAmC;4BACnC,MAAM,iBAAiB,IAAI,IAAI,UAAU,GAAG;gEAAC,CAAA,IAAK,EAAE,KAAK;;4BACzD,MAAM,WAAW,KAAK,IAAI,CAAC,MAAM;yEAAC,CAAC,OAAuB,CAAC,eAAe,GAAG,CAAC,KAAK,KAAK;;4BACxF,iBAAiB;4BACjB,mBAAmB;wBACrB;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,4BAA4B;oBAC5C,SAAU;wBACR,eAAe;oBACjB;gBACF;+CAAG,KAAK,iBAAiB;;YAEzB;0CAAO,IAAM,aAAa;;QAC5B;iCAAG;QAAC;QAAa;KAAU;IAE3B,0CAA0C;IAC1C,IAAA,0KAAS;kCAAC;YACR,MAAM;6DAAqB,CAAC;oBAC1B,IACE,eAAe,OAAO,IACtB,CAAC,eAAe,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,KAC7C,eAAe,OAAO,IACtB,CAAC,eAAe,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAC7C;wBACA,mBAAmB;oBACrB;gBACF;;YAEA,SAAS,gBAAgB,CAAC,aAAa;YACvC;0CAAO,IAAM,SAAS,mBAAmB,CAAC,aAAa;;QACzD;iCAAG,EAAE;IAEL,MAAM,YAAY,IAAA,4KAAW;+CAAC,CAAC;YAC7B,MAAM,UAAyB;gBAC7B,IAAI,GAAG,KAAK,KAAK,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI;gBACjC,QAAQ,KAAK,MAAM;gBACnB,MAAM,KAAK,IAAI,IAAI,KAAK,MAAM;gBAC9B,OAAO,KAAK,KAAK;gBACjB,UAAU,KAAK,QAAQ,IAAI;gBAC3B,KAAK;gBACL,WAAW;gBACX,QAAQ;gBACR,eAAe;YACjB;YAEA;uDAAa,CAAA,OAAQ;2BAAI;wBAAM;qBAAQ;;YACvC,eAAe;YACf,iBAAiB,EAAE;YACnB,mBAAmB;YAEnB,6BAA6B;YAC7B,IAAI,WAAW;gBACb,UAAU;oBAAC;wBAAE,UAAU,QAAQ,QAAQ;wBAAE,OAAO,QAAQ,KAAK;oBAAC;iBAAE,EAAE;YACpE;QACF;8CAAG;QAAC;QAAW;KAAU;IAEzB,MAAM,eAAe,IAAA,4KAAW;kDAAC,CAAC;YAChC;0DAAa,CAAA;oBACX,MAAM,UAAU,KAAK,MAAM;0EAAC,CAAA,OAAQ,KAAK,EAAE,KAAK;;oBAChD,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;oBACjD,OAAO;gBACT;;QACF;iDAAG,EAAE;IAEL,wCAAwC;IACxC,MAAM,oBAAoB,IAAA,4KAAW;uDAAC;YACpC,MAAM,mBAAmB,aAAa,OAAO;YAC7C,IAAI,iBAAiB,MAAM,KAAK,GAAG;YAEnC,IAAI;gBACF,MAAM,SAAS,iBAAiB,GAAG;0EAAC,CAAA,OAAQ,CAAC;4BAC3C,UAAU,KAAK,QAAQ,IAAI;4BAC3B,OAAO,KAAK,KAAK;wBACnB,CAAC;;gBAED,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,YAAY,CAAC,EAAE;oBACrD,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBAAE;oBAAO;gBAChC;gBAEA,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,IAAI,CAAC,MAAM,WAAW,CAAC,MAAM,OAAO,CAAC,KAAK,IAAI,GAAG;gBAEjD,sCAAsC;gBACtC,MAAM,WAAgC,CAAC;gBACvC,KAAK,IAAI,CAAC,OAAO;mEAAC,CAAC;wBACjB,IAAI,OAAO,OAAO;4BAChB,QAAQ,CAAC,OAAO,MAAM,KAAK,EAAE,GAAG;wBAClC;oBACF;;gBAEA;mEAAa,CAAA;wBACX,IAAI,aAAa;wBACjB,MAAM,UAAU,KAAK,GAAG;mFAAC,CAAA;gCACvB,MAAM,QAAQ,QAAQ,CAAC,OAAO,KAAK,KAAK,EAAE;gCAC1C,IAAI,SAAS,MAAM,GAAG,IAAI,MAAM,GAAG,KAAK,KAAK,GAAG,EAAE;oCAChD,aAAa;oCACb,MAAM,SAAS,MAAM,GAAG;oCACxB,MAAM,YAAY,MAAM,KAAK,IAAI,KAAK,SAAS,IAAI;oCACnD,MAAM,SAAS,SAAS;oCACxB,MAAM,gBAAgB,YAAY,IAAI,AAAC,SAAS,YAAa,MAAM;oCACnE,OAAO;wCACL,GAAG,IAAI;wCACP,KAAK;wCACL;wCACA;wCACA;oCACF;gCACF;gCACA,OAAO;4BACT;;wBACA,OAAO,aAAa,UAAU;oBAChC;;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,kCAAkC;YAClD;QACF;sDAAG,EAAE,EAAE,6BAA6B;;IAEpC,kEAAkE;IAClE,IAAA,0KAAS;kCAAC;YACR,IAAI,CAAC,eAAe;YAEpB,+DAA+D;YAC/D,MAAM,iBAAiB,WAAW,mBAAmB;YAErD,4BAA4B;YAC5B,MAAM,WAAW,YAAY,mBAAmB;YAChD;0CAAO;oBACL,aAAa;oBACb,cAAc;gBAChB;;QACF;iCAAG;QAAC;QAAe;KAAkB;IAErC,MAAM,gBAAgB,IAAA,4KAAW;mDAAC;YAChC,MAAM,mBAAmB,aAAa,OAAO;YAC7C,+CAA+C;YAC/C,IAAI,aAAa,iBAAiB,MAAM,GAAG,GAAG;gBAC5C,MAAM,SAAS,iBAAiB,GAAG;sEAAC,CAAA,OAAQ,CAAC;4BAC3C,UAAU,KAAK,QAAQ,IAAI;4BAC3B,OAAO,KAAK,KAAK;wBACnB,CAAC;;gBACD,UAAU,QAAQ;YACpB;YACA,qBAAqB;YACrB;QACF;kDAAG;QAAC;QAAW;QAAW;KAAkB;IAE5C,MAAM,iBAAiB,IAAA,4KAAW;oDAAC;YACjC,IAAI,QAAQ,kDAAkD;gBAC5D,aAAa,UAAU,CAAC;gBACxB;YACF;QACF;mDAAG,EAAE;IAEL,MAAM,eAAe,CAAC,QAAgB;QACpC,MAAM,OAAO,UAAU,IAAI,MAAM;QACjC,OAAO,GAAG,OAAO,OAAO,OAAO,CAAC,GAAG,GAAG,EAAE,OAAO,cAAc,OAAO,CAAC,GAAG,CAAC,CAAC;IAC5E;IAEA,MAAM,kBAAkB,CAAC,UAAkB;QACzC,IAAI,YAAY,WAAW,YAAY,WAAW;YAChD,qBAAO,6LAAC;gBAAK,WAAU;0BAAyG;;;;;;QAClI;QACA,qBAAO,6LAAC;YAAK,WAAU;sBAAkG;;;;;;IAC3H;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,6MAAI;gCAAC,WAAU;;;;;;0CAChB,6LAAC;gCAAG,WAAU;0CAAgC;;;;;;0CAC9C,6LAAC;gCAAK,WAAW,IAAA,qHAAE,EACjB,8CACA,YACI,yEACA;0CAEH,YAAY,WAAW;;;;;;;;;;;;kCAG5B,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,wIAAM;gCAAC,SAAS;gCAAe,SAAQ;gCAAU,MAAK;gCAAK,UAAU,CAAC;;kDACrE,6LAAC,gOAAS;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;0CAGxC,6LAAC,wIAAM;gCAAC,SAAS;gCAAgB,SAAQ;gCAAU,MAAK;0CAAK;;;;;;;;;;;;;;;;;;0BAOjE,6LAAC,oIAAI;0BACH,cAAA,6LAAC,2IAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,mNAAM;wCAAC,WAAU;;;;;;kDAClB,6LAAC,sIAAK;wCACJ,KAAK;wCACL,aAAY;wCACZ,OAAO;wCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;wCAC9C,SAAS,IAAM,YAAY,IAAI,MAAM,mBAAmB;wCACxD,WAAU;;;;;;oCAEX,6BACC,6LAAC;wCACC,SAAS;4CACP,eAAe;4CACf,iBAAiB,EAAE;4CACnB,mBAAmB;wCACrB;wCACA,WAAU;kDAEV,cAAA,6LAAC,oMAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;4BAMlB,iCACC,6LAAC;gCACC,KAAK;gCACL,WAAU;0CAET,4BACC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,gOAAS;4CAAC,WAAU;;;;;;wCAAqC;;;;;;2CAG1D,cAAc,MAAM,GAAG,kBACzB,6LAAC;oCAAI,WAAU;8CACZ,cAAc,GAAG,CAAC,CAAC,QAAQ,sBAC1B,6LAAC;4CAEC,SAAS,IAAM,UAAU;4CACzB,WAAU;;8DAEV,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAK,WAAU;8EAAwB,OAAO,MAAM;;;;;;gEACpD,gBAAgB,OAAO,QAAQ,EAAE,OAAO,OAAO;;;;;;;sEAElD,6LAAC;4DAAI,WAAU;sEACZ,OAAO,IAAI;;;;;;;;;;;;8DAGhB,6LAAC,6MAAI;oDAAC,WAAU;;;;;;;2CAbX,GAAG,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO;;;;;;;;;2CAiBnC,YAAY,IAAI,mBAClB,6LAAC;oCAAI,WAAU;;wCAAwC;wCAC9B;wCAAY;;;;;;2CAEnC;;;;;;;;;;;;;;;;;;;;;;0BAQd,6LAAC,oIAAI;gBAAC,WAAU;;kCACd,6LAAC,0IAAU;wBAAC,WAAU;kCACpB,cAAA,6LAAC,yIAAS;4BAAC,WAAU;;8CACnB,6LAAC;8CAAK;;;;;;8CACN,6LAAC;oCAAK,WAAU;;wCAA6C,UAAU,MAAM;wCAAC;;;;;;;;;;;;;;;;;;kCAGlF,6LAAC,2IAAW;wBAAC,WAAU;kCACpB,UAAU,MAAM,KAAK,kBACpB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6MAAI;oCAAC,WAAU;;;;;;8CAChB,6LAAC;8CAAE;;;;;;8CACH,6LAAC;oCAAE,WAAU;8CAAU;;;;;;;;;;;iDAGzB,6LAAC;4BAAI,WAAU;;8CAEb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDAAa;;;;;;sDAC5B,6LAAC;4CAAI,WAAU;sDAAyB;;;;;;sDACxC,6LAAC;4CAAI,WAAU;sDAAwB;;;;;;sDACvC,6LAAC;4CAAI,WAAU;sDAAwB;;;;;;sDACvC,6LAAC;4CAAI,WAAU;;;;;;;;;;;;8CAIjB,6LAAC;oCAAI,WAAU;8CAEZ,UAAU,GAAG,CAAC,CAAC,qBACd,6LAAC;4CAEC,WAAU;;8DAGV,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;sEAA0B,KAAK,MAAM;;;;;;sEACpD,6LAAC;4DAAI,WAAU;sEAA0C,KAAK,IAAI;;;;;;;;;;;;8DAIpE,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC;wDAAK,WAAW,IAAA,qHAAE,EACjB,2CACA,KAAK,QAAQ,KAAK,QACd,6EACA;kEAEH,KAAK,QAAQ;;;;;;;;;;;8DAKlB,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC;wDAAK,WAAU;kEACb,KAAK,GAAG,GAAG,IAAI,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,cAAc,CAAC,SAAS;4DAAE,uBAAuB;4DAAG,uBAAuB;wDAAE,IAAI,GAAG;;;;;;;;;;;8DAKrH,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC;wDAAI,WAAW,IAAA,qHAAE,EAChB,2DACA,KAAK,MAAM,GAAG,IAAI,uCAClB,KAAK,MAAM,GAAG,IAAI,mCAClB;;4DAEC,KAAK,MAAM,KAAK,KAAK,CACpB,KAAK,MAAM,GAAG,kBACZ,6LAAC,mOAAU;gEAAC,WAAU;;;;;qFACtB,6LAAC,yOAAY;gEAAC,WAAU;;;;;oEAC5B;0EACA,6LAAC;gEAAK,WAAU;0EACb,KAAK,GAAG,GAAG,IAAI,aAAa,KAAK,MAAM,EAAE,KAAK,aAAa,IAAI;;;;;;;;;;;;;;;;;8DAMtE,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC,wIAAM;wDACL,SAAQ;wDACR,MAAK;wDACL,SAAS,IAAM,aAAa,KAAK,EAAE;wDACnC,WAAU;kEAEV,cAAA,6LAAC,uNAAM;4DAAC,WAAU;;;;;;;;;;;;;;;;;2CAvDjB,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEhC;GA9fgB;;QAU+B,yJAAgB;;;KAV/C"}},
    {"offset": {"line": 14545, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/components/ui/tabs.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as TabsPrimitive from '@radix-ui/react-tabs'\n\nimport { cn } from '@/lib/utils'\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn('flex flex-col gap-2', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        'bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn('flex-1 outline-none', className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,KAAK,EACZ,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,mqBACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 14623, "column": 0}, "map": {"version":3,"sources":["file:///B:/projects/gaurav-new/app/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport dynamic from 'next/dynamic'\nimport { Header } from '@/components/trading/header'\nimport { TradeForm } from '@/components/trading/trade-form'\nimport { PriceCharts } from '@/components/trading/price-charts'\nimport { ActionButtons } from '@/components/trading/action-buttons'\nconst DynamicTabsSection = dynamic(() => import('@/components/trading/tabs-section'), { ssr: false })\nimport { PositionsTable } from '@/components/trading/positions-table'\nimport { OptionsChainModal } from '@/components/trading/options-chain-modal'\nimport { BasketOrderTab } from '@/components/trading/basket-order-tab'\nimport { OrderBookTable } from '@/components/trading/order-book-table'\nimport { TradeBookTable } from '@/components/trading/trade-book-table'\nimport { HoldingsTable } from '@/components/trading/holdings-table'\nimport { FundsTable } from '@/components/trading/funds-table'\nimport { BrokerTab } from '@/components/trading/broker-tab'\nimport { WatchlistTab } from '@/components/trading/watchlist-tab'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { useEffect } from 'react'\n\nexport default function Home() {\n  const [activeTab, setActiveTab] = useState(() => {\n    if (typeof window !== 'undefined') {\n      return localStorage.getItem('activeTab') || 'positions'\n    }\n    return 'positions'\n  })\n  const [mainTab, setMainTab] = useState('dashboard')\n  const [showColumnsDialog, setShowColumnsDialog] = useState(false)\n  const [selectedBroker, setSelectedBroker] = useState<string | null>(null)\n  const [tradingMode, setTradingMode] = useState<'paper' | 'live'>('paper')\n  const [showOptionsChain, setShowOptionsChain] = useState(false)\n  const [optionsParams, setOptionsParams] = useState<{ symbol?: string; expiryDate?: string } | null>(null)\n  const [orderbookTotals, setOrderbookTotals] = useState<{ total: number; pending: number; executed: number; rejected: number; cancelled: number } | null>(null)\n  const [holdingsTotals, setHoldingsTotals] = useState<{ totalPnl: number; investedValue: number; marketValue: number } | null>(null)\n  const [exportOrderbookFn, setExportOrderbookFn] = useState<(() => void) | null>(null)\n  const [hydrated, setHydrated] = useState(false)\n  const [isMounted, setIsMounted] = useState(false)\n  \n  const handleRefresh = () => {\n    // Broadcast a refresh event so individual components can listen if they need to refresh\n    if (typeof window !== 'undefined') {\n      window.dispatchEvent(new Event('refreshData'))\n    }\n  }\n\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('activeTab', activeTab)\n    }\n  }, [activeTab])\n\n  useEffect(() => {\n    // Only save after component has mounted and loaded from localStorage\n    if (isMounted && typeof window !== 'undefined') {\n      console.log('Saving trading mode to localStorage:', tradingMode)\n      localStorage.setItem('tradingMode', tradingMode)\n    }\n  }, [tradingMode, isMounted])\n\n  useEffect(() => {\n    setHydrated(true)\n    // Load trading mode from localStorage after mount\n    if (typeof window !== 'undefined') {\n      const savedMode = localStorage.getItem('tradingMode')\n      console.log('Loading trading mode from localStorage:', savedMode)\n      if (savedMode === 'live' || savedMode === 'paper') {\n        setTradingMode(savedMode)\n      }\n    }\n    setIsMounted(true)\n  }, [])\n\n  useEffect(() => {\n    const handleShowOptionsChain = (e: Event) => {\n      const custom = e as CustomEvent\n      const detail = custom?.detail || {}\n      setOptionsParams({ symbol: detail?.symbol || 'BANKNIFTY', expiryDate: detail?.expiryDate || '25-Nov-2025' })\n      setShowOptionsChain(true)\n    }\n    window.addEventListener('showOptionsChain', handleShowOptionsChain)\n    return () => window.removeEventListener('showOptionsChain', handleShowOptionsChain)\n  }, [])\n\n  return (\n    <main className=\"flex flex-col h-screen w-full bg-gray-50\">\n      <Tabs value={mainTab} onValueChange={setMainTab} className=\"flex flex-col h-full\">\n        <div className=\"bg-white border-b border-gray-200 px-6 py-2\">\n          <TabsList className=\"grid w-full max-w-md grid-cols-3\">\n            <TabsTrigger value=\"dashboard\">Dashboard</TabsTrigger>\n            <TabsTrigger value=\"broker\">Broker</TabsTrigger>\n            <TabsTrigger value=\"watchlist\">Watchlist</TabsTrigger>\n          </TabsList>\n        </div>\n\n        <TabsContent value=\"dashboard\" className=\"flex-1 overflow-hidden\">\n          <div className=\"flex flex-col h-full\">\n            <div className=\"flex-1 overflow-y-auto\">\n              {/* Trading controls section - takes ~60vh when content fills */}\n              <div className=\"w-full bg-white border-b border-gray-200\">\n                <div className=\"w-full px-3 md:px-6 py-3 md:py-4\">\n                  <Header selectedBroker={selectedBroker} onBrokerChange={setSelectedBroker} tradingMode={tradingMode} onTradingModeChange={setTradingMode} />\n                  <div className=\"mt-3 md:mt-4\">\n                    <TradeForm />\n                  </div>\n                  <div className=\"mt-4 md:mt-6\">\n                    <PriceCharts />\n                  </div>\n                  <div className=\"mt-4 md:mt-6\">\n                    <ActionButtons selectedBroker={selectedBroker} tradingMode={tradingMode} />\n                  </div>\n                </div>\n              </div>\n\n              {/* Tabs and table section - fills remaining space */}\n              <div className=\"w-full bg-gray-50\">\n                <DynamicTabsSection\n                  activeTab={activeTab}\n                  onTabChange={setActiveTab}\n                  onOpenColumnSettings={() => setShowColumnsDialog(true)}\n                  orderbookTotals={activeTab === 'orderbook' ? orderbookTotals ?? { total: 0, pending: 0, executed: 0, rejected: 0, cancelled: 0 } : undefined}\n                  holdingsTotals={activeTab === 'holdings' ? holdingsTotals ?? { totalPnl: 0, investedValue: 0, marketValue: 0 } : undefined}\n                  onExportOrderbook={() => exportOrderbookFn && exportOrderbookFn()}\n                  onRefresh={handleRefresh}\n                />\n                <div className=\"overflow-x-auto\">\n                  {hydrated && (\n                    <>\n                      {activeTab === 'basket' ? (\n                        <BasketOrderTab />\n                      ) : activeTab === 'orderbook' ? (\n                        <OrderBookTable\n                          openSettings={showColumnsDialog}\n                          onOpenSettings={setShowColumnsDialog}\n                          onTotalsChange={(t) => setOrderbookTotals(t)}\n                          provideExportFn={(fn) => setExportOrderbookFn(() => fn)}\n                        />\n                  ) : activeTab === 'tradebook' ? (\n                    <TradeBookTable />\n                  ) : activeTab === 'holdings' ? (\n                    <HoldingsTable onTotalsChange={(t) => setHoldingsTotals(t)} />\n                  ) : activeTab === 'funds' ? (\n                    <FundsTable />\n                  ) : (\n                    <PositionsTable openSettings={showColumnsDialog} onOpenSettings={setShowColumnsDialog} tradingMode={tradingMode} />\n                  )}\n                  </>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"broker\" className=\"flex-1 overflow-hidden\">\n          <BrokerTab />\n        </TabsContent>\n\n        <TabsContent value=\"watchlist\" className=\"flex-1 overflow-hidden\">\n          <WatchlistTab />\n        </TabsContent>\n      </Tabs>\n\n      <OptionsChainModal isOpen={showOptionsChain} onClose={() => setShowOptionsChain(false)} symbol={optionsParams?.symbol} expiryDate={optionsParams?.expiryDate} />\n    </main>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}